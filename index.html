<html lang="vi" class="dark"><head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ueih Casio</title>
  <script>
    // prevent theme flash
    (function(){
      try {
        const t = localStorage.getItem('ueih_theme') || 'dark';
        if(t === 'dark') document.documentElement.classList.add('dark');
        else document.documentElement.classList.remove('dark');
      } catch(e) {}
    })();
  </script>


  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700;900&amp;display=swap" rel="stylesheet">

  <script>
    tailwind.config = {
      darkMode: 'class',
      theme: {
        extend: {
          fontFamily: { sans: ['Montserrat', 'sans-serif'] },
          colors: {
            primary: '#dc2626',
            primaryDark: '#991b1b',
            darkBg: '#020617',
            cardBg: '#0f172a'
          },
          animation: {
            'slide-in': 'slideIn 0.35s ease-out forwards',
            'fade-in': 'fadeIn 0.25s ease-out forwards',
            'pop': 'pop 0.18s ease-out forwards'
          },
          keyframes: {
            slideIn: { '0%': {opacity: 0, transform: 'translateY(-8px)'}, '100%': {opacity: 1, transform: 'translateY(0)'} },
            fadeIn: { '0%': {opacity: 0}, '100%': {opacity: 1} },
            pop: { '0%': {transform:'scale(0.96)', opacity: 0}, '100%': {transform:'scale(1)', opacity: 1} }
          }
        }
      }
    }
  </script>

  <style>
    .bg-grid-red {
      background-size: 52px 52px;
      background-image:
        linear-gradient(to right, rgba(220,38,38,0.06) 1px, transparent 1px),
        linear-gradient(to bottom, rgba(220,38,38,0.06) 1px, transparent 1px);
    }
    .page-section { display:none; opacity:0; transform:translateY(10px); transition: all .35s ease; }
    .page-section.active { display:block; opacity:1; transform:translateY(0); }

    body:not(.admin-mode) .admin-only { display:none !important; }

    .locked-item { opacity: .55; filter: grayscale(100%); cursor:not-allowed; pointer-events:none; border: 1px dashed rgba(148,163,184,.35) !important; }
    body.admin-mode .locked-item { opacity: .9; filter: grayscale(0%); cursor:pointer; pointer-events:auto; border: 1px dashed rgba(250,204,21,.75) !important; }

    .horizontal-scroll{ display:flex; overflow-x:auto; scroll-snap-type:x mandatory; gap:1.25rem; padding-bottom:1rem; -ms-overflow-style:none; scrollbar-width:none; }
    .horizontal-scroll::-webkit-scrollbar{ display:none; }
    .horizontal-scroll > div{ scroll-snap-align:center; flex: 0 0 320px; }

    .glass { background: rgba(2, 6, 23, 0.72); backdrop-filter: blur(10px); }
    .soft-shadow { box-shadow: 0 14px 40px rgba(0,0,0,.45); }
    .ring-glow { box-shadow: 0 0 0 1px rgba(220,38,38,.25), 0 0 22px rgba(220,38,38,.28); }

    /* drawer */
    .drawer { transform: translateX(100%); transition: transform .25s ease; }
    .drawer.open { transform: translateX(0); }
  
    /* LIGHT MODE OVERRIDES */
    html:not(.dark) body { background-color: #f8fafc !important; color: #0f172a !important; }
    html:not(.dark) .glass { background: rgba(255,255,255,.78) !important; }
    html:not(.dark) .bg-darkBg { background-color: #f8fafc !important; }
    html:not(.dark) .bg-cardBg { background-color: rgba(255,255,255,.86) !important; }
    html:not(.dark) .text-white { color: #0f172a !important; }
    html:not(.dark) .text-gray-300 { color: #334155 !important; }
    html:not(.dark) .text-gray-400 { color: #475569 !important; }
    html:not(.dark) .text-gray-500 { color: #64748b !important; }
    html:not(.dark) .text-gray-700 { color: #94a3b8 !important; }
    html:not(.dark) .border-white\/10 { border-color: rgba(15,23,42,.12) !important; }
    html:not(.dark) .border-white\/20 { border-color: rgba(15,23,42,.18) !important; }
    html:not(.dark) .bg-white\/5 { background-color: rgba(15,23,42,.05) !important; }
    html:not(.dark) .bg-white\/10 { background-color: rgba(15,23,42,.08) !important; }
    html:not(.dark) .bg-black\/40 { background-color: rgba(255,255,255,.7) !important; }
    html:not(.dark) .bg-black\/70 { background-color: rgba(0,0,0,.35) !important; }
    html:not(.dark) .bg-black\/80 { background-color: rgba(0,0,0,.45) !important; }
    html:not(.dark) .bg-black\/85 { background-color: rgba(0,0,0,.5) !important; }
    html:not(.dark) .ring-glow { box-shadow: 0 0 0 1px rgba(220,38,38,.25), 0 0 18px rgba(220,38,38,.22) !important; }

    /* Badges */
    .badge-level-basic { background: rgba(148,163,184,0.2); color: #94a3b8; border:1px solid rgba(148,163,184,0.3); }
    .badge-level-apply { background: rgba(59,130,246,0.2); color: #60a5fa; border:1px solid rgba(59,130,246,0.3); }
    .badge-level-strong { background: rgba(249,115,22,0.2); color: #fb923c; border:1px solid rgba(249,115,22,0.3); }
    .badge-level-vip { background: linear-gradient(135deg, rgba(168,85,247,0.2), rgba(236,72,153,0.2)); color: #e879f9; border:1px solid rgba(168,85,247,0.3); }
    
    .badge-target { background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.1); font-size: 10px; padding: 2px 6px; border-radius: 6px; color: #cbd5e1; }
  </style>
</head>

<body class="bg-darkBg text-white min-h-screen flex flex-col font-sans selection:bg-primary selection:text-white overflow-x-hidden">
  <!-- background vibe -->
  <div class="fixed inset-0 bg-grid-red z-[-1] pointer-events-none"></div>
  <div class="fixed top-[-10%] left-[-10%] w-[520px] h-[520px] bg-primary/10 rounded-full blur-[120px] z-[-1]"></div>
  <div class="fixed bottom-[-12%] right-[-12%] w-[520px] h-[520px] bg-white/5 rounded-full blur-[120px] z-[-1]"></div>

  <!-- NAV -->
  <nav class="sticky top-0 z-50 border-b border-white/10 glass">
    <div class="container mx-auto px-4 h-20 flex justify-between items-center gap-3">

      <!-- logo -->
      <div onclick="switchPage('home')" class="cursor-pointer flex items-center gap-3 group select-none">
        <div class="relative">
          <img id="nav-avatar" src="https://scontent.fhan20-1.fna.fbcdn.net/v/t39.30808-6/555733813_810835077974194_4101748610057312325_n.jpg?_nc_cat=103&amp;ccb=1-7&amp;_nc_sid=6ee11a&amp;_nc_eui2=AeHDTdYqWdNFRjU8d2r5jAhjebOdWmQ9kbF5s51aZD2RsVt3gAla-o2NSldRE2u4LlyamgEm9bbvjTd0fQAskB83&amp;_nc_ohc=j7pYsq1YFBIQ7kNvwGqVswS&amp;_nc_oc=Adlz2s1APpaob9-hqj_UUypHn8eLkWbC-8zRqetZZ8lreC3w1g2GCzKFBPN2XtBmeX0&amp;_nc_zt=23&amp;_nc_ht=scontent.fhan20-1.fna&amp;_nc_gid=kLhRTL2MoYzPK4ngUv-7zA&amp;oh=00_AflDQh0Z0RhjS2cSJvz5BRhWHcCxjtV7wKug-AHH5fEuuA&amp;oe=6958839A" class="w-10 h-10 rounded-full border border-primary object-cover ring-glow group-hover:scale-110 transition duration-300">
          <div class="absolute bottom-0 right-0 w-2.5 h-2.5 bg-green-500 rounded-full border border-black"></div>
        </div>
        <div class="leading-none">
          <h1 class="font-black text-lg tracking-tighter text-white group-hover:text-primary transition" id="nav-text">Ueih Casio</h1>
          <div class="text-[10px] text-gray-400 font-bold tracking-widest uppercase">15S VDC</div>
        </div>
      </div>

      <!-- desktop nav -->
      <div class="hidden md:flex items-center space-x-8 text-sm font-bold uppercase tracking-wide">
        <button onclick="switchPage('home')" class="hover:text-primary transition">Trang ch·ªß</button>

        <div class="relative group">
          <button class="hover:text-primary py-6 flex items-center gap-1">
            K·ªπ nƒÉng Casio 580 <i class="fas fa-chevron-down text-[10px]"></i>
          </button>
          <div class="absolute top-full left-1/2 -translate-x-1/2 w-72 bg-cardBg border border-primary/30 soft-shadow rounded-2xl overflow-hidden hidden group-hover:block animate-slide-in">
            <button onclick="switchPage('casio-so-hoc')" class="block w-full text-left px-4 py-3 hover:bg-primary/10 hover:text-primary border-b border-white/5 normal-case transition">üî¢ S·ªë H·ªçc </button>
            <button onclick="switchPage('casio-ham-so')" class="block w-full text-left px-4 py-3 hover:bg-primary/10 hover:text-primary border-b border-white/5 normal-case transition">üìà H√†m S·ªë &amp; ƒê·ªì Th·ªã</button>
            <button onclick="switchPage('casio-giai-tich')" class="block w-full text-left px-4 py-3 hover:bg-primary/10 hover:text-primary border-b border-white/5 normal-case transition">‚à´ Gi·∫£i T√≠ch</button>
            <button onclick="switchPage('casio-hinh-hoc')" class="block w-full text-left px-4 py-3 hover:bg-primary/10 hover:text-primary border-b border-white/5 normal-case transition">üìê H√¨nh H·ªçc Oxyz</button>
            <button onclick="switchPage('casio-xac-suat')" class="block w-full text-left px-4 py-3 hover:bg-primary/10 hover:text-primary border-b border-white/5 normal-case transition">üé≤ X√°c Su·∫•t</button>
            <button onclick="switchPage('casio-hay-la')" class="block w-full text-left px-4 py-3 bg-primary/10 hover:bg-primary hover:text-white font-bold normal-case transition">
              <i class="fas fa-star text-yellow-400 mr-1"></i> B√†i To√°n Hay
            </button>
          </div>
        </div>

        <div class="relative group">
          <button class="hover:text-primary py-6 flex items-center gap-1">
            K·ªπ nƒÉng Casio 880 <i class="fas fa-chevron-down text-[10px]"></i>
          </button>
          <div class="absolute top-full left-1/2 -translate-x-1/2 w-72 bg-cardBg border border-primary/30 soft-shadow rounded-2xl overflow-hidden hidden group-hover:block animate-slide-in">
            <button onclick="switchPage('casio-880-so-hoc')" class="block w-full text-left px-4 py-3 hover:bg-primary/10 hover:text-primary border-b border-white/5 normal-case transition">üî¢ S·ªë H·ªçc </button>
            <button onclick="switchPage('casio-880-ham-so')" class="block w-full text-left px-4 py-3 hover:bg-primary/10 hover:text-primary border-b border-white/5 normal-case transition">üìà H√†m S·ªë &amp; ƒê·ªì Th·ªã</button>
            <button onclick="switchPage('casio-880-giai-tich')" class="block w-full text-left px-4 py-3 hover:bg-primary/10 hover:text-primary border-b border-white/5 normal-case transition">‚à´ Gi·∫£i T√≠ch</button>
            <button onclick="switchPage('casio-880-hinh-hoc')" class="block w-full text-left px-4 py-3 hover:bg-primary/10 hover:text-primary border-b border-white/5 normal-case transition">üìê H√¨nh H·ªçc Oxyz</button>
            <button onclick="switchPage('casio-880-xac-suat')" class="block w-full text-left px-4 py-3 hover:bg-primary/10 hover:text-primary border-b border-white/5 normal-case transition">üé≤ X√°c Su·∫•t</button>
            <button onclick="switchPage('casio-880-hay-la')" class="block w-full text-left px-4 py-3 bg-primary/10 hover:bg-primary hover:text-white font-bold normal-case transition">
              <i class="fas fa-star text-yellow-400 mr-1"></i> B√†i To√°n Hay
            </button>
          </div>
        </div>

        <div class="relative group">
          <button class="hover:text-primary py-6 flex items-center gap-1">
            Kho ƒê·ªÅ Thi <i class="fas fa-chevron-down text-[10px]"></i>
          </button>
          <div class="absolute top-full left-1/2 -translate-x-1/2 w-64 bg-cardBg border border-primary/30 soft-shadow rounded-2xl overflow-hidden hidden group-hover:block animate-slide-in">
            <button onclick="switchPage('exam-tsa')" class="block w-full text-left px-4 py-3 hover:bg-primary/10 hover:text-red-400 border-b border-white/5 normal-case transition">üî¥ TSA (B√°ch Khoa)</button>
            <button onclick="switchPage('exam-hsa')" class="block w-full text-left px-4 py-3 hover:bg-primary/10 hover:text-green-400 border-b border-white/5 normal-case transition">üü¢ HSA (ƒêHQG)</button>
            <button onclick="switchPage('exam-thpt')" class="block w-full text-left px-4 py-3 hover:bg-primary/10 hover:text-blue-400 border-b border-white/5 normal-case transition">üîµ THPT Qu·ªëc Gia</button>
            <button onclick="switchPage('exam-vact')" class="block w-full text-left px-4 py-3 hover:bg-primary/10 hover:text-purple-400 normal-case transition">üü£ ƒê·ªÅ VACT</button>
          </div>
        </div>

        <button onclick="switchPage('favorites')" class="hover:text-primary transition flex items-center gap-2">
          <i class="fas fa-bookmark"></i> Y√™u th√≠ch
        </button>
      </div>

      <!-- right controls -->
      <div class="flex items-center gap-2">
        <button onclick="toggleTheme()" class="w-10 h-10 rounded-xl bg-white/5 border border-white/10 hover:border-primary/40 hover:bg-white/10 transition flex items-center justify-center" title="Light/Dark">
          <i id="theme-ico" class="fas fa-moon"></i>
        </button>

        <button onclick="requestAdmin()" id="btn-admin" class="w-10 h-10 rounded-xl bg-white/5 border border-white/10 hover:border-primary/40 hover:bg-white/10 transition flex items-center justify-center" title="Admin">
          <i class="fas fa-user-secret"></i>
        </button>

        <div id="admin-indicator" class="hidden md:block w-2 h-2 rounded-full bg-gray-600"></div>

        <!-- mobile menu btn -->
        <button onclick="openDrawer()" class="md:hidden w-10 h-10 rounded-xl bg-white/5 border border-white/10 hover:bg-white/10 transition flex items-center justify-center" title="Menu">
          <i class="fas fa-bars"></i>
        </button>
      </div>
    </div>
  </nav>

  <!-- Mobile Drawer -->
  <div id="drawer-overlay" class="fixed inset-0 z-[90] hidden">
    <div class="absolute inset-0 bg-black/70 backdrop-blur-sm" onclick="closeDrawer()"></div>
    <div id="drawer" class="drawer absolute top-0 right-0 h-full w-[88%] max-w-sm bg-cardBg border-l border-white/10 soft-shadow p-4">
      <div class="flex items-center justify-between mb-4">
        <div class="font-black tracking-tight text-lg">Menu</div>
        <button onclick="closeDrawer()" class="w-9 h-9 rounded-lg bg-white/5 hover:bg-white/10 transition flex items-center justify-center">
          <i class="fas fa-xmark"></i>
        </button>
      </div>

      <div class="space-y-2 text-sm">
        <button onclick="switchPage('home'); closeDrawer();" class="w-full text-left px-3 py-3 rounded-xl bg-white/5 hover:bg-white/10 transition flex items-center gap-2">
          <i class="fas fa-house text-primary w-5"></i> Trang ch·ªß
        </button>

        <details class="group rounded-xl bg-white/5 overflow-hidden">
          <summary class="cursor-pointer list-none px-3 py-3 flex items-center justify-between">
            <span class="font-bold flex items-center gap-2"><i class="fas fa-calculator text-primary w-5"></i> K·ªπ nƒÉng Casio 580</span>
            <i class="fas fa-chevron-down text-xs opacity-70 group-open:rotate-180 transition"></i>
          </summary>
          <div class="pb-2">
            <button onclick="switchPage('casio-so-hoc'); closeDrawer();" class="w-full text-left px-4 py-2 hover:bg-white/10 transition">üî¢ S·ªë H·ªçc </button>
            <button onclick="switchPage('casio-ham-so'); closeDrawer();" class="w-full text-left px-4 py-2 hover:bg-white/10 transition">üìà H√†m S·ªë &amp; ƒê·ªì Th·ªã</button>
            <button onclick="switchPage('casio-giai-tich'); closeDrawer();" class="w-full text-left px-4 py-2 hover:bg-white/10 transition">‚à´ Gi·∫£i T√≠ch</button>
            <button onclick="switchPage('casio-hinh-hoc'); closeDrawer();" class="w-full text-left px-4 py-2 hover:bg-white/10 transition">üìê H√¨nh H·ªçc Oxyz</button>
            <button onclick="switchPage('casio-xac-suat'); closeDrawer();" class="w-full text-left px-4 py-2 hover:bg-white/10 transition">üé≤ X√°c Su·∫•t</button>
            <button onclick="switchPage('casio-hay-la'); closeDrawer();" class="w-full text-left px-4 py-2 hover:bg-white/10 transition">‚≠ê B√†i To√°n Hay</button>
          </div>
        </details>

        <details class="group rounded-xl bg-white/5 overflow-hidden">
          <summary class="cursor-pointer list-none px-3 py-3 flex items-center justify-between">
            <span class="font-bold flex items-center gap-2"><i class="fas fa-calculator text-primary w-5"></i> K·ªπ nƒÉng Casio 880</span>
            <i class="fas fa-chevron-down text-xs opacity-70 group-open:rotate-180 transition"></i>
          </summary>
          <div class="pb-2">
            <button onclick="switchPage('casio-880-so-hoc'); closeDrawer();" class="w-full text-left px-4 py-2 hover:bg-white/10 transition">üî¢ S·ªë H·ªçc </button>
            <button onclick="switchPage('casio-880-ham-so'); closeDrawer();" class="w-full text-left px-4 py-2 hover:bg-white/10 transition">üìà H√†m S·ªë &amp; ƒê·ªì Th·ªã</button>
            <button onclick="switchPage('casio-880-giai-tich'); closeDrawer();" class="w-full text-left px-4 py-2 hover:bg-white/10 transition">‚à´ Gi·∫£i T√≠ch</button>
            <button onclick="switchPage('casio-880-hinh-hoc'); closeDrawer();" class="w-full text-left px-4 py-2 hover:bg-white/10 transition">üìê H√¨nh H·ªçc Oxyz</button>
            <button onclick="switchPage('casio-880-xac-suat'); closeDrawer();" class="w-full text-left px-4 py-2 hover:bg-white/10 transition">üé≤ X√°c Su·∫•t</button>
            <button onclick="switchPage('casio-880-hay-la'); closeDrawer();" class="w-full text-left px-4 py-2 hover:bg-white/10 transition">‚≠ê B√†i To√°n Hay</button>
          </div>
        </details>

        <details class="group rounded-xl bg-white/5 overflow-hidden">
          <summary class="cursor-pointer list-none px-3 py-3 flex items-center justify-between">
            <span class="font-bold flex items-center gap-2"><i class="fas fa-folder-open text-primary w-5"></i> Kho ƒê·ªÅ Thi</span>
            <i class="fas fa-chevron-down text-xs opacity-70 group-open:rotate-180 transition"></i>
          </summary>
          <div class="pb-2">
            <button onclick="switchPage('exam-tsa'); closeDrawer();" class="w-full text-left px-4 py-2 hover:bg-white/10 transition">üî¥ TSA</button>
            <button onclick="switchPage('exam-hsa'); closeDrawer();" class="w-full text-left px-4 py-2 hover:bg-white/10 transition">üü¢ HSA</button>
            <button onclick="switchPage('exam-thpt'); closeDrawer();" class="w-full text-left px-4 py-2 hover:bg-white/10 transition">üîµ THPTQG</button>
            <button onclick="switchPage('exam-vact'); closeDrawer();" class="w-full text-left px-4 py-2 hover:bg-white/10 transition">üü£ VACT</button>
          </div>
        </details>

        <button onclick="switchPage('favorites'); closeDrawer();" class="w-full text-left px-3 py-3 rounded-xl bg-white/5 hover:bg-white/10 transition flex items-center gap-2">
          <i class="fas fa-bookmark text-primary w-5"></i> Y√™u th√≠ch
        </button>

        <div class="mt-4 rounded-xl border border-white/10 p-3 text-xs text-gray-400">
          <div class="font-bold text-gray-300 mb-1">Tip nh·ªè</div>
          <div>Vu·ªët ngang ·ªü Trang ch·ªß ƒë·ªÉ xem th√™m card. D·∫•u ‚≠ê ƒë·ªÉ l∆∞u b√†i, ‚úÖ ƒë·ªÉ ƒë√°nh d·∫•u ƒë√£ h·ªçc.</div>
        </div>
      </div>
    </div>
  </div>

  <!-- MAIN -->
  <main class="flex-grow">

    <!-- HOME -->
    <section id="page-home" class="page-section">
      <div class="pt-16 pb-10 text-center px-4 relative">

        <div class="relative z-10 mb-6 group">
          <img id="home-avatar-big" src="https://scontent.fhan20-1.fna.fbcdn.net/v/t39.30808-6/555733813_810835077974194_4101748610057312325_n.jpg?_nc_cat=103&amp;ccb=1-7&amp;_nc_sid=6ee11a&amp;_nc_eui2=AeHDTdYqWdNFRjU8d2r5jAhjebOdWmQ9kbF5s51aZD2RsVt3gAla-o2NSldRE2u4LlyamgEm9bbvjTd0fQAskB83&amp;_nc_ohc=j7pYsq1YFBIQ7kNvwGqVswS&amp;_nc_oc=Adlz2s1APpaob9-hqj_UUypHn8eLkWbC-8zRqetZZ8lreC3w1g2GCzKFBPN2XtBmeX0&amp;_nc_zt=23&amp;_nc_ht=scontent.fhan20-1.fna&amp;_nc_gid=kLhRTL2MoYzPK4ngUv-7zA&amp;oh=00_AflDQh0Z0RhjS2cSJvz5BRhWHcCxjtV7wKug-AHH5fEuuA&amp;oe=6958839A" class="w-32 h-32 rounded-full border-4 border-primary mx-auto ring-glow object-cover transition transform group-hover:scale-105 duration-500">
        </div>

        <h1 class="relative z-10 text-4xl md:text-7xl font-black mb-3 uppercase tracking-tighter">
          <span class="text-white">Ueih</span> <span class="text-primary">Casio</span>
        </h1>

        <p class="relative z-10 text-lg md:text-2xl text-gray-300 font-medium italic mb-10" id="home-slogan">Casio L·∫π L·∫π R·ªìi Chuy·ªÉn C√¢u Thoiüê£</p>

        <!-- quick actions -->
        <div class="relative z-10 container mx-auto max-w-5xl">
          <div class="flex flex-col md:flex-row gap-3 justify-center mb-8">
            <button onclick="switchPage('casio-so-hoc')" class="px-5 py-3 rounded-2xl bg-primary hover:bg-primaryDark transition font-black tracking-wide flex items-center justify-center gap-2 soft-shadow">
              <i class="fas fa-play"></i> V√†o h·ªçc lu√¥n
            </button>
            <button onclick="switchPage('casio-880-so-hoc')" class="px-5 py-3 rounded-2xl bg-white/5 hover:bg-white/10 transition font-bold tracking-wide flex items-center justify-center gap-2 border border-white/10">
              <i class="fas fa-calculator"></i> V√†o h·ªçc 880
            </button>

            <button onclick="switchPage('exam-tsa')" class="px-5 py-3 rounded-2xl bg-white/5 hover:bg-white/10 transition font-bold tracking-wide flex items-center justify-center gap-2 border border-white/10">
              <i class="fas fa-file-lines"></i> Qu·∫•t ƒë·ªÅ TSA
            </button>
            <button onclick="switchPage('favorites')" class="px-5 py-3 rounded-2xl bg-white/5 hover:bg-white/10 transition font-bold tracking-wide flex items-center justify-center gap-2 border border-white/10">
              <i class="fas fa-bookmark"></i> B√†i ƒë√£ l∆∞u
            </button>
          </div>

          <!-- feature cards slider -->
          <div class="horizontal-scroll px-2 pb-4">
            <div id="home-cards-anchor" class="hidden"></div>
          </div>
          <p class="md:hidden text-xs text-gray-500 mt-1 animate-pulse"><i class="fas fa-arrows-left-right"></i> Vu·ªët ƒë·ªÉ xem th√™m</p>
        </div>
      </div>
    </section>

    <!-- DETAIL PAGE -->
    <section id="page-detail" class="page-section container mx-auto px-4 py-10 max-w-4xl">
      <div class="flex flex-col md:flex-row md:items-end md:justify-between gap-4 mb-6 border-b border-white/10 pb-4">
        <div class="min-w-0">
          <button onclick="switchPage('home')" class="text-gray-400 hover:text-primary text-xs font-bold uppercase mb-2 flex items-center gap-1">
            <i class="fas fa-arrow-left"></i> Trang ch·ªß
          </button>
          <h2 id="detail-title" class="text-2xl md:text-4xl font-black text-white uppercase tracking-wide truncate">Danh m·ª•c</h2>
          <div class="mt-3">
            <div class="flex items-center gap-3 text-xs text-gray-400">
              <span id="detail-count">0 b√†i</span>
              <span class="opacity-50">‚Ä¢</span>
              <span id="detail-progress-text">0% ho√†n th√†nh (0/0)</span>
            </div>
            <div class="mt-2 h-2 rounded-full bg-white/5 overflow-hidden border border-white/10">
              <div id="detail-progress-bar" class="h-full bg-primary w-0 transition-all duration-300" style="width: 0%;"></div>
            </div>
          </div>
        </div>

        <div class="flex flex-col sm:flex-row gap-2">
          <div class="relative flex-1">
            <i class="fas fa-magnifying-glass absolute left-3 top-1/2 -translate-y-1/2 text-gray-500"></i>
            <input id="inp-search" oninput="renderList(currentCat)" placeholder="T√¨m b√†i theo ti√™u ƒë·ªÅ..." class="w-full pl-9 pr-3 py-3 bg-white/5 border border-white/10 rounded-2xl outline-none focus:border-primary/60 text-sm">
          </div>

          <button onclick="openAddModal()" class="admin-only bg-primary hover:bg-primaryDark text-white px-5 py-3 rounded-2xl font-black shadow-lg transition flex items-center justify-center gap-2 text-sm whitespace-nowrap">
            <i class="fas fa-plus"></i> Th√™m B√†i
          </button>
        </div>
      </div>

      <div id="detail-list" class="space-y-4"></div>

      <div id="empty-msg" class="hidden text-center py-20 opacity-60">
        <i class="fas fa-folder-open text-6xl mb-4 text-gray-700"></i>
        <p class="text-gray-500">Ch∆∞a c√≥ b√†i n√†o. Admin v√†o th√™m ph√°t l√† ch√°y ngay.</p>
      </div>
    </section>

    <!-- FAVORITES -->
    <section id="page-favorites" class="page-section container mx-auto px-4 py-10 max-w-4xl">
      <div class="flex items-end justify-between mb-6 border-b border-white/10 pb-4">
        <div>
          <button onclick="switchPage('home')" class="text-gray-400 hover:text-primary text-xs font-bold uppercase mb-2 flex items-center gap-1">
            <i class="fas fa-arrow-left"></i> Trang ch·ªß
          </button>
          <h2 class="text-2xl md:text-4xl font-black uppercase tracking-wide">
            <i class="fas fa-bookmark text-primary mr-2"></i>Y√™u th√≠ch
          </h2>
          <p class="text-gray-400 text-sm mt-2">M·∫•y b√†i b·∫°n ‚≠ê s·∫Ω n·∫±m h·∫øt ·ªü ƒë√¢y. ‚ÄúSave l√† th·∫Øng‚Äù.</p>
        </div>
        <button onclick="clearFavorites()" class="px-4 py-2 rounded-xl bg-white/5 hover:bg-white/10 transition text-xs font-bold text-gray-300 border border-white/10">
          X√≥a h·∫øt
        </button>
      </div>

      <div id="fav-list" class="space-y-4"></div>

      <div id="fav-empty" class="hidden text-center py-20 opacity-60">
        <i class="fas fa-star text-6xl mb-4 text-gray-700"></i>
        <p class="text-gray-500">Ch∆∞a c√≥ b√†i n√†o ƒë∆∞·ª£c ‚≠ê. ƒêi l∆∞·ªõt b√†i r·ªìi l∆∞u l·∫°i nha.</p>
      </div>
    </section>

  </main>

  <!-- FOOTER -->
  <footer class="bg-black/40 border-t border-white/10 py-8 mt-auto backdrop-blur">
    <div class="container mx-auto px-4 flex flex-col sm:flex-row gap-4 justify-between items-center">
      <div class="text-xs text-gray-500 font-bold">¬© 2025 UEIH CASIO. Built with calculator energy.</div>
      <div class="flex gap-6">
        <a id="social-fb" href="#" target="_blank" class="text-gray-400 hover:text-blue-500 text-xl transition transform hover:scale-110"><i class="fab fa-facebook"></i></a>
        <a id="social-tt" href="#" target="_blank" class="text-gray-400 hover:text-white text-xl transition transform hover:scale-110"><i class="fab fa-tiktok"></i></a>
        <a id="social-yt" href="#" target="_blank" class="text-gray-400 hover:text-red-500 text-xl transition transform hover:scale-110"><i class="fab fa-youtube"></i></a>
      </div>
    </div>
  </footer>

  <!-- floating admin quick menu -->
  <div class="fixed bottom-6 right-6 z-50 flex flex-col items-end gap-3">
    <div id="admin-menu" class="hidden bg-cardBg border border-primary/30 p-3 rounded-2xl soft-shadow w-72">
      <div class="text-[10px] font-black text-primary uppercase mb-2 tracking-widest border-b border-white/10 pb-1">Admin Mode</div>
      <button onclick="openConfigModal()" class="w-full text-left px-3 py-2 hover:bg-white/5 rounded-xl text-sm text-gray-300 hover:text-white">
        <i class="fas fa-pen w-5 text-primary"></i> S·ª≠a giao di·ªán
      </button>
      <button onclick="openHomeCardsModal()" class="w-full text-left px-3 py-2 hover:bg-white/5 rounded-xl text-sm text-gray-300 hover:text-white">
        <i class="fas fa-wand-magic-sparkles w-5 text-yellow-400"></i> S·ª≠a card Trang ch·ªß
      </button>
      <button onclick="exportHTML()" class="w-full text-left px-3 py-2 hover:bg-white/5 rounded-xl text-sm text-gray-300 hover:text-white">
        <i class="fas fa-file-export w-5 text-green-500"></i> Export web (HTML)
      </button>
      <button onclick="resetLocal()" class="w-full text-left px-3 py-2 hover:bg-white/5 rounded-xl text-sm text-gray-300 hover:text-white">
        <i class="fas fa-rotate-left w-5 text-gray-300"></i> Reset d·ªØ li·ªáu m√°y
      </button>
      <button onclick="logoutAdmin()" class="w-full text-left px-3 py-2 hover:bg-red-900/20 rounded-xl text-sm text-red-400 hover:text-red-300">
        <i class="fas fa-right-from-bracket w-5"></i> Tho√°t
      </button>
      <div class="mt-2 text-[11px] text-gray-500 leading-snug">
        L∆∞u √Ω: admin password n·∫±m trong code n√™n ch·ªâ ‚Äúkh√≥a UI‚Äù th√¥i, kh√¥ng ph·∫£i b·∫£o m·∫≠t real.
      </div>
    </div>
  </div>

  <!-- TOAST -->
  <div id="toast-wrap" class="fixed top-4 right-4 z-[200] space-y-2"></div>

  <!-- MODALS -->
  <div id="add-modal" class="fixed inset-0 bg-black/80 z-[100] hidden items-center justify-center backdrop-blur-sm">
    <div class="bg-cardBg p-6 rounded-2xl w-full max-w-md border border-white/10 soft-shadow animate-pop max-h-[90vh] overflow-y-auto">
      <h3 id="modal-title" class="text-xl font-black text-white mb-4">Th√™m B√†i M·ªõi</h3>
      <div class="space-y-4">
        <input type="text" id="inp-title" class="w-full p-3 bg-white/5 border border-white/10 rounded-2xl focus:border-primary outline-none text-white" placeholder="Ti√™u ƒë·ªÅ b√†i h·ªçc">
        
        <div>
          <label id="lbl-link1" class="text-xs font-bold text-gray-400 block mb-1 uppercase">Link ch√≠nh</label>
          <input type="text" id="inp-link" class="w-full p-3 bg-white/5 border border-white/10 rounded-2xl focus:border-primary outline-none text-white" placeholder="URL...">
        </div>

        <div id="div-link-giai">
           <label id="lbl-link2" class="text-xs font-bold text-gray-400 block mb-1 uppercase">Link ph·ª•</label>
          <input type="text" id="inp-link-giai" class="w-full p-3 bg-white/5 border border-white/10 rounded-2xl focus:border-green-500 outline-none text-white" placeholder="URL...">
        </div>

        <input type="text" id="inp-desc" class="w-full p-3 bg-white/5 border border-white/10 rounded-2xl focus:border-primary outline-none text-white" placeholder="M√¥ t·∫£ ng·∫Øn">

        <!-- New Meta Fields -->
        <div class="grid grid-cols-1 gap-3">
          <div>
            <label class="text-xs font-bold text-gray-400 block mb-1 uppercase">M·ª©c ƒë·ªô Skill</label>
            <select id="inp-level" class="w-full p-3 bg-white/5 border border-white/10 rounded-2xl focus:border-primary outline-none text-white appearance-none">
              <option value="">-- Ch·ªçn m·ª©c ƒë·ªô --</option>
              <option value="C∆° B·∫£n">C∆° B·∫£n</option>
              <option value="V·∫≠n D·ª•ng">V·∫≠n D·ª•ng</option>
              <option value="M·∫°nhhh">M·∫°nhhh</option>
              <option value="Vip">Vip</option>
            </select>
          </div>
          
          <div>
            <label class="text-xs font-bold text-gray-400 block mb-1 uppercase">D√†nh cho (ƒêa ch·ªçn)</label>
            <div class="flex flex-wrap gap-2">
              <label class="inline-flex items-center p-2 rounded-xl bg-white/5 border border-white/10 cursor-pointer select-none">
                <input type="checkbox" class="chk-target w-4 h-4 accent-primary mr-2" value="TSA"> TSA
              </label>
              <label class="inline-flex items-center p-2 rounded-xl bg-white/5 border border-white/10 cursor-pointer select-none">
                <input type="checkbox" class="chk-target w-4 h-4 accent-green-500 mr-2" value="HSA"> HSA
              </label>
              <label class="inline-flex items-center p-2 rounded-xl bg-white/5 border border-white/10 cursor-pointer select-none">
                <input type="checkbox" class="chk-target w-4 h-4 accent-blue-500 mr-2" value="THPTQG"> THPTQG
              </label>
              <label class="inline-flex items-center p-2 rounded-xl bg-white/5 border border-white/10 cursor-pointer select-none">
                <input type="checkbox" class="chk-target w-4 h-4 accent-purple-500 mr-2" value="VACT"> VACT
              </label>
            </div>
          </div>
        </div>

        <div class="flex items-center gap-3 bg-yellow-500/10 p-3 rounded-2xl border border-yellow-500/20 cursor-pointer" onclick="document.getElementById('inp-draft').click()">
          <input type="checkbox" id="inp-draft" class="w-5 h-5 accent-yellow-500 cursor-pointer">
          <label class="block text-sm font-bold text-yellow-500 cursor-pointer">Ch·∫ø ƒë·ªô Nh√°p (h·ªçc sinh th·∫•y b·ªã kh√≥a)</label>
        </div>

        <input type="hidden" id="inp-cat-hidden">
        <input type="hidden" id="inp-edit-id">
        <div class="flex gap-2">
          <button onclick="closeModal('add-modal')" class="flex-1 py-3 bg-white/5 hover:bg-white/10 text-white font-bold rounded-2xl">H·ªßy</button>
          <button onclick="saveLesson()" class="flex-1 py-3 bg-primary hover:bg-primaryDark text-white font-black rounded-2xl">L∆∞u B√†i</button>
        </div>
      </div>
    </div>
  </div>

  <div id="password-modal" class="fixed inset-0 bg-black/85 z-[110] items-center justify-center hidden">
    <div class="bg-cardBg p-8 rounded-2xl w-full max-w-sm border border-primary/30 soft-shadow animate-pop">
      <h3 class="text-xl font-black text-primary text-center mb-6 uppercase tracking-widest">Admin Access</h3>
      <input type="password" id="admin-pass" class="w-full p-3 bg-white/5 border border-white/10 rounded-2xl text-center text-white focus:border-primary outline-none mb-3" placeholder="PASSWORD">
      <button onclick="checkPassword()" class="w-full py-3 bg-primary hover:bg-primaryDark text-white font-black rounded-2xl transition">M·ªû KH√ìA</button>
      <button onclick="closeModal('password-modal')" class="w-full py-2 mt-2 text-gray-400 text-xs font-bold hover:text-white">QUAY L·∫†I</button>
    </div>
  </div>

  <div id="config-modal" class="fixed inset-0 bg-black/80 z-[110] hidden items-center justify-center backdrop-blur-sm">
    <div class="bg-cardBg p-6 rounded-2xl w-full max-w-md border border-white/10 soft-shadow animate-pop">
      <h3 class="text-xl font-black text-primary mb-4">C√†i ƒê·∫∑t Giao Di·ªán</h3>
      <div class="space-y-4">
        <div>
          <label class="text-xs font-bold text-gray-500 uppercase">Link Avatar</label>
          <input type="text" id="cfg-avatar" class="w-full p-3 bg-white/5 border border-white/10 rounded-2xl text-white outline-none focus:border-primary/60">
        </div>
        <div>
          <label class="text-xs font-bold text-gray-500 uppercase">T√™n Web</label>
          <input type="text" id="cfg-logo-text" class="w-full p-3 bg-white/5 border border-white/10 rounded-2xl text-white outline-none focus:border-primary/60">
        </div>
        <div>
          <label class="text-xs font-bold text-gray-500 uppercase">Slogan</label>
          <input type="text" id="cfg-slogan" class="w-full p-3 bg-white/5 border border-white/10 rounded-2xl text-white outline-none focus:border-primary/60">
        </div>

        <div class="grid grid-cols-1 sm:grid-cols-3 gap-2">
          <div class="sm:col-span-3 text-xs font-bold text-gray-500 uppercase mt-2">Social links</div>
          <input type="text" id="cfg-fb" placeholder="Facebook URL" class="p-3 bg-white/5 border border-white/10 rounded-2xl text-white outline-none focus:border-primary/60">
          <input type="text" id="cfg-tt" placeholder="TikTok URL" class="p-3 bg-white/5 border border-white/10 rounded-2xl text-white outline-none focus:border-primary/60">
          <input type="text" id="cfg-yt" placeholder="YouTube URL" class="p-3 bg-white/5 border border-white/10 rounded-2xl text-white outline-none focus:border-primary/60">
        </div>

        <div class="flex gap-2 pt-2">
          <button onclick="saveConfig()" class="flex-1 py-3 bg-primary hover:bg-primaryDark text-white font-black rounded-2xl">C·∫≠p Nh·∫≠t</button>
          <button onclick="closeModal('config-modal')" class="flex-1 py-3 bg-white/5 hover:bg-white/10 text-white font-bold rounded-2xl">H·ªßy</button>
        </div>
      </div>
    </div>
  </div>

  <div id="homecards-modal" class="fixed inset-0 bg-black/80 z-[120] hidden items-center justify-center backdrop-blur-sm">
    <div class="bg-cardBg p-6 rounded-2xl w-full max-w-2xl border border-white/10 soft-shadow animate-pop max-h-[82vh] overflow-y-auto">
      <div class="flex items-center justify-between mb-4">
        <h3 class="text-xl font-black text-yellow-400">S·ª≠a Card Trang ch·ªß</h3>
        <button onclick="closeModal('homecards-modal')" class="w-9 h-9 rounded-xl bg-white/5 hover:bg-white/10 transition flex items-center justify-center">
          <i class="fas fa-xmark"></i>
        </button>
      </div>

      <div class="text-xs text-gray-400 mb-4">M·ªói card: icon FontAwesome (vd: <span class="font-bold">fa-bolt</span>), title, desc.</div>

      <div id="homecards-editor" class="space-y-3"></div>

      <div class="flex gap-2 mt-5">
        <button onclick="addHomeCard()" class="px-4 py-2 rounded-xl bg-white/5 hover:bg-white/10 border border-white/10 text-sm font-bold">+ Th√™m card</button>
        <button onclick="saveHomeCards()" class="flex-1 py-2 rounded-xl bg-yellow-500 hover:bg-yellow-400 text-black font-black">L∆∞u card</button>
      </div>
    </div>
  </div>

  <script>
    // =========================
    // STATE (localStorage)
    // =========================
    const LS = {
      theme: 'ueih_theme',
      config: 'ueih_siteConfig',
      db: 'ueih_database',
      fav: 'ueih_favs',
      done: 'ueih_done',
      homeCards: 'ueih_homecards'
    };

    // Default config
    let siteConfig = {"avatar":"https://scontent.fhan20-1.fna.fbcdn.net/v/t39.30808-6/555733813_810835077974194_4101748610057312325_n.jpg?_nc_cat=103&ccb=1-7&_nc_sid=6ee11a&_nc_eui2=AeHDTdYqWdNFRjU8d2r5jAhjebOdWmQ9kbF5s51aZD2RsVt3gAla-o2NSldRE2u4LlyamgEm9bbvjTd0fQAskB83&_nc_ohc=j7pYsq1YFBIQ7kNvwGqVswS&_nc_oc=Adlz2s1APpaob9-hqj_UUypHn8eLkWbC-8zRqetZZ8lreC3w1g2GCzKFBPN2XtBmeX0&_nc_zt=23&_nc_ht=scontent.fhan20-1.fna&_nc_gid=kLhRTL2MoYzPK4ngUv-7zA&oh=00_AflDQh0Z0RhjS2cSJvz5BRhWHcCxjtV7wKug-AHH5fEuuA&oe=6958839A","logoText":"Ueih Casio","slogan":"Casio L·∫π L·∫π R·ªìi Chuy·ªÉn C√¢u Thoiüê£","social":{"fb":"https://www.facebook.com/ueih.7ron","tt":"https://www.tiktok.com/@ueih.ron1609","yt":"https://youtube.com"}};

    // Home cards (editable)
    let homeCards = [{"icon":"fa-bolt","color":"text-blue-400","bg":"bg-blue-900/30","border":"hover:border-blue-500/50","title":"T·ªëc ƒê·ªô √Ånh S√°ng","desc":"Ph∆∞∆°ng ph√°p b·∫•m m√°y gi√∫p ti·∫øt ki·ªám 70% th·ªùi gian l√†m b√†i."},{"icon":"fa-brain","color":"text-purple-400","bg":"bg-purple-900/30","border":"hover:border-purple-500/50","title":"T∆∞ Duy Casio","desc":"Kh√¥ng ch·ªâ l√† b·∫•m m√°y, m√† l√† t∆∞ duy gi·∫£i to√°n tr·∫Øc nghi·ªám."},{"icon":"fa-fire","color":"text-yellow-400","bg":"bg-yellow-900/30","border":"hover:border-yellow-500/50","title":"ƒê·ªôc Quy·ªÅn Ueih","desc":"C√°c tuy·ªát chi√™u ch·ªâ ƒë∆∞·ª£c chia s·∫ª n·ªôi b·ªô t·∫°i ƒë√¢y."}];

    const categories = {
      'casio-so-hoc': "S·ªë H·ªçc ",
      'casio-ham-so': "H√†m S·ªë & ƒê·ªì Th·ªã",
      'casio-giai-tich': "Gi·∫£i T√≠ch",
      'casio-hinh-hoc': "H√¨nh H·ªçc Oxyz",
      'casio-xac-suat': "X√°c Su·∫•t & T·ªï H·ª£p",
      'casio-hay-la': "C√°c B√†i To√°n Hay & L·∫°",

      'casio-880-so-hoc': "880 ‚Ä¢ S·ªë H·ªçc ",
      'casio-880-ham-so': "880 ‚Ä¢ H√†m S·ªë & ƒê·ªì Th·ªã",
      'casio-880-giai-tich': "880 ‚Ä¢ Gi·∫£i T√≠ch",
      'casio-880-hinh-hoc': "880 ‚Ä¢ H√¨nh H·ªçc Oxyz",
      'casio-880-xac-suat': "880 ‚Ä¢ X√°c Su·∫•t & T·ªï H·ª£p",
      'casio-880-hay-la': "880 ‚Ä¢ C√°c B√†i To√°n Hay & L·∫°",
      'exam-tsa': "Luy·ªán ƒê·ªÅ TSA",
      'exam-hsa': "Luy·ªán ƒê·ªÅ HSA",
      'exam-thpt': "ƒê·ªÅ THPT Qu·ªëc Gia",
      'exam-vact': "ƒê·ªÅ VACT"
    };

    // Default database
    let database = [{"id":1767035091741,"cat":"casio-so-hoc","title":"S·ªë ch·ªØ s·ªë 0 t·∫≠n c√πng c·ªßa n!","link":"https://drive.google.com/file/d/11TN3XA3fOqT4D6eJGInXgk98t_7iSzVs/view?usp=drivesdk","linkGiai":"","desc":"M·∫πo t√≠nh nhanh","status":"published","level":"C∆° B·∫£n","targets":["TSA","VACT"]}];

    let currentCat = '';
    let isAdmin = false;
    let favorites = new Set();
    let doneMap = {};

    // =========================
    // HELPERS
    // =========================
    function safeParse(json, fallback) {
      try { return JSON.parse(json); } catch (e) { return fallback; }
    }

    function toast(msg, type='info') {
      const wrap = document.getElementById('toast-wrap');
      const div = document.createElement('div');
      const base = "px-4 py-3 rounded-2xl border text-sm font-bold shadow-lg animate-pop";
      const style = {
        info: "bg-cardBg/90 border-white/10 text-gray-200",
        ok: "bg-green-900/30 border-green-500/30 text-green-200",
        warn: "bg-yellow-900/30 border-yellow-500/30 text-yellow-200",
        err: "bg-red-900/30 border-red-500/30 text-red-200"
      }[type] || "bg-cardBg/90 border-white/10 text-gray-200";
      div.className = base + " " + style;
      div.innerHTML = `<div class="flex items-center gap-2"><i class="fas ${type==='ok'?'fa-circle-check':type==='err'?'fa-triangle-exclamation':type==='warn'?'fa-circle-exclamation':'fa-circle-info'}"></i><span>${msg}</span></div>`;
      wrap.appendChild(div);
      setTimeout(() => { div.style.opacity = 0; div.style.transform = 'translateY(-6px)'; }, 2200);
      setTimeout(() => { div.remove(); }, 2600);
    }

    function openDrawer() {
      document.getElementById('drawer-overlay').classList.remove('hidden');
      requestAnimationFrame(() => document.getElementById('drawer').classList.add('open'));
    }
    function closeDrawer() {
      document.getElementById('drawer').classList.remove('open');
      setTimeout(() => document.getElementById('drawer-overlay').classList.add('hidden'), 200);
    }

    // =========================
    // THEME
    // =========================
    function applyTheme(theme) {
      const root = document.documentElement;
      if(theme === 'light') root.classList.remove('dark');
      else root.classList.add('dark');
      document.getElementById('theme-ico').className = (theme === 'light') ? 'fas fa-sun' : 'fas fa-moon';
    }
    function toggleTheme() {
      const cur = localStorage.getItem(LS.theme) || 'dark';
      const next = cur === 'dark' ? 'light' : 'dark';
      localStorage.setItem(LS.theme, next);
      applyTheme(next);
      toast(next === 'light' ? 'B·∫≠t Light mode ‚ú®' : 'B·∫≠t Dark mode üåô', 'ok');
    }

    // =========================
    // LOAD/SAVE
    // =========================
    function loadState() {
      const theme = localStorage.getItem(LS.theme) || 'dark';
      applyTheme(theme);

      const cfg = localStorage.getItem(LS.config);
      if(cfg) siteConfig = {...siteConfig, ...safeParse(cfg, siteConfig)};

      const db = localStorage.getItem(LS.db);
      if(db) database = safeParse(db, database);

      const fav = localStorage.getItem(LS.fav);
      if(fav) favorites = new Set(safeParse(fav, []));

      const done = localStorage.getItem(LS.done);
      if(done) doneMap = safeParse(done, {});

      const hc = localStorage.getItem(LS.homeCards);
      if(hc) homeCards = safeParse(hc, homeCards);
    }

    function saveState() {
      localStorage.setItem(LS.config, JSON.stringify(siteConfig));
      localStorage.setItem(LS.db, JSON.stringify(database));
      localStorage.setItem(LS.fav, JSON.stringify([...favorites]));
      localStorage.setItem(LS.done, JSON.stringify(doneMap));
      localStorage.setItem(LS.homeCards, JSON.stringify(homeCards));
    }

    function resetLocal() {
      if(!confirm("Reset localStorage? (s·∫Ω m·∫•t d·ªØ li·ªáu ƒë√£ l∆∞u tr√™n m√°y)")) return;
      Object.values(LS).forEach(k => localStorage.removeItem(k));
      toast("ƒê√£ reset d·ªØ li·ªáu m√°y. Refresh trang l√† v·ªÅ m·∫∑c ƒë·ªãnh.", "warn");
    }

    // =========================
    // RENDER CONFIG + HOME CARDS
    // =========================
    function renderConfig() {
      document.getElementById('nav-avatar').src = siteConfig.avatar;
      document.getElementById('home-avatar-big').src = siteConfig.avatar;
      document.getElementById('nav-text').innerText = siteConfig.logoText;
      document.getElementById('home-slogan').innerText = siteConfig.slogan;

      document.getElementById('cfg-avatar').value = siteConfig.avatar;
      document.getElementById('cfg-logo-text').value = siteConfig.logoText;
      document.getElementById('cfg-slogan').value = siteConfig.slogan;

      document.getElementById('cfg-fb').value = siteConfig.social.fb || '';
      document.getElementById('cfg-tt').value = siteConfig.social.tt || '';
      document.getElementById('cfg-yt').value = siteConfig.social.yt || '';

      document.getElementById('social-fb').href = siteConfig.social.fb || '#';
      document.getElementById('social-tt').href = siteConfig.social.tt || '#';
      document.getElementById('social-yt').href = siteConfig.social.yt || '#';
    }

    function renderHomeCards() {
      const anchor = document.getElementById('home-cards-anchor');
      const parent = anchor.parentElement;
      [...parent.children].forEach(ch => { if(ch !== anchor) ch.remove(); });

      homeCards.forEach((c) => {
        const div = document.createElement('div');
        div.className = `bg-cardBg border border-white/10 p-6 rounded-2xl ${c.border || 'hover:border-primary/50'} transition duration-300 group cursor-default`;
        div.innerHTML = `
          <div class="w-12 h-12 rounded-xl ${c.bg || 'bg-primary/20'} ${c.color || 'text-primary'} flex items-center justify-center text-2xl mb-4 group-hover:scale-110 transition">
            <i class="fas ${c.icon || 'fa-star'}"></i>
          </div>
          <h3 class="font-black text-lg mb-2 text-white">${escapeHtml(c.title || '')}</h3>
          <p class="text-sm text-gray-400 leading-relaxed">${escapeHtml(c.desc || '')}</p>
        `;
        parent.insertBefore(div, anchor);
      });
    }

    function escapeHtml(str) {
      return (str ?? '').toString()
        .replaceAll('&','&amp;').replaceAll('<','&lt;')
        .replaceAll('>','&gt;').replaceAll('"','&quot;')
        .replaceAll("'","&#039;");
    }

    // =========================
    // NAV + PAGES
    // =========================
    function switchPage(pageId) {
      document.querySelectorAll('.page-section').forEach(el => el.classList.remove('active'));

      if(pageId === 'home') {
        document.getElementById('page-home').classList.add('active');
        currentCat = '';
      } else if(pageId === 'favorites') {
        currentCat = 'favorites';
        renderFavorites();
        document.getElementById('page-favorites').classList.add('active');
      } else {
        currentCat = pageId;
        document.getElementById('detail-title').innerText = categories[pageId] || 'Danh m·ª•c';
        document.getElementById('inp-search').value = '';
        renderList(pageId);
        document.getElementById('page-detail').classList.add('active');
      }
      document.getElementById('admin-menu').classList.add('hidden');
      window.scrollTo({top:0, behavior:'smooth'});
    }

    // =========================
    // FAVORITES + DONE
    // =========================
    function toggleFav(id) {
      if(favorites.has(id)) favorites.delete(id);
      else favorites.add(id);
      saveState();
      toast(favorites.has(id) ? 'ƒê√£ ‚≠ê b√†i n√†y!' : 'ƒê√£ b·ªè ‚≠ê', 'ok');
      if(currentCat === 'favorites') renderFavorites();
      else if(currentCat) renderList(currentCat);
    }

    function toggleDone(id) {
      doneMap[id] = !doneMap[id];
      if(!doneMap[id]) delete doneMap[id];
      saveState();
      toast(doneMap[id] ? '‚úÖ ƒê√°nh d·∫•u ƒë√£ h·ªçc' : '‚Ü©Ô∏è B·ªè ƒë√°nh d·∫•u', 'info');
      if(currentCat === 'favorites') renderFavorites();
      else if(currentCat) renderList(currentCat);
    }

    function clearFavorites() {
      if(!confirm("X√≥a h·∫øt b√†i y√™u th√≠ch?")) return;
      favorites = new Set();
      saveState();
      renderFavorites();
      toast("ƒê√£ x√≥a h·∫øt ‚≠ê", "warn");
    }

    // =========================
    // RENDER LIST
    // =========================
    function getLevelBadge(level) {
      if(!level) return '';
      let cls = 'badge-level-basic';
      if(level === 'V·∫≠n D·ª•ng') cls = 'badge-level-apply';
      if(level === 'M·∫°nhhh') cls = 'badge-level-strong';
      if(level === 'Vip') cls = 'badge-level-vip';
      return `<span class="${cls} text-[10px] font-bold px-2 py-0.5 rounded-lg border ml-2">${level}</span>`;
    }

    function getTargetBadges(targets) {
      if(!Array.isArray(targets) || targets.length === 0) return '';
      return targets.map(t => `<span class="badge-target">${t}</span>`).join(' ');
    }

    function computeProgress(catId) {
      const visibleToStudents = database.filter(i => i.cat === catId && i.status !== 'draft');
      const total = visibleToStudents.length;
      const done = visibleToStudents.filter(i => !!doneMap[i.id]).length;
      const pct = total === 0 ? 0 : Math.round(done * 100 / total);
      return { total, done, pct };
    }

    function renderDetailMeta(catId, itemsShown) {
      const { total, done, pct } = computeProgress(catId);
      document.getElementById('detail-count').innerText = `${itemsShown} b√†i`;
      document.getElementById('detail-progress-text').innerText = `${pct}% ho√†n th√†nh (${done}/${total})`;
      document.getElementById('detail-progress-bar').style.width = `${pct}%`;
    }

    function renderList(catId) {
      const list = document.getElementById('detail-list');
      const empty = document.getElementById('empty-msg');
      const q = (document.getElementById('inp-search').value || '').trim().toLowerCase();

      list.innerHTML = '';
      let items = database.filter(i => i.cat === catId);
      const isExam = catId.startsWith('exam-');
      const isCasio = catId.startsWith('casio-');

      if(q) items = items.filter(i => (i.title || '').toLowerCase().includes(q) || (i.desc || '').toLowerCase().includes(q));
      items.sort((a,b) => (a.status === 'draft') - (b.status === 'draft'));

      if(items.length === 0) empty.classList.remove('hidden');
      else empty.classList.add('hidden');

      renderDetailMeta(catId, items.length);

      items.forEach(item => {
        const isDraft = (item.status === 'draft');
        const isLocked = isDraft && !isAdmin;

        let cardClass = isLocked
          ? "bg-white/5 border border-dashed border-white/20 p-5 rounded-2xl flex flex-col md:flex-row items-start md:items-center gap-4 locked-item relative"
          : "bg-cardBg border border-white/10 hover:border-primary/50 p-5 rounded-2xl flex flex-col md:flex-row items-start md:items-center gap-4 transition group relative";
        
        if(isAdmin && isDraft) cardClass = "bg-yellow-900/10 border border-dashed border-yellow-500/50 p-5 rounded-2xl flex flex-col md:flex-row gap-4 relative";

        const favOn = favorites.has(item.id);
        const doneOn = !!doneMap[item.id];
        const badge = isDraft ? `<span class="ml-2 px-2 py-0.5 rounded text-[10px] font-black bg-yellow-500 text-black">NH√ÅP</span>` : "";
        const doneBadge = doneOn ? `<span class="ml-2 px-2 py-0.5 rounded text-[10px] font-black bg-green-500 text-black">DONE</span>` : "";
        
        let buttonsHTML = '';
        if(isLocked) {
          buttonsHTML = `<div class="text-gray-500 text-sm italic"><i class="fas fa-lock mr-1"></i> Coming Soon</div>`;
        } else if (isExam || isCasio) {
          const btn1Label = isCasio ? 'Xem' : 'ƒê·ªÅ';
          const btn1Icon = isCasio ? 'fa-play' : 'fa-file-alt';
          const btn2Label = isCasio ? 'Luy·ªán' : 'Ch·ªØa';
          const btn2Icon = isCasio ? 'fa-dumbbell' : 'fa-video';
          const link2 = item.linkGiai || '#';
          const hasLink2 = item.linkGiai && item.linkGiai.length > 1;

          buttonsHTML = `
            <div class="flex gap-2 w-full md:w-auto mt-2 md:mt-0">
              <a href="${item.link}" target="_blank" class="flex-1 md:flex-none px-4 py-2 bg-white/10 hover:bg-white/20 text-white text-xs font-black rounded-xl uppercase tracking-wider text-center transition">
                <i class="fas ${btn1Icon} mr-1"></i> ${btn1Label}
              </a>
              ${ (isExam || (isCasio && hasLink2)) ? `
              <a href="${link2}" target="_blank" class="flex-1 md:flex-none px-4 py-2 bg-primary hover:bg-primaryDark text-white text-xs font-black rounded-xl uppercase tracking-wider text-center transition ${!hasLink2 ? 'opacity-50 pointer-events-none':''}">
                <i class="fas ${btn2Icon} mr-1"></i> ${btn2Label}
              </a>
              ` : '' }
            </div>
          `;
        } else {
          // fallback default single click
          cardClass += " cursor-pointer";
        }

        const clickAttr = (!isExam && !isCasio && !isLocked) ? `onclick="window.open('${item.link}', '_blank')"` : "";

        // Meta tags rendering
        const levelBadge = getLevelBadge(item.level);
        const targetBadges = getTargetBadges(item.targets);

        const html = `
          <div class="${cardClass}" ${clickAttr}>
            <div class="w-11 h-11 rounded-2xl bg-white/5 flex items-center justify-center shrink-0 ${!isLocked ? 'group-hover:bg-primary transition' : ''}">
              ${isLocked ? '<i class="fas fa-lock text-sm text-gray-500"></i>' : '<i class="fas fa-play text-xs text-white"></i>'}
            </div>

            <div class="flex-grow min-w-0 w-full">
              <h3 class="font-black text-gray-200 ${!isLocked ? 'group-hover:text-white' : ''} text-base transition flex flex-wrap items-center">
                ${escapeHtml(item.title)} ${badge} ${doneBadge} ${levelBadge}
              </h3>
              <p class="text-sm text-gray-400 ${isLocked ? 'opacity-70' : ''} mb-1">${escapeHtml(item.desc || '')}</p>
              
              <div class="flex flex-wrap gap-1 mb-2">${targetBadges}</div>

              <div class="mt-2 flex flex-wrap gap-2 ${isLocked ? 'hidden' : ''}">
                <button onclick="event.stopPropagation(); toggleFav(${item.id})"
                  class="px-3 py-2 rounded-xl border border-white/10 bg-white/5 hover:bg-white/10 transition text-xs font-black flex items-center gap-2">
                  <i class="fas ${favOn ? 'fa-star text-yellow-400' : 'fa-star text-gray-400'}"></i>
                  ${favOn ? 'ƒê√£ l∆∞u' : 'L∆∞u'}
                </button>

                <button onclick="event.stopPropagation(); toggleDone(${item.id})"
                  class="px-3 py-2 rounded-xl border border-white/10 bg-white/5 hover:bg-white/10 transition text-xs font-black flex items-center gap-2">
                  <i class="fas ${doneOn ? 'fa-circle-check text-green-400' : 'fa-circle'}"></i>
                  ${doneOn ? 'ƒê√£ h·ªçc' : 'ƒê√°nh d·∫•u'}
                </button>
              </div>
            </div>

            ${buttonsHTML}

            <div class="admin-only absolute top-3 right-3 flex gap-2">
               <button onclick="event.stopPropagation(); editLesson(${item.id})" class="w-8 h-8 rounded-lg bg-blue-500/10 hover:bg-blue-500/20 text-blue-400 flex items-center justify-center transition" title="S·ª≠a">
                <i class="fas fa-pen text-xs"></i>
              </button>
              <button onclick="event.stopPropagation(); deleteLesson(${item.id})" class="w-8 h-8 rounded-lg bg-red-500/10 hover:bg-red-500/20 text-red-400 flex items-center justify-center transition" title="X√≥a">
                <i class="fas fa-trash-alt text-xs"></i>
              </button>
            </div>
          </div>
        `;
        list.innerHTML += html;
      });
    }

    // =========================
    // FAVORITES RENDER
    // =========================
    function renderFavorites() {
      const list = document.getElementById('fav-list');
      const empty = document.getElementById('fav-empty');
      list.innerHTML = '';

      const favItems = database.filter(i => favorites.has(i.id) && (i.status !== 'draft' || isAdmin));
      if(favItems.length === 0) {
        empty.classList.remove('hidden');
        return;
      }
      empty.classList.add('hidden');

      favItems.forEach(item => {
        const isExam = item.cat.startsWith('exam-');
        const isCasio = item.cat.startsWith('casio-');
        const doneOn = !!doneMap[item.id];
        const link2 = item.linkGiai || '#';
        const hasLink2 = item.linkGiai && item.linkGiai.length > 1;

        let btnHTML = '';
        if (isExam || isCasio) {
            const l1 = isCasio ? 'Xem' : 'ƒê·ªÅ';
            const l2 = isCasio ? 'Luy·ªán' : 'Ch·ªØa';
            btnHTML = `
             <a href="${item.link}" target="_blank" class="px-3 py-2 rounded-xl border border-white/10 bg-white/5 hover:bg-white/10 transition text-xs font-black"><i class="fas fa-external-link-alt mr-1"></i> ${l1}</a>
             ${hasLink2 ? `<a href="${link2}" target="_blank" class="px-3 py-2 rounded-xl bg-primary hover:bg-primaryDark transition text-xs font-black"><i class="fas fa-play mr-1"></i> ${l2}</a>` : ''}
            `;
        } else {
             btnHTML = `<a href="${item.link}" target="_blank" class="px-3 py-2 rounded-xl bg-primary hover:bg-primaryDark transition text-xs font-black"><i class="fas fa-play mr-1"></i> M·ªü b√†i</a>`;
        }

        const html = `
          <div class="bg-cardBg border border-white/10 hover:border-primary/50 p-5 rounded-2xl transition group relative">
            <div class="flex items-start gap-4">
              <div class="w-11 h-11 rounded-2xl bg-white/5 group-hover:bg-primary transition flex items-center justify-center shrink-0">
                <i class="fas fa-bookmark text-white text-sm"></i>
              </div>
              <div class="flex-grow min-w-0">
                <div class="text-xs text-gray-400 font-bold uppercase tracking-widest">${escapeHtml(categories[item.cat] || item.cat)}</div>
                <h3 class="font-black text-white mt-1">${escapeHtml(item.title)} ${getLevelBadge(item.level)}</h3>
                <p class="text-sm text-gray-400 mt-1">${escapeHtml(item.desc || '')}</p>
                <div class="mt-1">${getTargetBadges(item.targets)}</div>

                <div class="mt-3 flex flex-wrap gap-2">
                  <button onclick="toggleFav(${item.id})" class="px-3 py-2 rounded-xl border border-white/10 bg-white/5 hover:bg-white/10 transition text-xs font-black flex items-center gap-2">
                    <i class="fas fa-star text-yellow-400"></i> B·ªè l∆∞u
                  </button>
                  <button onclick="toggleDone(${item.id})" class="px-3 py-2 rounded-xl border border-white/10 bg-white/5 hover:bg-white/10 transition text-xs font-black flex items-center gap-2">
                    <i class="fas ${doneOn ? 'fa-circle-check text-green-400' : 'fa-circle'}"></i>
                    ${doneOn ? 'ƒê√£ h·ªçc' : 'ƒê√°nh d·∫•u'}
                  </button>
                  ${btnHTML}
                </div>
              </div>
            </div>
          </div>
        `;
        list.innerHTML += html;
      });
    }

    // =========================
    // ADMIN
    // =========================
    function requestAdmin() { isAdmin ? toggleAdminMenu() : openModal('password-modal'); }
    function toggleAdminMenu() { document.getElementById('admin-menu').classList.toggle('hidden'); }

    function checkPassword() {
      const pass = (document.getElementById('admin-pass').value || '').trim();
      // SHA-256 for basic check
      async function sha256Hex(str) {
        const enc = new TextEncoder().encode(str);
        const buf = await window.crypto.subtle.digest('SHA-256', enc);
        return Array.from(new Uint8Array(buf)).map(b=>b.toString(16).padStart(2,'0')).join('');
      }
      sha256Hex(pass).then(hash => {
        if(hash === "eac63159e8c153a78d0598cf6726d8500119ad7d3ef2e2489da56eb7127d06df") {
          isAdmin = true;
          document.body.classList.add('admin-mode');
          document.getElementById('admin-indicator').classList.add('bg-green-500');
          document.getElementById('admin-indicator').classList.remove('hidden');
          document.getElementById('btn-admin').classList.add('text-primary', 'border-primary');
          document.getElementById('admin-menu').classList.remove('hidden');
          closeModal('password-modal');
          toast("üîì Admin Access Granted!", "ok");
          if(currentCat && currentCat !== 'favorites') renderList(currentCat);
        } else {
          toast("Sai password r·ªìi üòÖ", "err");
        }
      }).catch(e => toast("L·ªói crypto browser", "err"));
      document.getElementById('admin-pass').value = '';
    }

    function logoutAdmin() {
      isAdmin = false;
      document.body.classList.remove('admin-mode');
      document.getElementById('admin-menu').classList.add('hidden');
      document.getElementById('admin-indicator').classList.remove('bg-green-500');
      document.getElementById('btn-admin').classList.remove('text-primary', 'border-primary');
      toast("üîí Logged out.", "warn");
      if(currentCat && currentCat !== 'favorites') renderList(currentCat);
    }

    // =========================
    // MODALS & CRUD
    // =========================
    function closeModal(id) { document.getElementById(id).classList.add('hidden'); document.getElementById(id).classList.remove('flex'); }
    function openModal(id) {
      const el = document.getElementById(id);
      el.classList.remove('hidden');
      el.classList.add('flex');
    }

    function openAddModal() {
      document.getElementById('inp-cat-hidden').value = currentCat;
      document.getElementById('inp-edit-id').value = ""; // clear edit id
      document.getElementById('modal-title').innerText = "Th√™m B√†i M·ªõi";
      
      // Clear form
      document.getElementById('inp-title').value = '';
      document.getElementById('inp-link').value = '';
      document.getElementById('inp-link-giai').value = '';
      document.getElementById('inp-desc').value = '';
      document.getElementById('inp-level').value = '';
      document.querySelectorAll('.chk-target').forEach(c => c.checked = false);
      document.getElementById('inp-draft').checked = false;

      // Adjust inputs visibility/labels based on category
      const isExam = currentCat.startsWith('exam-');
      const isCasio = currentCat.startsWith('casio-');

      if(isExam) {
         document.getElementById('lbl-link1').innerText = "Link ƒê·ªÅ";
         document.getElementById('div-link-giai').classList.remove('hidden');
         document.getElementById('lbl-link2').innerText = "Link Ch·ªØa (Video)";
      } else if (isCasio) {
         document.getElementById('lbl-link1').innerText = "Link Xem (Video/L√Ω thuy·∫øt)";
         document.getElementById('div-link-giai').classList.remove('hidden');
         document.getElementById('lbl-link2').innerText = "Link Luy·ªán (B√†i t·∫≠p)";
      } else {
         document.getElementById('lbl-link1').innerText = "Link B√†i";
         document.getElementById('div-link-giai').classList.add('hidden');
      }

      openModal('add-modal');
    }

    function editLesson(id) {
      const item = database.find(x => x.id === id);
      if(!item) return;

      document.getElementById('inp-cat-hidden').value = item.cat;
      document.getElementById('inp-edit-id').value = item.id;
      document.getElementById('modal-title').innerText = "Ch·ªânh S·ª≠a B√†i";

      document.getElementById('inp-title').value = item.title;
      document.getElementById('inp-link').value = item.link;
      document.getElementById('inp-link-giai').value = item.linkGiai || '';
      document.getElementById('inp-desc').value = item.desc || '';
      document.getElementById('inp-level').value = item.level || '';
      document.getElementById('inp-draft').checked = (item.status === 'draft');

      // Check boxes
      const targets = item.targets || [];
      document.querySelectorAll('.chk-target').forEach(c => {
         c.checked = targets.includes(c.value);
      });

      // Visibility Logic (same as Add)
      const isExam = item.cat.startsWith('exam-');
      const isCasio = item.cat.startsWith('casio-');

      if(isExam) {
         document.getElementById('lbl-link1').innerText = "Link ƒê·ªÅ";
         document.getElementById('div-link-giai').classList.remove('hidden');
         document.getElementById('lbl-link2').innerText = "Link Ch·ªØa";
      } else if (isCasio) {
         document.getElementById('lbl-link1').innerText = "Link Xem";
         document.getElementById('div-link-giai').classList.remove('hidden');
         document.getElementById('lbl-link2').innerText = "Link Luy·ªán";
      } else {
         document.getElementById('lbl-link1').innerText = "Link B√†i";
         document.getElementById('div-link-giai').classList.add('hidden');
      }

      openModal('add-modal');
    }

    function saveLesson() {
      const id = document.getElementById('inp-edit-id').value;
      const title = document.getElementById('inp-title').value.trim();
      const link = document.getElementById('inp-link').value.trim();
      const linkGiai = document.getElementById('inp-link-giai').value.trim();
      const desc = document.getElementById('inp-desc').value.trim();
      const cat = document.getElementById('inp-cat-hidden').value;
      const isDraft = document.getElementById('inp-draft').checked;
      const level = document.getElementById('inp-level').value;
      
      const targets = [];
      document.querySelectorAll('.chk-target:checked').forEach(c => targets.push(c.value));

      if(!title) return toast("Thi·∫øu ti√™u ƒë·ªÅ!", "err");

      if(id) {
        // UPDATE
        const idx = database.findIndex(x => x.id == id);
        if(idx !== -1) {
          database[idx] = { 
            ...database[idx], 
            title, link, linkGiai, desc, status: isDraft?'draft':'published',
            level, targets
          };
          toast("ƒê√£ c·∫≠p nh·∫≠t b√†i vi·∫øt üëå", "ok");
        }
      } else {
        // CREATE
        database.push({
          id: Date.now(),
          cat, title, link: link||"#", linkGiai, desc, 
          status: isDraft?'draft':'published',
          level, targets
        });
        toast("ƒê√£ th√™m b√†i m·ªõi ‚úÖ", "ok");
      }

      saveState();
      closeModal('add-modal');
      renderList(cat);
    }

    function deleteLesson(id) {
      if(!confirm("X√≥a b√†i n√†y?")) return;
      const idx = database.findIndex(x => x.id === id);
      if(idx > -1) {
        database.splice(idx, 1);
        favorites.delete(id);
        delete doneMap[id];
        saveState();
        toast("ƒê√£ x√≥a b√†i.", "warn");
        renderList(currentCat);
      }
    }

    function openConfigModal() { openModal('config-modal'); }
    function saveConfig() {
      siteConfig.avatar = document.getElementById('cfg-avatar').value.trim() || siteConfig.avatar;
      siteConfig.logoText = document.getElementById('cfg-logo-text').value.trim() || siteConfig.logoText;
      siteConfig.slogan = document.getElementById('cfg-slogan').value.trim() || siteConfig.slogan;
      siteConfig.social.fb = document.getElementById('cfg-fb').value.trim();
      siteConfig.social.tt = document.getElementById('cfg-tt').value.trim();
      siteConfig.social.yt = document.getElementById('cfg-yt').value.trim();
      saveState();
      renderConfig();
      closeModal('config-modal');
      toast("ƒê√£ c·∫≠p nh·∫≠t giao di·ªán ‚ú®", "ok");
    }

    // =========================
    // HOME CARDS
    // =========================
    function openHomeCardsModal() { renderHomeCardsEditor(); openModal('homecards-modal'); }
    function renderHomeCardsEditor() {
      const wrap = document.getElementById('homecards-editor');
      wrap.innerHTML = '';
      homeCards.forEach((c, idx) => {
        const row = document.createElement('div');
        row.className = "border border-white/10 rounded-2xl p-4 bg-white/5";
        row.innerHTML = `
          <div class="flex items-center justify-between mb-3">
            <div class="font-black text-white">Card #${idx+1}</div>
            <button onclick="removeHomeCard(${idx})" class="px-3 py-1.5 rounded-xl bg-red-500/15 hover:bg-red-500/25 text-red-200 text-xs font-black">X√≥a</button>
          </div>
          <div class="grid grid-cols-1 md:grid-cols-3 gap-2">
            <div><label class="text-[11px] font-bold text-gray-400 uppercase">Icon</label><input id="hc-icon-${idx}" value="${escapeHtml(c.icon)}" class="w-full p-3 bg-cardBg border border-white/10 rounded-2xl text-white outline-none"></div>
            <div class="md:col-span-2"><label class="text-[11px] font-bold text-gray-400 uppercase">Title</label><input id="hc-title-${idx}" value="${escapeHtml(c.title)}" class="w-full p-3 bg-cardBg border border-white/10 rounded-2xl text-white outline-none"></div>
            <div class="md:col-span-3"><label class="text-[11px] font-bold text-gray-400 uppercase">Desc</label><input id="hc-desc-${idx}" value="${escapeHtml(c.desc)}" class="w-full p-3 bg-cardBg border border-white/10 rounded-2xl text-white outline-none"></div>
          </div>
        `;
        wrap.appendChild(row);
      });
    }
    function addHomeCard() { homeCards.push({ icon:'fa-star', color:'text-primary', bg:'bg-primary/20', border:'hover:border-primary/50', title:'Card m·ªõi', desc:'M√¥ t·∫£...' }); renderHomeCardsEditor(); }
    function removeHomeCard(idx) { homeCards.splice(idx, 1); renderHomeCardsEditor(); }
    function saveHomeCards() {
      homeCards = homeCards.map((c, idx) => ({
        ...c,
        icon: document.getElementById(`hc-icon-${idx}`).value.trim() || c.icon,
        title: document.getElementById(`hc-title-${idx}`).value.trim() || c.title,
        desc: document.getElementById(`hc-desc-${idx}`).value.trim() || c.desc
      }));
      saveState();
      renderHomeCards();
      closeModal('homecards-modal');
      toast("ƒê√£ l∆∞u card Trang ch·ªß ü™Ñ", "ok");
    }

    // =========================
    // EXPORT HTML
    // =========================
    function exportHTML() {
      let html = document.documentElement.outerHTML;
      html = html.replace(/let siteConfig = \{[\s\S]*?\};/, `let siteConfig = ${JSON.stringify(siteConfig)};`);
      html = html.replace(/let homeCards = \[[\s\S]*?\];/, `let homeCards = ${JSON.stringify(homeCards)};`);
      html = html.replace(/let database = \[[\s\S]*?\];/, `let database = ${JSON.stringify(database)};`);
      const blob = new Blob([html], {type:'text/html'});
      const a = document.createElement('a');
      a.href = URL.createObjectURL(blob);
      a.download = 'Ueih_Casio_V4.html';
      document.body.appendChild(a); a.click(); document.body.removeChild(a);
      toast("ƒê√£ export HTML ‚úÖ", "ok");
    }

    // =========================
    // INIT
    // =========================
    function init() {
      loadState();
      renderConfig();
      renderHomeCards();
      switchPage('home'); // Fix: Show home page by default
    }
    window.addEventListener('resize', () => { if(window.innerWidth >= 768) closeDrawer(); });
    init();
  </script>
</body></html>    .ring-glow { box-shadow: 0 0 0 1px rgba(220,38,38,.25), 0 0 22px rgba(220,38,38,.28); }

    /* drawer */
    .drawer { transform: translateX(100%); transition: transform .25s ease; }
    .drawer.open { transform: translateX(0); }
  
    /* LIGHT MODE OVERRIDES (quick & dirty nh∆∞ng d√πng ·ªïn) */
    html:not(.dark) body { background-color: #f8fafc !important; color: #0f172a !important; }
    html:not(.dark) .glass { background: rgba(255,255,255,.78) !important; }
    html:not(.dark) .bg-darkBg { background-color: #f8fafc !important; }
    html:not(.dark) .bg-cardBg { background-color: rgba(255,255,255,.86) !important; }
    html:not(.dark) .text-white { color: #0f172a !important; }
    html:not(.dark) .text-gray-300 { color: #334155 !important; }
    html:not(.dark) .text-gray-400 { color: #475569 !important; }
    html:not(.dark) .text-gray-500 { color: #64748b !important; }
    html:not(.dark) .text-gray-700 { color: #94a3b8 !important; }
    html:not(.dark) .border-white\/10 { border-color: rgba(15,23,42,.12) !important; }
    html:not(.dark) .border-white\/20 { border-color: rgba(15,23,42,.18) !important; }
    html:not(.dark) .bg-white\/5 { background-color: rgba(15,23,42,.05) !important; }
    html:not(.dark) .bg-white\/10 { background-color: rgba(15,23,42,.08) !important; }
    html:not(.dark) .bg-black\/40 { background-color: rgba(255,255,255,.7) !important; }
    html:not(.dark) .bg-black\/70 { background-color: rgba(0,0,0,.35) !important; } /* overlay v·∫´n t·ªëi */
    html:not(.dark) .bg-black\/80 { background-color: rgba(0,0,0,.45) !important; }
    html:not(.dark) .bg-black\/85 { background-color: rgba(0,0,0,.5) !important; }
    html:not(.dark) .ring-glow { box-shadow: 0 0 0 1px rgba(220,38,38,.25), 0 0 18px rgba(220,38,38,.22) !important; }

  </style>
<style>*, ::before, ::after{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgb(59 130 246 / 0.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }::backdrop{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgb(59 130 246 / 0.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }/* ! tailwindcss v3.4.17 | MIT License | https://tailwindcss.com */*,::after,::before{box-sizing:border-box;border-width:0;border-style:solid;border-color:#e5e7eb}::after,::before{--tw-content:''}:host,html{line-height:1.5;-webkit-text-size-adjust:100%;-moz-tab-size:4;tab-size:4;font-family:Montserrat, sans-serif;font-feature-settings:normal;font-variation-settings:normal;-webkit-tap-highlight-color:transparent}body{margin:0;line-height:inherit}hr{height:0;color:inherit;border-top-width:1px}abbr:where([title]){-webkit-text-decoration:underline dotted;text-decoration:underline dotted}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit}a{color:inherit;text-decoration:inherit}b,strong{font-weight:bolder}code,kbd,pre,samp{font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;font-feature-settings:normal;font-variation-settings:normal;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}table{text-indent:0;border-color:inherit;border-collapse:collapse}button,input,optgroup,select,textarea{font-family:inherit;font-feature-settings:inherit;font-variation-settings:inherit;font-size:100%;font-weight:inherit;line-height:inherit;letter-spacing:inherit;color:inherit;margin:0;padding:0}button,select{text-transform:none}button,input:where([type=button]),input:where([type=reset]),input:where([type=submit]){-webkit-appearance:button;background-color:transparent;background-image:none}:-moz-focusring{outline:auto}:-moz-ui-invalid{box-shadow:none}progress{vertical-align:baseline}::-webkit-inner-spin-button,::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}summary{display:list-item}blockquote,dd,dl,figure,h1,h2,h3,h4,h5,h6,hr,p,pre{margin:0}fieldset{margin:0;padding:0}legend{padding:0}menu,ol,ul{list-style:none;margin:0;padding:0}dialog{padding:0}textarea{resize:vertical}input::placeholder,textarea::placeholder{opacity:1;color:#9ca3af}[role=button],button{cursor:pointer}:disabled{cursor:default}audio,canvas,embed,iframe,img,object,svg,video{display:block;vertical-align:middle}img,video{max-width:100%;height:auto}[hidden]:where(:not([hidden=until-found])){display:none}.container{width:100%}@media (min-width: 640px){.container{max-width:640px}}@media (min-width: 768px){.container{max-width:768px}}@media (min-width: 1024px){.container{max-width:1024px}}@media (min-width: 1280px){.container{max-width:1280px}}@media (min-width: 1536px){.container{max-width:1536px}}.pointer-events-none{pointer-events:none}.fixed{position:fixed}.absolute{position:absolute}.relative{position:relative}.sticky{position:sticky}.inset-0{inset:0px}.bottom-0{bottom:0px}.bottom-6{bottom:1.5rem}.bottom-\[-12\%\]{bottom:-12%}.left-1\/2{left:50%}.left-3{left:0.75rem}.left-\[-10\%\]{left:-10%}.right-0{right:0px}.right-4{right:1rem}.right-6{right:1.5rem}.right-\[-12\%\]{right:-12%}.top-0{top:0px}.top-1\/2{top:50%}.top-4{top:1rem}.top-\[-10\%\]{top:-10%}.top-full{top:100%}.right-3{right:0.75rem}.top-3{top:0.75rem}.z-10{z-index:10}.z-50{z-index:50}.z-\[-1\]{z-index:-1}.z-\[100\]{z-index:100}.z-\[110\]{z-index:110}.z-\[120\]{z-index:120}.z-\[200\]{z-index:200}.z-\[90\]{z-index:90}.mx-auto{margin-left:auto;margin-right:auto}.mb-1{margin-bottom:0.25rem}.mb-10{margin-bottom:2.5rem}.mb-2{margin-bottom:0.5rem}.mb-3{margin-bottom:0.75rem}.mb-4{margin-bottom:1rem}.mb-6{margin-bottom:1.5rem}.mb-8{margin-bottom:2rem}.mr-1{margin-right:0.25rem}.mr-2{margin-right:0.5rem}.mt-1{margin-top:0.25rem}.mt-2{margin-top:0.5rem}.mt-3{margin-top:0.75rem}.mt-4{margin-top:1rem}.mt-5{margin-top:1.25rem}.mt-auto{margin-top:auto}.block{display:block}.flex{display:flex}.grid{display:grid}.hidden{display:none}.h-10{height:2.5rem}.h-2{height:0.5rem}.h-2\.5{height:0.625rem}.h-20{height:5rem}.h-32{height:8rem}.h-5{height:1.25rem}.h-9{height:2.25rem}.h-\[520px\]{height:520px}.h-full{height:100%}.h-12{height:3rem}.h-11{height:2.75rem}.max-h-\[82vh\]{max-height:82vh}.min-h-screen{min-height:100vh}.w-0{width:0px}.w-10{width:2.5rem}.w-2{width:0.5rem}.w-2\.5{width:0.625rem}.w-32{width:8rem}.w-5{width:1.25rem}.w-64{width:16rem}.w-72{width:18rem}.w-9{width:2.25rem}.w-\[520px\]{width:520px}.w-\[88\%\]{width:88%}.w-full{width:100%}.w-12{width:3rem}.w-11{width:2.75rem}.min-w-0{min-width:0px}.max-w-2xl{max-width:42rem}.max-w-4xl{max-width:56rem}.max-w-5xl{max-width:64rem}.max-w-md{max-width:28rem}.max-w-sm{max-width:24rem}.flex-1{flex:1 1 0%}.shrink-0{flex-shrink:0}.flex-grow{flex-grow:1}.-translate-x-1\/2{--tw-translate-x:-50%;transform:translate(var(--tw-translate-x), var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.-translate-y-1\/2{--tw-translate-y:-50%;transform:translate(var(--tw-translate-x), var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.transform{transform:translate(var(--tw-translate-x), var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}@keyframes pop{0%{transform:scale(0.96);opacity:0}100%{transform:scale(1);opacity:1}}.animate-pop{animation:pop 0.18s ease-out forwards}@keyframes pulse{50%{opacity:.5}}.animate-pulse{animation:pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite}@keyframes slideIn{0%{opacity:0;transform:translateY(-8px)}100%{opacity:1;transform:translateY(0)}}.animate-slide-in{animation:slideIn 0.35s ease-out forwards}.cursor-pointer{cursor:pointer}.cursor-default{cursor:default}.select-none{-webkit-user-select:none;user-select:none}.list-none{list-style-type:none}.grid-cols-1{grid-template-columns:repeat(1, minmax(0, 1fr))}.flex-col{flex-direction:column}.flex-wrap{flex-wrap:wrap}.items-start{align-items:flex-start}.items-end{align-items:flex-end}.items-center{align-items:center}.justify-center{justify-content:center}.justify-between{justify-content:space-between}.gap-1{gap:0.25rem}.gap-2{gap:0.5rem}.gap-3{gap:0.75rem}.gap-4{gap:1rem}.gap-6{gap:1.5rem}.space-x-8 > :not([hidden]) ~ :not([hidden]){--tw-space-x-reverse:0;margin-right:calc(2rem * var(--tw-space-x-reverse));margin-left:calc(2rem * calc(1 - var(--tw-space-x-reverse)))}.space-y-2 > :not([hidden]) ~ :not([hidden]){--tw-space-y-reverse:0;margin-top:calc(0.5rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(0.5rem * var(--tw-space-y-reverse))}.space-y-3 > :not([hidden]) ~ :not([hidden]){--tw-space-y-reverse:0;margin-top:calc(0.75rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(0.75rem * var(--tw-space-y-reverse))}.space-y-4 > :not([hidden]) ~ :not([hidden]){--tw-space-y-reverse:0;margin-top:calc(1rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(1rem * var(--tw-space-y-reverse))}.overflow-hidden{overflow:hidden}.overflow-y-auto{overflow-y:auto}.overflow-x-hidden{overflow-x:hidden}.truncate{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.rounded-2xl{border-radius:1rem}.rounded-full{border-radius:9999px}.rounded-lg{border-radius:0.5rem}.rounded-xl{border-radius:0.75rem}.border{border-width:1px}.border-4{border-width:4px}.border-b{border-bottom-width:1px}.border-l{border-left-width:1px}.border-t{border-top-width:1px}.border-black{--tw-border-opacity:1;border-color:rgb(0 0 0 / var(--tw-border-opacity, 1))}.border-primary{--tw-border-opacity:1;border-color:rgb(220 38 38 / var(--tw-border-opacity, 1))}.border-primary\/30{border-color:rgb(220 38 38 / 0.3)}.border-white\/10{border-color:rgb(255 255 255 / 0.1)}.border-white\/5{border-color:rgb(255 255 255 / 0.05)}.border-yellow-500\/20{border-color:rgb(234 179 8 / 0.2)}.border-green-500\/30{border-color:rgb(34 197 94 / 0.3)}.bg-darkBg{--tw-bg-opacity:1;background-color:rgb(2 6 23 / var(--tw-bg-opacity, 1))}.bg-black\/40{background-color:rgb(0 0 0 / 0.4)}.bg-black\/70{background-color:rgb(0 0 0 / 0.7)}.bg-black\/80{background-color:rgb(0 0 0 / 0.8)}.bg-black\/85{background-color:rgb(0 0 0 / 0.85)}.bg-cardBg{--tw-bg-opacity:1;background-color:rgb(15 23 42 / var(--tw-bg-opacity, 1))}.bg-gray-600{--tw-bg-opacity:1;background-color:rgb(75 85 99 / var(--tw-bg-opacity, 1))}.bg-green-500{--tw-bg-opacity:1;background-color:rgb(34 197 94 / var(--tw-bg-opacity, 1))}.bg-primary{--tw-bg-opacity:1;background-color:rgb(220 38 38 / var(--tw-bg-opacity, 1))}.bg-primary\/10{background-color:rgb(220 38 38 / 0.1)}.bg-white\/5{background-color:rgb(255 255 255 / 0.05)}.bg-yellow-500{--tw-bg-opacity:1;background-color:rgb(234 179 8 / var(--tw-bg-opacity, 1))}.bg-yellow-500\/10{background-color:rgb(234 179 8 / 0.1)}.bg-blue-900\/30{background-color:rgb(30 58 138 / 0.3)}.bg-purple-900\/30{background-color:rgb(88 28 135 / 0.3)}.bg-yellow-900\/30{background-color:rgb(113 63 18 / 0.3)}.bg-green-900\/30{background-color:rgb(20 83 45 / 0.3)}.object-cover{object-fit:cover}.p-3{padding:0.75rem}.p-4{padding:1rem}.p-6{padding:1.5rem}.p-8{padding:2rem}.p-5{padding:1.25rem}.px-2{padding-left:0.5rem;padding-right:0.5rem}.px-3{padding-left:0.75rem;padding-right:0.75rem}.px-4{padding-left:1rem;padding-right:1rem}.px-5{padding-left:1.25rem;padding-right:1.25rem}.py-10{padding-top:2.5rem;padding-bottom:2.5rem}.py-2{padding-top:0.5rem;padding-bottom:0.5rem}.py-20{padding-top:5rem;padding-bottom:5rem}.py-3{padding-top:0.75rem;padding-bottom:0.75rem}.py-6{padding-top:1.5rem;padding-bottom:1.5rem}.py-8{padding-top:2rem;padding-bottom:2rem}.pb-1{padding-bottom:0.25rem}.pb-10{padding-bottom:2.5rem}.pb-2{padding-bottom:0.5rem}.pb-4{padding-bottom:1rem}.pl-9{padding-left:2.25rem}.pr-3{padding-right:0.75rem}.pt-16{padding-top:4rem}.pt-2{padding-top:0.5rem}.text-left{text-align:left}.text-center{text-align:center}.font-sans{font-family:Montserrat, sans-serif}.text-2xl{font-size:1.5rem;line-height:2rem}.text-4xl{font-size:2.25rem;line-height:2.5rem}.text-6xl{font-size:3.75rem;line-height:1}.text-\[10px\]{font-size:10px}.text-\[11px\]{font-size:11px}.text-lg{font-size:1.125rem;line-height:1.75rem}.text-sm{font-size:0.875rem;line-height:1.25rem}.text-xl{font-size:1.25rem;line-height:1.75rem}.text-xs{font-size:0.75rem;line-height:1rem}.text-base{font-size:1rem;line-height:1.5rem}.font-black{font-weight:900}.font-bold{font-weight:700}.font-medium{font-weight:500}.uppercase{text-transform:uppercase}.normal-case{text-transform:none}.italic{font-style:italic}.leading-none{line-height:1}.leading-snug{line-height:1.375}.leading-relaxed{line-height:1.625}.tracking-tight{letter-spacing:-0.025em}.tracking-tighter{letter-spacing:-0.05em}.tracking-wide{letter-spacing:0.025em}.tracking-widest{letter-spacing:0.1em}.text-white{--tw-text-opacity:1;color:rgb(255 255 255 / var(--tw-text-opacity, 1))}.text-black{--tw-text-opacity:1;color:rgb(0 0 0 / var(--tw-text-opacity, 1))}.text-gray-300{--tw-text-opacity:1;color:rgb(209 213 219 / var(--tw-text-opacity, 1))}.text-gray-400{--tw-text-opacity:1;color:rgb(156 163 175 / var(--tw-text-opacity, 1))}.text-gray-500{--tw-text-opacity:1;color:rgb(107 114 128 / var(--tw-text-opacity, 1))}.text-gray-700{--tw-text-opacity:1;color:rgb(55 65 81 / var(--tw-text-opacity, 1))}.text-green-500{--tw-text-opacity:1;color:rgb(34 197 94 / var(--tw-text-opacity, 1))}.text-primary{--tw-text-opacity:1;color:rgb(220 38 38 / var(--tw-text-opacity, 1))}.text-red-400{--tw-text-opacity:1;color:rgb(248 113 113 / var(--tw-text-opacity, 1))}.text-yellow-400{--tw-text-opacity:1;color:rgb(250 204 21 / var(--tw-text-opacity, 1))}.text-yellow-500{--tw-text-opacity:1;color:rgb(234 179 8 / var(--tw-text-opacity, 1))}.text-blue-400{--tw-text-opacity:1;color:rgb(96 165 250 / var(--tw-text-opacity, 1))}.text-purple-400{--tw-text-opacity:1;color:rgb(192 132 252 / var(--tw-text-opacity, 1))}.text-gray-200{--tw-text-opacity:1;color:rgb(229 231 235 / var(--tw-text-opacity, 1))}.text-green-200{--tw-text-opacity:1;color:rgb(187 247 208 / var(--tw-text-opacity, 1))}.accent-yellow-500{accent-color:#eab308}.opacity-50{opacity:0.5}.opacity-60{opacity:0.6}.opacity-70{opacity:0.7}.shadow-lg{--tw-shadow:0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);--tw-shadow-colored:0 10px 15px -3px var(--tw-shadow-color), 0 4px 6px -4px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)}.outline-none{outline:2px solid transparent;outline-offset:2px}.blur-\[120px\]{--tw-blur:blur(120px);filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.backdrop-blur{--tw-backdrop-blur:blur(8px);-webkit-backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia);backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia)}.backdrop-blur-sm{--tw-backdrop-blur:blur(4px);-webkit-backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia);backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia)}.transition{transition-property:color, background-color, border-color, fill, stroke, opacity, box-shadow, transform, filter, -webkit-text-decoration-color, -webkit-backdrop-filter;transition-property:color, background-color, border-color, text-decoration-color, fill, stroke, opacity, box-shadow, transform, filter, backdrop-filter;transition-property:color, background-color, border-color, text-decoration-color, fill, stroke, opacity, box-shadow, transform, filter, backdrop-filter, -webkit-text-decoration-color, -webkit-backdrop-filter;transition-timing-function:cubic-bezier(0.4, 0, 0.2, 1);transition-duration:150ms}.transition-all{transition-property:all;transition-timing-function:cubic-bezier(0.4, 0, 0.2, 1);transition-duration:150ms}.duration-300{transition-duration:300ms}.duration-500{transition-duration:500ms}.selection\:bg-primary *::selection{--tw-bg-opacity:1;background-color:rgb(220 38 38 / var(--tw-bg-opacity, 1))}.selection\:text-white *::selection{--tw-text-opacity:1;color:rgb(255 255 255 / var(--tw-text-opacity, 1))}.selection\:bg-primary::selection{--tw-bg-opacity:1;background-color:rgb(220 38 38 / var(--tw-bg-opacity, 1))}.selection\:text-white::selection{--tw-text-opacity:1;color:rgb(255 255 255 / var(--tw-text-opacity, 1))}.hover\:scale-110:hover{--tw-scale-x:1.1;--tw-scale-y:1.1;transform:translate(var(--tw-translate-x), var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.hover\:border-primary\/40:hover{border-color:rgb(220 38 38 / 0.4)}.hover\:border-blue-500\/50:hover{border-color:rgb(59 130 246 / 0.5)}.hover\:border-purple-500\/50:hover{border-color:rgb(168 85 247 / 0.5)}.hover\:border-yellow-500\/50:hover{border-color:rgb(234 179 8 / 0.5)}.hover\:border-primary\/50:hover{border-color:rgb(220 38 38 / 0.5)}.hover\:bg-primary:hover{--tw-bg-opacity:1;background-color:rgb(220 38 38 / var(--tw-bg-opacity, 1))}.hover\:bg-primary\/10:hover{background-color:rgb(220 38 38 / 0.1)}.hover\:bg-primaryDark:hover{--tw-bg-opacity:1;background-color:rgb(153 27 27 / var(--tw-bg-opacity, 1))}.hover\:bg-red-900\/20:hover{background-color:rgb(127 29 29 / 0.2)}.hover\:bg-white\/10:hover{background-color:rgb(255 255 255 / 0.1)}.hover\:bg-white\/5:hover{background-color:rgb(255 255 255 / 0.05)}.hover\:bg-yellow-400:hover{--tw-bg-opacity:1;background-color:rgb(250 204 21 / var(--tw-bg-opacity, 1))}.hover\:bg-red-500\/20:hover{background-color:rgb(239 68 68 / 0.2)}.hover\:text-blue-400:hover{--tw-text-opacity:1;color:rgb(96 165 250 / var(--tw-text-opacity, 1))}.hover\:text-blue-500:hover{--tw-text-opacity:1;color:rgb(59 130 246 / var(--tw-text-opacity, 1))}.hover\:text-green-400:hover{--tw-text-opacity:1;color:rgb(74 222 128 / var(--tw-text-opacity, 1))}.hover\:text-primary:hover{--tw-text-opacity:1;color:rgb(220 38 38 / var(--tw-text-opacity, 1))}.hover\:text-purple-400:hover{--tw-text-opacity:1;color:rgb(192 132 252 / var(--tw-text-opacity, 1))}.hover\:text-red-300:hover{--tw-text-opacity:1;color:rgb(252 165 165 / var(--tw-text-opacity, 1))}.hover\:text-red-400:hover{--tw-text-opacity:1;color:rgb(248 113 113 / var(--tw-text-opacity, 1))}.hover\:text-red-500:hover{--tw-text-opacity:1;color:rgb(239 68 68 / var(--tw-text-opacity, 1))}.hover\:text-white:hover{--tw-text-opacity:1;color:rgb(255 255 255 / var(--tw-text-opacity, 1))}.focus\:border-green-500:focus{--tw-border-opacity:1;border-color:rgb(34 197 94 / var(--tw-border-opacity, 1))}.focus\:border-primary:focus{--tw-border-opacity:1;border-color:rgb(220 38 38 / var(--tw-border-opacity, 1))}.focus\:border-primary\/60:focus{border-color:rgb(220 38 38 / 0.6)}.group[open] .group-open\:rotate-180{--tw-rotate:180deg;transform:translate(var(--tw-translate-x), var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.group:hover .group-hover\:block{display:block}.group:hover .group-hover\:scale-105{--tw-scale-x:1.05;--tw-scale-y:1.05;transform:translate(var(--tw-translate-x), var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.group:hover .group-hover\:scale-110{--tw-scale-x:1.1;--tw-scale-y:1.1;transform:translate(var(--tw-translate-x), var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.group:hover .group-hover\:bg-primary{--tw-bg-opacity:1;background-color:rgb(220 38 38 / var(--tw-bg-opacity, 1))}.group:hover .group-hover\:text-primary{--tw-text-opacity:1;color:rgb(220 38 38 / var(--tw-text-opacity, 1))}.group:hover .group-hover\:text-white{--tw-text-opacity:1;color:rgb(255 255 255 / var(--tw-text-opacity, 1))}@media (min-width: 640px){.sm\:col-span-3{grid-column:span 3 / span 3}.sm\:grid-cols-3{grid-template-columns:repeat(3, minmax(0, 1fr))}.sm\:flex-row{flex-direction:row}}@media (min-width: 768px){.md\:block{display:block}.md\:flex{display:flex}.md\:hidden{display:none}.md\:flex-row{flex-direction:row}.md\:items-end{align-items:flex-end}.md\:items-center{align-items:center}.md\:justify-between{justify-content:space-between}.md\:text-2xl{font-size:1.5rem;line-height:2rem}.md\:text-4xl{font-size:2.25rem;line-height:2.5rem}.md\:text-7xl{font-size:4.5rem;line-height:1}}</style></head>

<body class="bg-darkBg text-white min-h-screen flex flex-col font-sans selection:bg-primary selection:text-white overflow-x-hidden admin-mode">
  <!-- background vibe -->
  <div class="fixed inset-0 bg-grid-red z-[-1] pointer-events-none"></div>
  <div class="fixed top-[-10%] left-[-10%] w-[520px] h-[520px] bg-primary/10 rounded-full blur-[120px] z-[-1]"></div>
  <div class="fixed bottom-[-12%] right-[-12%] w-[520px] h-[520px] bg-white/5 rounded-full blur-[120px] z-[-1]"></div>

  <!-- NAV -->
  <nav class="sticky top-0 z-50 border-b border-white/10 glass">
    <div class="container mx-auto px-4 h-20 flex justify-between items-center gap-3">

      <!-- logo -->
      <div onclick="switchPage('home')" class="cursor-pointer flex items-center gap-3 group select-none">
        <div class="relative">
          <img id="nav-avatar" src="https://scontent.fhan20-1.fna.fbcdn.net/v/t39.30808-6/555733813_810835077974194_4101748610057312325_n.jpg?_nc_cat=103&amp;ccb=1-7&amp;_nc_sid=6ee11a&amp;_nc_eui2=AeHDTdYqWdNFRjU8d2r5jAhjebOdWmQ9kbF5s51aZD2RsVt3gAla-o2NSldRE2u4LlyamgEm9bbvjTd0fQAskB83&amp;_nc_ohc=j7pYsq1YFBIQ7kNvwGqVswS&amp;_nc_oc=Adlz2s1APpaob9-hqj_UUypHn8eLkWbC-8zRqetZZ8lreC3w1g2GCzKFBPN2XtBmeX0&amp;_nc_zt=23&amp;_nc_ht=scontent.fhan20-1.fna&amp;_nc_gid=kLhRTL2MoYzPK4ngUv-7zA&amp;oh=00_AflDQh0Z0RhjS2cSJvz5BRhWHcCxjtV7wKug-AHH5fEuuA&amp;oe=6958839A" class="w-10 h-10 rounded-full border border-primary object-cover ring-glow group-hover:scale-110 transition duration-300">
          <div class="absolute bottom-0 right-0 w-2.5 h-2.5 bg-green-500 rounded-full border border-black"></div>
        </div>
        <div class="leading-none">
          <h1 class="font-black text-lg tracking-tighter text-white group-hover:text-primary transition" id="nav-text">Ueih Casio</h1>
          <div class="text-[10px] text-gray-400 font-bold tracking-widest uppercase">Red Phoenix</div>
        </div>
      </div>

      <!-- desktop nav -->
      <div class="hidden md:flex items-center space-x-8 text-sm font-bold uppercase tracking-wide">
        <button onclick="switchPage('home')" class="hover:text-primary transition">Trang ch·ªß</button>

        <div class="relative group">
  <button class="hover:text-primary py-6 flex items-center gap-1">
    K·ªπ nƒÉng Casio 580 <i class="fas fa-chevron-down text-[10px]"></i>
  </button>
  <div class="absolute top-full left-1/2 -translate-x-1/2 w-72 bg-cardBg border border-primary/30 soft-shadow rounded-2xl overflow-hidden hidden group-hover:block animate-slide-in">
    <button onclick="switchPage('casio-so-hoc')" class="block w-full text-left px-4 py-3 hover:bg-primary/10 hover:text-primary border-b border-white/5 normal-case transition">üî¢ S·ªë H·ªçc &amp; S·ªë Ph·ª©c</button>
    <button onclick="switchPage('casio-ham-so')" class="block w-full text-left px-4 py-3 hover:bg-primary/10 hover:text-primary border-b border-white/5 normal-case transition">üìà H√†m S·ªë &amp; ƒê·ªì Th·ªã</button>
    <button onclick="switchPage('casio-giai-tich')" class="block w-full text-left px-4 py-3 hover:bg-primary/10 hover:text-primary border-b border-white/5 normal-case transition">‚à´ Gi·∫£i T√≠ch</button>
    <button onclick="switchPage('casio-hinh-hoc')" class="block w-full text-left px-4 py-3 hover:bg-primary/10 hover:text-primary border-b border-white/5 normal-case transition">üìê H√¨nh H·ªçc Oxyz</button>
    <button onclick="switchPage('casio-xac-suat')" class="block w-full text-left px-4 py-3 hover:bg-primary/10 hover:text-primary border-b border-white/5 normal-case transition">üé≤ X√°c Su·∫•t</button>
    <button onclick="switchPage('casio-hay-la')" class="block w-full text-left px-4 py-3 bg-primary/10 hover:bg-primary hover:text-white font-bold normal-case transition">
      <i class="fas fa-star text-yellow-400 mr-1"></i> B√†i To√°n Hay
    </button>
  </div>
</div>

<div class="relative group">
  <button class="hover:text-primary py-6 flex items-center gap-1">
    K·ªπ nƒÉng Casio 880 <i class="fas fa-chevron-down text-[10px]"></i>
  </button>
  <div class="absolute top-full left-1/2 -translate-x-1/2 w-72 bg-cardBg border border-primary/30 soft-shadow rounded-2xl overflow-hidden hidden group-hover:block animate-slide-in">
    <button onclick="switchPage('casio-880-so-hoc')" class="block w-full text-left px-4 py-3 hover:bg-primary/10 hover:text-primary border-b border-white/5 normal-case transition">üî¢ S·ªë H·ªçc &amp; S·ªë Ph·ª©c</button>
    <button onclick="switchPage('casio-880-ham-so')" class="block w-full text-left px-4 py-3 hover:bg-primary/10 hover:text-primary border-b border-white/5 normal-case transition">üìà H√†m S·ªë &amp; ƒê·ªì Th·ªã</button>
    <button onclick="switchPage('casio-880-giai-tich')" class="block w-full text-left px-4 py-3 hover:bg-primary/10 hover:text-primary border-b border-white/5 normal-case transition">‚à´ Gi·∫£i T√≠ch</button>
    <button onclick="switchPage('casio-880-hinh-hoc')" class="block w-full text-left px-4 py-3 hover:bg-primary/10 hover:text-primary border-b border-white/5 normal-case transition">üìê H√¨nh H·ªçc Oxyz</button>
    <button onclick="switchPage('casio-880-xac-suat')" class="block w-full text-left px-4 py-3 hover:bg-primary/10 hover:text-primary border-b border-white/5 normal-case transition">üé≤ X√°c Su·∫•t</button>
    <button onclick="switchPage('casio-880-hay-la')" class="block w-full text-left px-4 py-3 bg-primary/10 hover:bg-primary hover:text-white font-bold normal-case transition">
      <i class="fas fa-star text-yellow-400 mr-1"></i> B√†i To√°n Hay
    </button>
  </div>
</div>

        <div class="relative group">
          <button class="hover:text-primary py-6 flex items-center gap-1">
            Kho ƒê·ªÅ Thi <i class="fas fa-chevron-down text-[10px]"></i>
          </button>
          <div class="absolute top-full left-1/2 -translate-x-1/2 w-64 bg-cardBg border border-primary/30 soft-shadow rounded-2xl overflow-hidden hidden group-hover:block animate-slide-in">
            <button onclick="switchPage('exam-tsa')" class="block w-full text-left px-4 py-3 hover:bg-primary/10 hover:text-red-400 border-b border-white/5 normal-case transition">üî¥ TSA (B√°ch Khoa)</button>
            <button onclick="switchPage('exam-hsa')" class="block w-full text-left px-4 py-3 hover:bg-primary/10 hover:text-green-400 border-b border-white/5 normal-case transition">üü¢ HSA (ƒêHQG)</button>
            <button onclick="switchPage('exam-thpt')" class="block w-full text-left px-4 py-3 hover:bg-primary/10 hover:text-blue-400 border-b border-white/5 normal-case transition">üîµ THPT Qu·ªëc Gia</button>
            <button onclick="switchPage('exam-vact')" class="block w-full text-left px-4 py-3 hover:bg-primary/10 hover:text-purple-400 normal-case transition">üü£ ƒê·ªÅ VACT</button>
          </div>
        </div>

        <button onclick="switchPage('favorites')" class="hover:text-primary transition flex items-center gap-2">
          <i class="fas fa-bookmark"></i> Y√™u th√≠ch
        </button>
      </div>

      <!-- right controls -->
      <div class="flex items-center gap-2">
        <button onclick="toggleTheme()" class="w-10 h-10 rounded-xl bg-white/5 border border-white/10 hover:border-primary/40 hover:bg-white/10 transition flex items-center justify-center" title="Light/Dark">
          <i id="theme-ico" class="fas fa-moon"></i>
        </button>

        <button onclick="requestAdmin()" id="btn-admin" class="w-10 h-10 rounded-xl bg-white/5 border border-white/10 hover:border-primary/40 hover:bg-white/10 transition flex items-center justify-center text-primary border-primary" title="Admin">
          <i class="fas fa-user-secret"></i>
        </button>

        <div id="admin-indicator" class="hidden md:block w-2 h-2 rounded-full bg-gray-600 bg-green-500"></div>

        <!-- mobile menu btn -->
        <button onclick="openDrawer()" class="md:hidden w-10 h-10 rounded-xl bg-white/5 border border-white/10 hover:bg-white/10 transition flex items-center justify-center" title="Menu">
          <i class="fas fa-bars"></i>
        </button>
      </div>
    </div>
  </nav>

  <!-- Mobile Drawer -->
  <div id="drawer-overlay" class="fixed inset-0 z-[90] hidden">
    <div class="absolute inset-0 bg-black/70 backdrop-blur-sm" onclick="closeDrawer()"></div>
    <div id="drawer" class="drawer absolute top-0 right-0 h-full w-[88%] max-w-sm bg-cardBg border-l border-white/10 soft-shadow p-4">
      <div class="flex items-center justify-between mb-4">
        <div class="font-black tracking-tight text-lg">Menu</div>
        <button onclick="closeDrawer()" class="w-9 h-9 rounded-lg bg-white/5 hover:bg-white/10 transition flex items-center justify-center">
          <i class="fas fa-xmark"></i>
        </button>
      </div>

      <div class="space-y-2 text-sm">
        <button onclick="switchPage('home'); closeDrawer();" class="w-full text-left px-3 py-3 rounded-xl bg-white/5 hover:bg-white/10 transition flex items-center gap-2">
          <i class="fas fa-house text-primary w-5"></i> Trang ch·ªß
        </button>

        <details class="group rounded-xl bg-white/5 overflow-hidden">
  <summary class="cursor-pointer list-none px-3 py-3 flex items-center justify-between">
    <span class="font-bold flex items-center gap-2"><i class="fas fa-calculator text-primary w-5"></i> K·ªπ nƒÉng Casio 580</span>
    <i class="fas fa-chevron-down text-xs opacity-70 group-open:rotate-180 transition"></i>
  </summary>
  <div class="pb-2">
    <button onclick="switchPage('casio-so-hoc'); closeDrawer();" class="w-full text-left px-4 py-2 hover:bg-white/10 transition">üî¢ S·ªë H·ªçc &amp; S·ªë Ph·ª©c</button>
    <button onclick="switchPage('casio-ham-so'); closeDrawer();" class="w-full text-left px-4 py-2 hover:bg-white/10 transition">üìà H√†m S·ªë &amp; ƒê·ªì Th·ªã</button>
    <button onclick="switchPage('casio-giai-tich'); closeDrawer();" class="w-full text-left px-4 py-2 hover:bg-white/10 transition">‚à´ Gi·∫£i T√≠ch</button>
    <button onclick="switchPage('casio-hinh-hoc'); closeDrawer();" class="w-full text-left px-4 py-2 hover:bg-white/10 transition">üìê H√¨nh H·ªçc Oxyz</button>
    <button onclick="switchPage('casio-xac-suat'); closeDrawer();" class="w-full text-left px-4 py-2 hover:bg-white/10 transition">üé≤ X√°c Su·∫•t</button>
    <button onclick="switchPage('casio-hay-la'); closeDrawer();" class="w-full text-left px-4 py-2 hover:bg-white/10 transition">‚≠ê B√†i To√°n Hay</button>
  </div>
</details>

<details class="group rounded-xl bg-white/5 overflow-hidden">
  <summary class="cursor-pointer list-none px-3 py-3 flex items-center justify-between">
    <span class="font-bold flex items-center gap-2"><i class="fas fa-calculator text-primary w-5"></i> K·ªπ nƒÉng Casio 880</span>
    <i class="fas fa-chevron-down text-xs opacity-70 group-open:rotate-180 transition"></i>
  </summary>
  <div class="pb-2">
    <button onclick="switchPage('casio-880-so-hoc'); closeDrawer();" class="w-full text-left px-4 py-2 hover:bg-white/10 transition">üî¢ S·ªë H·ªçc &amp; S·ªë Ph·ª©c</button>
    <button onclick="switchPage('casio-880-ham-so'); closeDrawer();" class="w-full text-left px-4 py-2 hover:bg-white/10 transition">üìà H√†m S·ªë &amp; ƒê·ªì Th·ªã</button>
    <button onclick="switchPage('casio-880-giai-tich'); closeDrawer();" class="w-full text-left px-4 py-2 hover:bg-white/10 transition">‚à´ Gi·∫£i T√≠ch</button>
    <button onclick="switchPage('casio-880-hinh-hoc'); closeDrawer();" class="w-full text-left px-4 py-2 hover:bg-white/10 transition">üìê H√¨nh H·ªçc Oxyz</button>
    <button onclick="switchPage('casio-880-xac-suat'); closeDrawer();" class="w-full text-left px-4 py-2 hover:bg-white/10 transition">üé≤ X√°c Su·∫•t</button>
    <button onclick="switchPage('casio-880-hay-la'); closeDrawer();" class="w-full text-left px-4 py-2 hover:bg-white/10 transition">‚≠ê B√†i To√°n Hay</button>
  </div>
</details>

        <details class="group rounded-xl bg-white/5 overflow-hidden">
          <summary class="cursor-pointer list-none px-3 py-3 flex items-center justify-between">
            <span class="font-bold flex items-center gap-2"><i class="fas fa-folder-open text-primary w-5"></i> Kho ƒê·ªÅ Thi</span>
            <i class="fas fa-chevron-down text-xs opacity-70 group-open:rotate-180 transition"></i>
          </summary>
          <div class="pb-2">
            <button onclick="switchPage('exam-tsa'); closeDrawer();" class="w-full text-left px-4 py-2 hover:bg-white/10 transition">üî¥ TSA</button>
            <button onclick="switchPage('exam-hsa'); closeDrawer();" class="w-full text-left px-4 py-2 hover:bg-white/10 transition">üü¢ HSA</button>
            <button onclick="switchPage('exam-thpt'); closeDrawer();" class="w-full text-left px-4 py-2 hover:bg-white/10 transition">üîµ THPTQG</button>
            <button onclick="switchPage('exam-vact'); closeDrawer();" class="w-full text-left px-4 py-2 hover:bg-white/10 transition">üü£ VACT</button>
          </div>
        </details>

        <button onclick="switchPage('favorites'); closeDrawer();" class="w-full text-left px-3 py-3 rounded-xl bg-white/5 hover:bg-white/10 transition flex items-center gap-2">
          <i class="fas fa-bookmark text-primary w-5"></i> Y√™u th√≠ch
        </button>

        <div class="mt-4 rounded-xl border border-white/10 p-3 text-xs text-gray-400">
          <div class="font-bold text-gray-300 mb-1">Tip nh·ªè</div>
          <div>Vu·ªët ngang ·ªü Trang ch·ªß ƒë·ªÉ xem th√™m card. D·∫•u ‚≠ê ƒë·ªÉ l∆∞u b√†i, ‚úÖ ƒë·ªÉ ƒë√°nh d·∫•u ƒë√£ h·ªçc.</div>
        </div>
      </div>
    </div>
  </div>

  <!-- MAIN -->
  <main class="flex-grow">

    <!-- HOME -->
    <section id="page-home" class="page-section">
      <div class="pt-16 pb-10 text-center px-4 relative">

        <div class="relative z-10 mb-6 group">
          <img id="home-avatar-big" src="https://scontent.fhan20-1.fna.fbcdn.net/v/t39.30808-6/555733813_810835077974194_4101748610057312325_n.jpg?_nc_cat=103&amp;ccb=1-7&amp;_nc_sid=6ee11a&amp;_nc_eui2=AeHDTdYqWdNFRjU8d2r5jAhjebOdWmQ9kbF5s51aZD2RsVt3gAla-o2NSldRE2u4LlyamgEm9bbvjTd0fQAskB83&amp;_nc_ohc=j7pYsq1YFBIQ7kNvwGqVswS&amp;_nc_oc=Adlz2s1APpaob9-hqj_UUypHn8eLkWbC-8zRqetZZ8lreC3w1g2GCzKFBPN2XtBmeX0&amp;_nc_zt=23&amp;_nc_ht=scontent.fhan20-1.fna&amp;_nc_gid=kLhRTL2MoYzPK4ngUv-7zA&amp;oh=00_AflDQh0Z0RhjS2cSJvz5BRhWHcCxjtV7wKug-AHH5fEuuA&amp;oe=6958839A" class="w-32 h-32 rounded-full border-4 border-primary mx-auto ring-glow object-cover transition transform group-hover:scale-105 duration-500">
        </div>

        <h1 class="relative z-10 text-4xl md:text-7xl font-black mb-3 uppercase tracking-tighter">
          <span class="text-white">Ueih</span> <span class="text-primary">Casio</span>
        </h1>

        <p class="relative z-10 text-lg md:text-2xl text-gray-300 font-medium italic mb-10" id="home-slogan">Casio L·∫π L·∫π R·ªìi Chuy·ªÉn C√¢u Thoiüê£</p>

        <!-- quick actions -->
        <div class="relative z-10 container mx-auto max-w-5xl">
          <div class="flex flex-col md:flex-row gap-3 justify-center mb-8">
            <button onclick="switchPage('casio-so-hoc')" class="px-5 py-3 rounded-2xl bg-primary hover:bg-primaryDark transition font-black tracking-wide flex items-center justify-center gap-2 soft-shadow">
              <i class="fas fa-play"></i> V√†o h·ªçc lu√¥n
            </button>
            <button onclick="switchPage('casio-880-so-hoc')" class="px-5 py-3 rounded-2xl bg-white/5 hover:bg-white/10 transition font-bold tracking-wide flex items-center justify-center gap-2 border border-white/10">
              <i class="fas fa-calculator"></i> V√†o h·ªçc 880
            </button>

            <button onclick="switchPage('exam-tsa')" class="px-5 py-3 rounded-2xl bg-white/5 hover:bg-white/10 transition font-bold tracking-wide flex items-center justify-center gap-2 border border-white/10">
              <i class="fas fa-file-lines"></i> Qu·∫•t ƒë·ªÅ TSA
            </button>
            <button onclick="switchPage('favorites')" class="px-5 py-3 rounded-2xl bg-white/5 hover:bg-white/10 transition font-bold tracking-wide flex items-center justify-center gap-2 border border-white/10">
              <i class="fas fa-bookmark"></i> B√†i ƒë√£ l∆∞u
            </button>
          </div>

          <!-- feature cards slider -->
          <div class="horizontal-scroll px-2 pb-4">
            <!-- cards injected by JS -->
            <div class="bg-cardBg border border-white/10 p-6 rounded-2xl hover:border-blue-500/50 transition duration-300 group cursor-default">
          <div class="w-12 h-12 rounded-xl bg-blue-900/30 text-blue-400 flex items-center justify-center text-2xl mb-4 group-hover:scale-110 transition">
            <i class="fas fa-bolt"></i>
          </div>
          <h3 class="font-black text-lg mb-2 text-white">T·ªëc ƒê·ªô √Ånh S√°ng</h3>
          <p class="text-sm text-gray-400 leading-relaxed">Ph∆∞∆°ng ph√°p b·∫•m m√°y gi√∫p ti·∫øt ki·ªám 70% th·ªùi gian l√†m b√†i.</p>
        </div><div class="bg-cardBg border border-white/10 p-6 rounded-2xl hover:border-purple-500/50 transition duration-300 group cursor-default">
          <div class="w-12 h-12 rounded-xl bg-purple-900/30 text-purple-400 flex items-center justify-center text-2xl mb-4 group-hover:scale-110 transition">
            <i class="fas fa-brain"></i>
          </div>
          <h3 class="font-black text-lg mb-2 text-white">T∆∞ Duy Casio</h3>
          <p class="text-sm text-gray-400 leading-relaxed">Kh√¥ng ch·ªâ l√† b·∫•m m√°y, m√† l√† t∆∞ duy gi·∫£i to√°n tr·∫Øc nghi·ªám.</p>
        </div><div class="bg-cardBg border border-white/10 p-6 rounded-2xl hover:border-yellow-500/50 transition duration-300 group cursor-default">
          <div class="w-12 h-12 rounded-xl bg-yellow-900/30 text-yellow-400 flex items-center justify-center text-2xl mb-4 group-hover:scale-110 transition">
            <i class="fas fa-fire"></i>
          </div>
          <h3 class="font-black text-lg mb-2 text-white">ƒê·ªôc Quy·ªÅn Ueih</h3>
          <p class="text-sm text-gray-400 leading-relaxed">C√°c tuy·ªát chi√™u ch·ªâ ƒë∆∞·ª£c chia s·∫ª n·ªôi b·ªô t·∫°i ƒë√¢y.</p>
        </div><div id="home-cards-anchor" class="hidden"></div>
          </div>
          <p class="md:hidden text-xs text-gray-500 mt-1 animate-pulse"><i class="fas fa-arrows-left-right"></i> Vu·ªët ƒë·ªÉ xem th√™m</p>
        </div>
      </div>
    </section>

    <!-- DETAIL PAGE -->
    <section id="page-detail" class="page-section container mx-auto px-4 py-10 max-w-4xl active">
      <div class="flex flex-col md:flex-row md:items-end md:justify-between gap-4 mb-6 border-b border-white/10 pb-4">
        <div class="min-w-0">
          <button onclick="switchPage('home')" class="text-gray-400 hover:text-primary text-xs font-bold uppercase mb-2 flex items-center gap-1">
            <i class="fas fa-arrow-left"></i> Trang ch·ªß
          </button>
          <h2 id="detail-title" class="text-2xl md:text-4xl font-black text-white uppercase tracking-wide truncate">S·ªë H·ªçc &amp; S·ªë Ph·ª©c</h2>
          <div class="mt-3">
            <div class="flex items-center gap-3 text-xs text-gray-400">
              <span id="detail-count">1 b√†i</span>
              <span class="opacity-50">‚Ä¢</span>
              <span id="detail-progress-text">0% ho√†n th√†nh (0/1)</span>
            </div>
            <div class="mt-2 h-2 rounded-full bg-white/5 overflow-hidden border border-white/10">
              <div id="detail-progress-bar" class="h-full bg-primary w-0 transition-all duration-300" style="width: 0%;"></div>
            </div>
          </div>
        </div>

        <div class="flex flex-col sm:flex-row gap-2">
          <div class="relative flex-1">
            <i class="fas fa-magnifying-glass absolute left-3 top-1/2 -translate-y-1/2 text-gray-500"></i>
            <input id="inp-search" oninput="renderList(currentCat)" placeholder="T√¨m b√†i theo ti√™u ƒë·ªÅ..." class="w-full pl-9 pr-3 py-3 bg-white/5 border border-white/10 rounded-2xl outline-none focus:border-primary/60 text-sm">
          </div>

          <button onclick="openAddModal()" class="admin-only bg-primary hover:bg-primaryDark text-white px-5 py-3 rounded-2xl font-black shadow-lg transition flex items-center justify-center gap-2 text-sm">
            <i class="fas fa-plus"></i> Th√™m B√†i
          </button>
        </div>
      </div>

      <div id="detail-list" class="space-y-4">
          <div class="bg-cardBg border border-white/10 hover:border-primary/50 p-5 rounded-2xl flex flex-col md:flex-row items-start md:items-center gap-4 transition group relative cursor-pointer" onclick="window.open('https://drive.google.com/file/d/11TN3XA3fOqT4D6eJGInXgk98t_7iSzVs/view?usp=drivesdk', '_blank')">
            <div class="w-11 h-11 rounded-2xl bg-white/5 flex items-center justify-center shrink-0 group-hover:bg-primary transition">
              <i class="fas fa-play text-xs text-white"></i>
            </div>

            <div class="flex-grow min-w-0 w-full">
              <h3 class="font-black text-gray-200 group-hover:text-white text-base transition">
                S·ªë ch·ªØ s·ªë 0 t·∫≠n c√πng c·ªßa n!  
              </h3>
              <p class="text-sm text-gray-400 ">D√†nh Cho TSA, VACT</p>

              <div class="mt-3 flex flex-wrap gap-2 ">
                <button onclick="event.stopPropagation(); toggleFav(1767035091741)" class="px-3 py-2 rounded-xl border border-white/10 bg-white/5 hover:bg-white/10 transition text-xs font-black flex items-center gap-2">
                  <i class="fas fa-star text-gray-400"></i>
                  L∆∞u
                </button>

                <button onclick="event.stopPropagation(); toggleDone(1767035091741)" class="px-3 py-2 rounded-xl border border-white/10 bg-white/5 hover:bg-white/10 transition text-xs font-black flex items-center gap-2">
                  <i class="fas fa-circle"></i>
                  ƒê√°nh d·∫•u
                </button>
              </div>
            </div>

            

            <button onclick="event.stopPropagation(); deleteLesson(1)" class="admin-only absolute top-3 right-3 w-9 h-9 rounded-xl hover:bg-red-500/20 text-gray-400 hover:text-red-400 flex items-center justify-center transition">
              <i class="fas fa-trash-alt"></i>
            </button>
          </div>
        </div>

      <div id="empty-msg" class="hidden text-center py-20 opacity-60">
        <i class="fas fa-folder-open text-6xl mb-4 text-gray-700"></i>
        <p class="text-gray-500">Ch∆∞a c√≥ b√†i n√†o. Admin v√†o th√™m ph√°t l√† ch√°y ngay.</p>
      </div>
    </section>

    <!-- FAVORITES -->
    <section id="page-favorites" class="page-section container mx-auto px-4 py-10 max-w-4xl">
      <div class="flex items-end justify-between mb-6 border-b border-white/10 pb-4">
        <div>
          <button onclick="switchPage('home')" class="text-gray-400 hover:text-primary text-xs font-bold uppercase mb-2 flex items-center gap-1">
            <i class="fas fa-arrow-left"></i> Trang ch·ªß
          </button>
          <h2 class="text-2xl md:text-4xl font-black uppercase tracking-wide">
            <i class="fas fa-bookmark text-primary mr-2"></i>Y√™u th√≠ch
          </h2>
          <p class="text-gray-400 text-sm mt-2">M·∫•y b√†i b·∫°n ‚≠ê s·∫Ω n·∫±m h·∫øt ·ªü ƒë√¢y. ‚ÄúSave l√† th·∫Øng‚Äù.</p>
        </div>
        <button onclick="clearFavorites()" class="px-4 py-2 rounded-xl bg-white/5 hover:bg-white/10 transition text-xs font-bold text-gray-300 border border-white/10">
          X√≥a h·∫øt
        </button>
      </div>

      <div id="fav-list" class="space-y-4"></div>

      <div id="fav-empty" class="hidden text-center py-20 opacity-60">
        <i class="fas fa-star text-6xl mb-4 text-gray-700"></i>
        <p class="text-gray-500">Ch∆∞a c√≥ b√†i n√†o ƒë∆∞·ª£c ‚≠ê. ƒêi l∆∞·ªõt b√†i r·ªìi l∆∞u l·∫°i nha.</p>
      </div>
    </section>

  </main>

  <!-- FOOTER -->
  <footer class="bg-black/40 border-t border-white/10 py-8 mt-auto backdrop-blur">
    <div class="container mx-auto px-4 flex flex-col sm:flex-row gap-4 justify-between items-center">
      <div class="text-xs text-gray-500 font-bold">¬© 2025 UEIH CASIO. Built with calculator energy.</div>
      <div class="flex gap-6">
        <a id="social-fb" href="https://www.facebook.com/ueih.7ron" target="_blank" class="text-gray-400 hover:text-blue-500 text-xl transition transform hover:scale-110"><i class="fab fa-facebook"></i></a>
        <a id="social-tt" href="https://www.tiktok.com/@ueih.ron1609" target="_blank" class="text-gray-400 hover:text-white text-xl transition transform hover:scale-110"><i class="fab fa-tiktok"></i></a>
        <a id="social-yt" href="https://youtube.com" target="_blank" class="text-gray-400 hover:text-red-500 text-xl transition transform hover:scale-110"><i class="fab fa-youtube"></i></a>
      </div>
    </div>
  </footer>

  <!-- floating admin quick menu -->
  <div class="fixed bottom-6 right-6 z-50 flex flex-col items-end gap-3">
    <div id="admin-menu" class="bg-cardBg border border-primary/30 p-3 rounded-2xl soft-shadow w-72">
      <div class="text-[10px] font-black text-primary uppercase mb-2 tracking-widest border-b border-white/10 pb-1">Admin Mode</div>
      <button onclick="openConfigModal()" class="w-full text-left px-3 py-2 hover:bg-white/5 rounded-xl text-sm text-gray-300 hover:text-white">
        <i class="fas fa-pen w-5 text-primary"></i> S·ª≠a giao di·ªán
      </button>
      <button onclick="openHomeCardsModal()" class="w-full text-left px-3 py-2 hover:bg-white/5 rounded-xl text-sm text-gray-300 hover:text-white">
        <i class="fas fa-wand-magic-sparkles w-5 text-yellow-400"></i> S·ª≠a card Trang ch·ªß
      </button>
      <button onclick="exportHTML()" class="w-full text-left px-3 py-2 hover:bg-white/5 rounded-xl text-sm text-gray-300 hover:text-white">
        <i class="fas fa-file-export w-5 text-green-500"></i> Export web (HTML)
      </button>
      <button onclick="resetLocal()" class="w-full text-left px-3 py-2 hover:bg-white/5 rounded-xl text-sm text-gray-300 hover:text-white">
        <i class="fas fa-rotate-left w-5 text-gray-300"></i> Reset d·ªØ li·ªáu m√°y
      </button>
      <button onclick="logoutAdmin()" class="w-full text-left px-3 py-2 hover:bg-red-900/20 rounded-xl text-sm text-red-400 hover:text-red-300">
        <i class="fas fa-right-from-bracket w-5"></i> Tho√°t
      </button>
      <div class="mt-2 text-[11px] text-gray-500 leading-snug">
        L∆∞u √Ω: admin password n·∫±m trong code n√™n ch·ªâ ‚Äúkh√≥a UI‚Äù th√¥i, kh√¥ng ph·∫£i b·∫£o m·∫≠t real.
      </div>
    </div>
  </div>

  <!-- TOAST -->
  <div id="toast-wrap" class="fixed top-4 right-4 z-[200] space-y-2"></div>

  <!-- MODALS -->
  <div id="add-modal" class="fixed inset-0 bg-black/80 z-[100] hidden items-center justify-center backdrop-blur-sm">
    <div class="bg-cardBg p-6 rounded-2xl w-full max-w-md border border-white/10 soft-shadow animate-pop">
      <h3 class="text-xl font-black text-white mb-4">Th√™m B√†i M·ªõi</h3>
      <div class="space-y-4">
        <input type="text" id="inp-title" class="w-full p-3 bg-white/5 border border-white/10 rounded-2xl focus:border-primary outline-none text-white" placeholder="Ti√™u ƒë·ªÅ b√†i h·ªçc">
        <input type="text" id="inp-link" class="w-full p-3 bg-white/5 border border-white/10 rounded-2xl focus:border-primary outline-none text-white" placeholder="Link (Video / File ƒê·ªÅ)">

        <div id="div-link-giai" class="hidden">
          <input type="text" id="inp-link-giai" class="w-full p-3 bg-white/5 border border-white/10 rounded-2xl focus:border-green-500 outline-none text-white" placeholder="Link L·ªùi Gi·∫£i / Video Ch·ªØa">
        </div>

        <input type="text" id="inp-desc" class="w-full p-3 bg-white/5 border border-white/10 rounded-2xl focus:border-primary outline-none text-white" placeholder="M√¥ t·∫£ ng·∫Øn">

        <div class="flex items-center gap-3 bg-yellow-500/10 p-3 rounded-2xl border border-yellow-500/20 cursor-pointer" onclick="document.getElementById('inp-draft').click()">
          <input type="checkbox" id="inp-draft" class="w-5 h-5 accent-yellow-500 cursor-pointer">
          <label class="block text-sm font-bold text-yellow-500 cursor-pointer">Ch·∫ø ƒë·ªô Nh√°p (h·ªçc sinh th·∫•y b·ªã kh√≥a)</label>
        </div>

        <input type="hidden" id="inp-cat-hidden">
        <div class="flex gap-2">
          <button onclick="closeModal('add-modal')" class="flex-1 py-3 bg-white/5 hover:bg-white/10 text-white font-bold rounded-2xl">H·ªßy</button>
          <button onclick="saveLesson()" class="flex-1 py-3 bg-primary hover:bg-primaryDark text-white font-black rounded-2xl">L∆∞u B√†i</button>
        </div>
      </div>
    </div>
  </div>

  <div id="password-modal" class="fixed inset-0 bg-black/85 z-[110] items-center justify-center hidden">
    <div class="bg-cardBg p-8 rounded-2xl w-full max-w-sm border border-primary/30 soft-shadow animate-pop">
      <h3 class="text-xl font-black text-primary text-center mb-6 uppercase tracking-widest">Admin Access</h3>
      <input type="password" id="admin-pass" class="w-full p-3 bg-white/5 border border-white/10 rounded-2xl text-center text-white focus:border-primary outline-none mb-3" placeholder="PASSWORD">
      <button onclick="checkPassword()" class="w-full py-3 bg-primary hover:bg-primaryDark text-white font-black rounded-2xl transition">M·ªû KH√ìA</button>
      <button onclick="closeModal('password-modal')" class="w-full py-2 mt-2 text-gray-400 text-xs font-bold hover:text-white">QUAY L·∫†I</button>
      <div class="text-[11px] text-gray-500 mt-3 text-center">
      </div>
</div>
  </div>

  <div id="config-modal" class="fixed inset-0 bg-black/80 z-[110] hidden items-center justify-center backdrop-blur-sm">
    <div class="bg-cardBg p-6 rounded-2xl w-full max-w-md border border-white/10 soft-shadow animate-pop">
      <h3 class="text-xl font-black text-primary mb-4">C√†i ƒê·∫∑t Giao Di·ªán</h3>
      <div class="space-y-4">
        <div>
          <label class="text-xs font-bold text-gray-500 uppercase">Link Avatar</label>
          <input type="text" id="cfg-avatar" class="w-full p-3 bg-white/5 border border-white/10 rounded-2xl text-white outline-none focus:border-primary/60">
        </div>
        <div>
          <label class="text-xs font-bold text-gray-500 uppercase">T√™n Web</label>
          <input type="text" id="cfg-logo-text" class="w-full p-3 bg-white/5 border border-white/10 rounded-2xl text-white outline-none focus:border-primary/60">
        </div>
        <div>
          <label class="text-xs font-bold text-gray-500 uppercase">Slogan</label>
          <input type="text" id="cfg-slogan" class="w-full p-3 bg-white/5 border border-white/10 rounded-2xl text-white outline-none focus:border-primary/60">
        </div>

        <div class="grid grid-cols-1 sm:grid-cols-3 gap-2">
          <div class="sm:col-span-3 text-xs font-bold text-gray-500 uppercase mt-2">Social links</div>
          <input type="text" id="cfg-fb" placeholder="Facebook URL" class="p-3 bg-white/5 border border-white/10 rounded-2xl text-white outline-none focus:border-primary/60">
          <input type="text" id="cfg-tt" placeholder="TikTok URL" class="p-3 bg-white/5 border border-white/10 rounded-2xl text-white outline-none focus:border-primary/60">
          <input type="text" id="cfg-yt" placeholder="YouTube URL" class="p-3 bg-white/5 border border-white/10 rounded-2xl text-white outline-none focus:border-primary/60">
        </div>

        <div class="flex gap-2 pt-2">
          <button onclick="saveConfig()" class="flex-1 py-3 bg-primary hover:bg-primaryDark text-white font-black rounded-2xl">C·∫≠p Nh·∫≠t</button>
          <button onclick="closeModal('config-modal')" class="flex-1 py-3 bg-white/5 hover:bg-white/10 text-white font-bold rounded-2xl">H·ªßy</button>
        </div>
      </div>
    </div>
  </div>

  <div id="homecards-modal" class="fixed inset-0 bg-black/80 z-[120] hidden items-center justify-center backdrop-blur-sm">
    <div class="bg-cardBg p-6 rounded-2xl w-full max-w-2xl border border-white/10 soft-shadow animate-pop max-h-[82vh] overflow-y-auto">
      <div class="flex items-center justify-between mb-4">
        <h3 class="text-xl font-black text-yellow-400">S·ª≠a Card Trang ch·ªß</h3>
        <button onclick="closeModal('homecards-modal')" class="w-9 h-9 rounded-xl bg-white/5 hover:bg-white/10 transition flex items-center justify-center">
          <i class="fas fa-xmark"></i>
        </button>
      </div>

      <div class="text-xs text-gray-400 mb-4">M·ªói card: icon FontAwesome (vd: <span class="font-bold">fa-bolt</span>), title, desc.</div>

      <div id="homecards-editor" class="space-y-3"></div>

      <div class="flex gap-2 mt-5">
        <button onclick="addHomeCard()" class="px-4 py-2 rounded-xl bg-white/5 hover:bg-white/10 border border-white/10 text-sm font-bold">+ Th√™m card</button>
        <button onclick="saveHomeCards()" class="flex-1 py-2 rounded-xl bg-yellow-500 hover:bg-yellow-400 text-black font-black">L∆∞u card</button>
      </div>
    </div>
  </div>

  <script>
    // =========================
    // STATE (localStorage)
    // =========================
    const LS = {
      theme: 'ueih_theme',
      config: 'ueih_siteConfig',
      db: 'ueih_database',
      fav: 'ueih_favs',
      done: 'ueih_done',
      homeCards: 'ueih_homecards'
    };

    // Default config
    let siteConfig = {"avatar":"https://scontent.fhan20-1.fna.fbcdn.net/v/t39.30808-6/555733813_810835077974194_4101748610057312325_n.jpg?_nc_cat=103&ccb=1-7&_nc_sid=6ee11a&_nc_eui2=AeHDTdYqWdNFRjU8d2r5jAhjebOdWmQ9kbF5s51aZD2RsVt3gAla-o2NSldRE2u4LlyamgEm9bbvjTd0fQAskB83&_nc_ohc=j7pYsq1YFBIQ7kNvwGqVswS&_nc_oc=Adlz2s1APpaob9-hqj_UUypHn8eLkWbC-8zRqetZZ8lreC3w1g2GCzKFBPN2XtBmeX0&_nc_zt=23&_nc_ht=scontent.fhan20-1.fna&_nc_gid=kLhRTL2MoYzPK4ngUv-7zA&oh=00_AflDQh0Z0RhjS2cSJvz5BRhWHcCxjtV7wKug-AHH5fEuuA&oe=6958839A","logoText":"Ueih Casio","slogan":"Casio L·∫π L·∫π R·ªìi Chuy·ªÉn C√¢u Thoiüê£","social":{"fb":"https://www.facebook.com/ueih.7ron","tt":"https://www.tiktok.com/@ueih.ron1609","yt":"https://youtube.com"}};

    // Home cards (editable)
    let homeCards = [{"icon":"fa-bolt","color":"text-blue-400","bg":"bg-blue-900/30","border":"hover:border-blue-500/50","title":"T·ªëc ƒê·ªô √Ånh S√°ng","desc":"Ph∆∞∆°ng ph√°p b·∫•m m√°y gi√∫p ti·∫øt ki·ªám 70% th·ªùi gian l√†m b√†i."},{"icon":"fa-brain","color":"text-purple-400","bg":"bg-purple-900/30","border":"hover:border-purple-500/50","title":"T∆∞ Duy Casio","desc":"Kh√¥ng ch·ªâ l√† b·∫•m m√°y, m√† l√† t∆∞ duy gi·∫£i to√°n tr·∫Øc nghi·ªám."},{"icon":"fa-fire","color":"text-yellow-400","bg":"bg-yellow-900/30","border":"hover:border-yellow-500/50","title":"ƒê·ªôc Quy·ªÅn Ueih","desc":"C√°c tuy·ªát chi√™u ch·ªâ ƒë∆∞·ª£c chia s·∫ª n·ªôi b·ªô t·∫°i ƒë√¢y."}];

    const categories = {
      'casio-so-hoc': "S·ªë H·ªçc & S·ªë Ph·ª©c",
      'casio-ham-so': "H√†m S·ªë & ƒê·ªì Th·ªã",
      'casio-giai-tich': "Gi·∫£i T√≠ch",
      'casio-hinh-hoc': "H√¨nh H·ªçc Oxyz",
      'casio-xac-suat': "X√°c Su·∫•t & T·ªï H·ª£p",
      'casio-hay-la': "C√°c B√†i To√°n Hay & L·∫°",

'casio-880-so-hoc': "880 ‚Ä¢ S·ªë H·ªçc & S·ªë Ph·ª©c",
'casio-880-ham-so': "880 ‚Ä¢ H√†m S·ªë & ƒê·ªì Th·ªã",
'casio-880-giai-tich': "880 ‚Ä¢ Gi·∫£i T√≠ch",
'casio-880-hinh-hoc': "880 ‚Ä¢ H√¨nh H·ªçc Oxyz",
'casio-880-xac-suat': "880 ‚Ä¢ X√°c Su·∫•t & T·ªï H·ª£p",
'casio-880-hay-la': "880 ‚Ä¢ C√°c B√†i To√°n Hay & L·∫°",
      'exam-tsa': "Luy·ªán ƒê·ªÅ TSA",
      'exam-hsa': "Luy·ªán ƒê·ªÅ HSA",
      'exam-thpt': "ƒê·ªÅ THPT Qu·ªëc Gia",
      'exam-vact': "ƒê·ªÅ VACT"
    };

    // Default database
    let database = [{"id":2,"cat":"exam-tsa","title":"ƒê·ªÅ thi th·ª≠ TSA - S·ªë 01","link":"#","linkGiai":"#","desc":"ƒê·ªÅ chu·∫©n B√°ch Khoa","status":"published"},{"id":1767035091741,"cat":"casio-so-hoc","title":"S·ªë ch·ªØ s·ªë 0 t·∫≠n c√πng c·ªßa n!","link":"https://drive.google.com/file/d/11TN3XA3fOqT4D6eJGInXgk98t_7iSzVs/view?usp=drivesdk","linkGiai":"","desc":"D√†nh Cho TSA, VACT","status":"published"}];

    let currentCat = '';
    let isAdmin = false;
    let favorites = new Set();       // ids
    let doneMap = {};                // {id: true}

    // =========================
    // HELPERS
    // =========================
    function safeParse(json, fallback) {
      try { return JSON.parse(json); } catch (e) { return fallback; }
    }

    function toast(msg, type='info') {
      const wrap = document.getElementById('toast-wrap');
      const div = document.createElement('div');
      const base = "px-4 py-3 rounded-2xl border text-sm font-bold shadow-lg animate-pop";
      const style = {
        info: "bg-cardBg/90 border-white/10 text-gray-200",
        ok: "bg-green-900/30 border-green-500/30 text-green-200",
        warn: "bg-yellow-900/30 border-yellow-500/30 text-yellow-200",
        err: "bg-red-900/30 border-red-500/30 text-red-200"
      }[type] || "bg-cardBg/90 border-white/10 text-gray-200";
      div.className = base + " " + style;
      div.innerHTML = `<div class="flex items-center gap-2"><i class="fas ${type==='ok'?'fa-circle-check':type==='err'?'fa-triangle-exclamation':type==='warn'?'fa-circle-exclamation':'fa-circle-info'}"></i><span>${msg}</span></div>`;
      wrap.appendChild(div);
      setTimeout(() => { div.style.opacity = 0; div.style.transform = 'translateY(-6px)'; }, 2200);
      setTimeout(() => { div.remove(); }, 2600);
    }

    function openDrawer() {
      document.getElementById('drawer-overlay').classList.remove('hidden');
      requestAnimationFrame(() => document.getElementById('drawer').classList.add('open'));
    }
    function closeDrawer() {
      document.getElementById('drawer').classList.remove('open');
      setTimeout(() => document.getElementById('drawer-overlay').classList.add('hidden'), 200);
    }

    // =========================
    // THEME
    // =========================
    function applyTheme(theme) {
      const root = document.documentElement;
      if(theme === 'light') root.classList.remove('dark');
      else root.classList.add('dark');
      document.getElementById('theme-ico').className = (theme === 'light') ? 'fas fa-sun' : 'fas fa-moon';
    }
    function toggleTheme() {
      const cur = localStorage.getItem(LS.theme) || 'dark';
      const next = cur === 'dark' ? 'light' : 'dark';
      localStorage.setItem(LS.theme, next);
      applyTheme(next);
      toast(next === 'light' ? 'B·∫≠t Light mode ‚ú®' : 'B·∫≠t Dark mode üåô', 'ok');
    }

    // =========================
    // LOAD/SAVE
    // =========================
    function loadState() {
      const theme = localStorage.getItem(LS.theme) || 'dark';
      applyTheme(theme);

      const cfg = localStorage.getItem(LS.config);
      if(cfg) siteConfig = {...siteConfig, ...safeParse(cfg, siteConfig)};

      const db = localStorage.getItem(LS.db);
      if(db) database = safeParse(db, database);

      const fav = localStorage.getItem(LS.fav);
      if(fav) favorites = new Set(safeParse(fav, []));

      const done = localStorage.getItem(LS.done);
      if(done) doneMap = safeParse(done, {});

      const hc = localStorage.getItem(LS.homeCards);
      if(hc) homeCards = safeParse(hc, homeCards);
    }

    function saveState() {
      localStorage.setItem(LS.config, JSON.stringify(siteConfig));
      localStorage.setItem(LS.db, JSON.stringify(database));
      localStorage.setItem(LS.fav, JSON.stringify([...favorites]));
      localStorage.setItem(LS.done, JSON.stringify(doneMap));
      localStorage.setItem(LS.homeCards, JSON.stringify(homeCards));
    }

    function resetLocal() {
      if(!confirm("Reset localStorage? (s·∫Ω m·∫•t d·ªØ li·ªáu ƒë√£ l∆∞u tr√™n m√°y)")) return;
      Object.values(LS).forEach(k => localStorage.removeItem(k));
      toast("ƒê√£ reset d·ªØ li·ªáu m√°y. Refresh trang l√† v·ªÅ m·∫∑c ƒë·ªãnh.", "warn");
    }

    // =========================
    // RENDER CONFIG + HOME CARDS
    // =========================
    function renderConfig() {
      document.getElementById('nav-avatar').src = siteConfig.avatar;
      document.getElementById('home-avatar-big').src = siteConfig.avatar;
      document.getElementById('nav-text').innerText = siteConfig.logoText;
      document.getElementById('home-slogan').innerText = siteConfig.slogan;

      document.getElementById('cfg-avatar').value = siteConfig.avatar;
      document.getElementById('cfg-logo-text').value = siteConfig.logoText;
      document.getElementById('cfg-slogan').value = siteConfig.slogan;

      document.getElementById('cfg-fb').value = siteConfig.social.fb || '';
      document.getElementById('cfg-tt').value = siteConfig.social.tt || '';
      document.getElementById('cfg-yt').value = siteConfig.social.yt || '';

      document.getElementById('social-fb').href = siteConfig.social.fb || '#';
      document.getElementById('social-tt').href = siteConfig.social.tt || '#';
      document.getElementById('social-yt').href = siteConfig.social.yt || '#';
    }

    function renderHomeCards() {
      const anchor = document.getElementById('home-cards-anchor');
      const parent = anchor.parentElement;
      // clear current cards except anchor
      [...parent.children].forEach(ch => { if(ch !== anchor) ch.remove(); });

      homeCards.forEach((c) => {
        const div = document.createElement('div');
        div.className = `bg-cardBg border border-white/10 p-6 rounded-2xl ${c.border || 'hover:border-primary/50'} transition duration-300 group cursor-default`;
        div.innerHTML = `
          <div class="w-12 h-12 rounded-xl ${c.bg || 'bg-primary/20'} ${c.color || 'text-primary'} flex items-center justify-center text-2xl mb-4 group-hover:scale-110 transition">
            <i class="fas ${c.icon || 'fa-star'}"></i>
          </div>
          <h3 class="font-black text-lg mb-2 text-white">${escapeHtml(c.title || '')}</h3>
          <p class="text-sm text-gray-400 leading-relaxed">${escapeHtml(c.desc || '')}</p>
        `;
        parent.insertBefore(div, anchor);
      });
    }

    // simple escape
    function escapeHtml(str) {
      return (str ?? '').toString()
        .replaceAll('&','&amp;').replaceAll('<','&lt;')
        .replaceAll('>','&gt;').replaceAll('"','&quot;')
        .replaceAll("'","&#039;");
    }

    // =========================
    // NAV + PAGES
    // =========================
    function switchPage(pageId) {
      document.querySelectorAll('.page-section').forEach(el => el.classList.remove('active'));

      if(pageId === 'home') {
        document.getElementById('page-home').classList.add('active');
        currentCat = '';
      } else if(pageId === 'favorites') {
        currentCat = 'favorites';
        renderFavorites();
        document.getElementById('page-favorites').classList.add('active');
      } else {
        currentCat = pageId;
        document.getElementById('detail-title').innerText = categories[pageId] || 'Danh m·ª•c';
        document.getElementById('inp-search').value = '';
        renderList(pageId);
        document.getElementById('page-detail').classList.add('active');
      }
      document.getElementById('admin-menu').classList.add('hidden');
      window.scrollTo({top:0, behavior:'smooth'});
    }

    // =========================
    // FAVORITES + DONE
    // =========================
    function toggleFav(id) {
      if(favorites.has(id)) favorites.delete(id);
      else favorites.add(id);
      saveState();
      toast(favorites.has(id) ? 'ƒê√£ ‚≠ê b√†i n√†y!' : 'ƒê√£ b·ªè ‚≠ê', 'ok');
      if(currentCat === 'favorites') renderFavorites();
      else if(currentCat) renderList(currentCat);
    }

    function toggleDone(id) {
      doneMap[id] = !doneMap[id];
      if(!doneMap[id]) delete doneMap[id];
      saveState();
      toast(doneMap[id] ? '‚úÖ ƒê√°nh d·∫•u ƒë√£ h·ªçc' : '‚Ü©Ô∏è B·ªè ƒë√°nh d·∫•u', 'info');
      if(currentCat === 'favorites') renderFavorites();
      else if(currentCat) renderList(currentCat);
    }

    function clearFavorites() {
      if(!confirm("X√≥a h·∫øt b√†i y√™u th√≠ch?")) return;
      favorites = new Set();
      saveState();
      renderFavorites();
      toast("ƒê√£ x√≥a h·∫øt ‚≠ê", "warn");
    }

    // =========================
    // RENDER LIST (CATEGORY)
    // =========================
    function computeProgress(catId) {
      // Progress t√≠nh tr√™n nh·ªØng b√†i m√† h·ªçc sinh nh√¨n th·∫•y (published). Admin th√¨ v·∫´n th·∫•y draft nh∆∞ng progress v·∫´n t√≠nh theo published.
      const visibleToStudents = database.filter(i => i.cat === catId && i.status !== 'draft');
      const total = visibleToStudents.length;
      const done = visibleToStudents.filter(i => !!doneMap[i.id]).length;
      const pct = total === 0 ? 0 : Math.round(done * 100 / total);
      return { total, done, pct };
    }

    function renderDetailMeta(catId, itemsShown) {
      const { total, done, pct } = computeProgress(catId);
      document.getElementById('detail-count').innerText = `${itemsShown} b√†i`;
      document.getElementById('detail-progress-text').innerText = `${pct}% ho√†n th√†nh (${done}/${total})`;
      document.getElementById('detail-progress-bar').style.width = `${pct}%`;
    }

    function renderList(catId) {
      const list = document.getElementById('detail-list');
      const empty = document.getElementById('empty-msg');
      const q = (document.getElementById('inp-search').value || '').trim().toLowerCase();

      list.innerHTML = '';

      let items = database.filter(i => i.cat === catId);
      const isExam = catId.startsWith('exam-');

      // search
      if(q) items = items.filter(i => (i.title || '').toLowerCase().includes(q) || (i.desc || '').toLowerCase().includes(q));

      // sorting: published first then draft
      items.sort((a,b) => (a.status === 'draft') - (b.status === 'draft'));

      // show/hide empty
      if(items.length === 0) empty.classList.remove('hidden');
      else empty.classList.add('hidden');

      // meta
      renderDetailMeta(catId, items.length);

      items.forEach(item => {
        const realIndex = database.indexOf(item);
        const isDraft = (item.status === 'draft');
        const isLocked = isDraft && !isAdmin;

        let cardClass = isLocked
          ? "bg-white/5 border border-dashed border-white/20 p-5 rounded-2xl flex flex-col md:flex-row items-start md:items-center gap-4 locked-item relative"
          : "bg-cardBg border border-white/10 hover:border-primary/50 p-5 rounded-2xl flex flex-col md:flex-row items-start md:items-center gap-4 transition group relative";

        if(isAdmin && isDraft) cardClass = "bg-yellow-900/10 border border-dashed border-yellow-500/50 p-5 rounded-2xl flex flex-col md:flex-row gap-4 relative";

        const favOn = favorites.has(item.id);
        const doneOn = !!doneMap[item.id];

        // badge
        const badge = isDraft ? `<span class="ml-2 px-2 py-0.5 rounded text-[10px] font-black bg-yellow-500 text-black">NH√ÅP</span>` : "";
        const doneBadge = doneOn ? `<span class="ml-2 px-2 py-0.5 rounded text-[10px] font-black bg-green-500 text-black">DONE</span>` : "";

        // actions
        let buttonsHTML = '';
        if(isLocked) {
          buttonsHTML = `<div class="text-gray-500 text-sm italic"><i class="fas fa-lock mr-1"></i> Coming Soon</div>`;
        } else if (isExam) {
          buttonsHTML = `
            <div class="flex gap-2 w-full md:w-auto mt-2 md:mt-0">
              <a href="${item.link}" target="_blank" class="flex-1 md:flex-none px-4 py-2 bg-white/10 hover:bg-white/20 text-white text-xs font-black rounded-xl uppercase tracking-wider text-center transition">
                <i class="fas fa-file-alt mr-1"></i> ƒê·ªÅ
              </a>
              <a href="${item.linkGiai || '#'}" target="_blank" class="flex-1 md:flex-none px-4 py-2 bg-primary hover:bg-primaryDark text-white text-xs font-black rounded-xl uppercase tracking-wider text-center transition">
                <i class="fas fa-video mr-1"></i> Ch·ªØa
              </a>
            </div>
          `;
        } else {
          cardClass += " cursor-pointer";
        }

        const clickAttr = (!isExam && !isLocked) ? `onclick="window.open('${item.link}', '_blank')"` : "";

        const html = `
          <div class="${cardClass}" ${clickAttr}>
            <div class="w-11 h-11 rounded-2xl bg-white/5 flex items-center justify-center shrink-0 ${!isLocked ? 'group-hover:bg-primary transition' : ''}">
              ${isLocked ? '<i class="fas fa-lock text-sm text-gray-500"></i>' : '<i class="fas fa-play text-xs text-white"></i>'}
            </div>

            <div class="flex-grow min-w-0 w-full">
              <h3 class="font-black text-gray-200 ${!isLocked ? 'group-hover:text-white' : ''} text-base transition">
                ${escapeHtml(item.title)} ${badge} ${doneBadge}
              </h3>
              <p class="text-sm text-gray-400 ${isLocked ? 'opacity-70' : ''}">${escapeHtml(item.desc || '')}</p>

              <div class="mt-3 flex flex-wrap gap-2 ${isLocked ? 'hidden' : ''}">
                <button onclick="event.stopPropagation(); toggleFav(${item.id})"
                  class="px-3 py-2 rounded-xl border border-white/10 bg-white/5 hover:bg-white/10 transition text-xs font-black flex items-center gap-2">
                  <i class="fas ${favOn ? 'fa-star text-yellow-400' : 'fa-star text-gray-400'}"></i>
                  ${favOn ? 'ƒê√£ l∆∞u' : 'L∆∞u'}
                </button>

                <button onclick="event.stopPropagation(); toggleDone(${item.id})"
                  class="px-3 py-2 rounded-xl border border-white/10 bg-white/5 hover:bg-white/10 transition text-xs font-black flex items-center gap-2">
                  <i class="fas ${doneOn ? 'fa-circle-check text-green-400' : 'fa-circle'}"></i>
                  ${doneOn ? 'ƒê√£ h·ªçc' : 'ƒê√°nh d·∫•u'}
                </button>
              </div>
            </div>

            ${buttonsHTML}

            <button onclick="event.stopPropagation(); deleteLesson(${realIndex})"
              class="admin-only absolute top-3 right-3 w-9 h-9 rounded-xl hover:bg-red-500/20 text-gray-400 hover:text-red-400 flex items-center justify-center transition">
              <i class="fas fa-trash-alt"></i>
            </button>
          </div>
        `;
        list.innerHTML += html;
      });
    }

    // =========================
    // FAVORITES PAGE RENDER
    // =========================
    function renderFavorites() {
      const list = document.getElementById('fav-list');
      const empty = document.getElementById('fav-empty');
      list.innerHTML = '';

      const favItems = database.filter(i => favorites.has(i.id) && (i.status !== 'draft' || isAdmin));
      if(favItems.length === 0) {
        empty.classList.remove('hidden');
        return;
      }
      empty.classList.add('hidden');

      favItems.forEach(item => {
        const isExam = item.cat.startsWith('exam-');
        const doneOn = !!doneMap[item.id];

        const html = `
          <div class="bg-cardBg border border-white/10 hover:border-primary/50 p-5 rounded-2xl transition group relative">
            <div class="flex items-start gap-4">
              <div class="w-11 h-11 rounded-2xl bg-white/5 group-hover:bg-primary transition flex items-center justify-center shrink-0">
                <i class="fas fa-bookmark text-white text-sm"></i>
              </div>
              <div class="flex-grow min-w-0">
                <div class="text-xs text-gray-400 font-bold uppercase tracking-widest">${escapeHtml(categories[item.cat] || item.cat)}</div>
                <h3 class="font-black text-white mt-1">${escapeHtml(item.title)}</h3>
                <p class="text-sm text-gray-400 mt-1">${escapeHtml(item.desc || '')}</p>

                <div class="mt-3 flex flex-wrap gap-2">
                  <button onclick="toggleFav(${item.id})" class="px-3 py-2 rounded-xl border border-white/10 bg-white/5 hover:bg-white/10 transition text-xs font-black flex items-center gap-2">
                    <i class="fas fa-star text-yellow-400"></i> B·ªè l∆∞u
                  </button>
                  <button onclick="toggleDone(${item.id})" class="px-3 py-2 rounded-xl border border-white/10 bg-white/5 hover:bg-white/10 transition text-xs font-black flex items-center gap-2">
                    <i class="fas ${doneOn ? 'fa-circle-check text-green-400' : 'fa-circle'}"></i>
                    ${doneOn ? 'ƒê√£ h·ªçc' : 'ƒê√°nh d·∫•u'}
                  </button>

                  ${isExam ? `
                    <a href="${item.link}" target="_blank" class="px-3 py-2 rounded-xl border border-white/10 bg-white/5 hover:bg-white/10 transition text-xs font-black"><i class="fas fa-file-lines mr-1"></i> ƒê·ªÅ</a>
                    <a href="${item.linkGiai || '#'}" target="_blank" class="px-3 py-2 rounded-xl bg-primary hover:bg-primaryDark transition text-xs font-black"><i class="fas fa-video mr-1"></i> Ch·ªØa</a>
                  ` : `
                    <a href="${item.link}" target="_blank" class="px-3 py-2 rounded-xl bg-primary hover:bg-primaryDark transition text-xs font-black"><i class="fas fa-play mr-1"></i> M·ªü b√†i</a>
                  `}
                </div>
              </div>
            </div>
          </div>
        `;
        list.innerHTML += html;
      });
    }

    // =========================
    // ADMIN
    // =========================
    function requestAdmin() {
      isAdmin ? toggleAdminMenu() : openModal('password-modal');
    }

    function toggleAdminMenu() {
      document.getElementById('admin-menu').classList.toggle('hidden');
    }

    function checkPassword() {
      const passEl = document.getElementById('admin-pass');
      const pass = (passEl.value || '').trim();

      // Basic rate limit (client-side only): 5 fails -> lock 30s
      const now = Date.now();
      const lockUntil = Number(localStorage.getItem('admin_lock_until') || 0);
      if(now < lockUntil) {
        const sec = Math.ceil((lockUntil - now)/1000);
        toast(`B·ªã kh√≥a ${sec}s v√¨ nh·∫≠p sai qu√° nhi·ªÅu üòµ`, "err");
        passEl.value = '';
        return;
      }

      async function sha256Hex(str) {
        // Prefer WebCrypto when available
        if (window.crypto && window.crypto.subtle) {
          const enc = new TextEncoder().encode(str);
          const buf = await window.crypto.subtle.digest('SHA-256', enc);
          return Array.from(new Uint8Array(buf)).map(b=>b.toString(16).padStart(2,'0')).join('');
        }
        // Fallback: tiny pure JS SHA-256 (not for serious security, just avoids plaintext)
        // Written here to keep this file standalone.
        function ror(v, n) { return (v>>>n) | (v<<(32-n)); }
        function ch(x,y,z) { return (x & y) ^ (~x & z); }
        function maj(x,y,z) { return (x & y) ^ (x & z) ^ (y & z); }
        function s0(x) { return ror(x,2) ^ ror(x,13) ^ ror(x,22); }
        function s1(x) { return ror(x,6) ^ ror(x,11) ^ ror(x,25); }
        function g0(x) { return ror(x,7) ^ ror(x,18) ^ (x>>>3); }
        function g1(x) { return ror(x,17) ^ ror(x,19) ^ (x>>>10); }
        const K = [
          0x428a2f98,0x71374491,0xb5c0fbcf,0xe9b5dba5,0x3956c25b,0x59f111f1,0x923f82a4,0xab1c5ed5,
          0xd807aa98,0x12835b01,0x243185be,0x550c7dc3,0x72be5d74,0x80deb1fe,0x9bdc06a7,0xc19bf174,
          0xe49b69c1,0xefbe4786,0x0fc19dc6,0x240ca1cc,0x2de92c6f,0x4a7484aa,0x5cb0a9dc,0x76f988da,
          0x983e5152,0xa831c66d,0xb00327c8,0xbf597fc7,0xc6e00bf3,0xd5a79147,0x06ca6351,0x14292967,
          0x27b70a85,0x2e1b2138,0x4d2c6dfc,0x53380d13,0x650a7354,0x766a0abb,0x81c2c92e,0x92722c85,
          0xa2bfe8a1,0xa81a664b,0xc24b8b70,0xc76c51a3,0xd192e819,0xd6990624,0xf40e3585,0x106aa070,
          0x19a4c116,0x1e376c08,0x2748774c,0x34b0bcb5,0x391c0cb3,0x4ed8aa4a,0x5b9cca4f,0x682e6ff3,
          0x748f82ee,0x78a5636f,0x84c87814,0x8cc70208,0x90befffa,0xa4506ceb,0xbef9a3f7,0xc67178f2
        ];
        const utf8 = unescape(encodeURIComponent(str));
        const bytes = [];
        for(let i=0;i<utf8.length;i++) bytes.push(utf8.charCodeAt(i));
        const bitLen = bytes.length * 8;
        bytes.push(0x80);
        while((bytes.length % 64) !== 56) bytes.push(0);
        for(let i=7;i>=0;i--) bytes.push((bitLen >>> (i*8)) & 0xff);

        let h0=0x6a09e667, h1=0xbb67ae85, h2=0x3c6ef372, h3=0xa54ff53a;
        let h4=0x510e527f, h5=0x9b05688c, h6=0x1f83d9ab, h7=0x5be0cd19;

        const W = new Array(64);
        for(let i=0;i<bytes.length;i+=64) {
          for(let t=0;t<16;t++) {
            const j = i + t*4;
            W[t] = ((bytes[j]<<24) | (bytes[j+1]<<16) | (bytes[j+2]<<8) | (bytes[j+3])) >>> 0;
          }
          for(let t=16;t<64;t++) {
            W[t] = (g1(W[t-2]) + W[t-7] + g0(W[t-15]) + W[t-16]) >>> 0;
          }
          let a=h0,b=h1,c=h2,d=h3,e=h4,f=h5,g=h6,h=h7;
          for(let t=0;t<64;t++) {
            const T1 = (h + s1(e) + ch(e,f,g) + K[t] + W[t]) >>> 0;
            const T2 = (s0(a) + maj(a,b,c)) >>> 0;
            h=g; g=f; f=e; e=(d + T1) >>> 0;
            d=c; c=b; b=a; a=(T1 + T2) >>> 0;
          }
          h0=(h0+a)>>>0; h1=(h1+b)>>>0; h2=(h2+c)>>>0; h3=(h3+d)>>>0;
          h4=(h4+e)>>>0; h5=(h5+f)>>>0; h6=(h6+g)>>>0; h7=(h7+h)>>>0;
        }
        return [h0,h1,h2,h3,h4,h5,h6,h7].map(x=>x.toString(16).padStart(8,'0')).join('');
      }

      (async () => {
        try {
          const hash = await sha256Hex(pass);
          const expected = "eac63159e8c153a78d0598cf6726d8500119ad7d3ef2e2489da56eb7127d06df";
          if(hash === expected) {
            localStorage.removeItem('admin_fail_count');
            localStorage.removeItem('admin_lock_until');
            isAdmin = true;
            document.body.classList.add('admin-mode');
            document.getElementById('admin-indicator').classList.add('bg-green-500');
            document.getElementById('btn-admin').classList.add('text-primary', 'border-primary');
            closeModal('password-modal');
            toast("üîì Admin Access Granted!", "ok");
            if(currentCat && currentCat !== 'favorites') renderList(currentCat);
            if(currentCat === 'favorites') renderFavorites();
          } else {
            const fails = Number(localStorage.getItem('admin_fail_count') || 0) + 1;
            localStorage.setItem('admin_fail_count', String(fails));
            if(fails >= 5) {
              localStorage.setItem('admin_lock_until', String(Date.now() + 30000));
              localStorage.setItem('admin_fail_count', '0');
              toast("Sai qu√° 5 l·∫ßn ‚Üí kh√≥a 30s üòµ", "err");
            } else {
              toast("Sai password r·ªìi bro üòÖ", "err");
            }
          }
        } catch(err) {
          toast("L·ªói ki·ªÉm tra m·∫≠t kh·∫©u (tr√¨nh duy·ªát ch·∫∑n crypto) üò≠", "err");
        } finally {
          passEl.value = '';
        }
      })();
    }


    function logoutAdmin() {
      isAdmin = false;
      document.body.classList.remove('admin-mode');
      document.getElementById('admin-menu').classList.add('hidden');
      document.getElementById('admin-indicator').classList.remove('bg-green-500');
      document.getElementById('btn-admin').classList.remove('text-primary', 'border-primary');
      toast("üîí Logged out.", "warn");
      if(currentCat && currentCat !== 'favorites') renderList(currentCat);
      if(currentCat === 'favorites') renderFavorites();
    }

    // =========================
    // MODALS
    // =========================
    function closeModal(id) { document.getElementById(id).classList.add('hidden'); document.getElementById(id).classList.remove('flex'); }
    function openModal(id) {
      const el = document.getElementById(id);
      el.classList.remove('hidden');
      el.classList.add('flex');
      if(id === 'add-modal') {
        if(currentCat.startsWith('exam-')) document.getElementById('div-link-giai').classList.remove('hidden');
        else document.getElementById('div-link-giai').classList.add('hidden');
      }
      if(id === 'password-modal') setTimeout(() => document.getElementById('admin-pass').focus(), 50);
    }

    function openAddModal() {
      document.getElementById('inp-cat-hidden').value = currentCat;
      openModal('add-modal');
    }

    // =========================
    // CRUD
    // =========================
    function saveLesson() {
      const title = document.getElementById('inp-title').value.trim();
      const link = document.getElementById('inp-link').value.trim();
      const linkGiai = document.getElementById('inp-link-giai').value.trim();
      const desc = document.getElementById('inp-desc').value.trim();
      const isDraft = document.getElementById('inp-draft').checked;
      const cat = document.getElementById('inp-cat-hidden').value;

      if(!title) return toast("Thi·∫øu ti√™u ƒë·ªÅ!", "err");
      if(!cat) return toast("Ch∆∞a ch·ªçn danh m·ª•c!", "err");

      database.push({
        id: Date.now(),
        cat, title, link: link || "#", linkGiai: linkGiai || "",
        desc,
        status: isDraft ? 'draft' : 'published'
      });

      // reset form
      document.getElementById('inp-title').value = '';
      document.getElementById('inp-link').value = '';
      document.getElementById('inp-link-giai').value = '';
      document.getElementById('inp-desc').value = '';
      document.getElementById('inp-draft').checked = false;

      saveState();
      closeModal('add-modal');
      renderList(cat);
      toast("ƒê√£ l∆∞u b√†i m·ªõi ‚úÖ", "ok");
    }

    function deleteLesson(idx) {
      if(!confirm("X√≥a b√†i n√†y?")) return;
      const id = database[idx]?.id;
      database.splice(idx, 1);
      // cleanup
      favorites.delete(id);
      delete doneMap[id];
      saveState();
      toast("ƒê√£ x√≥a b√†i.", "warn");
      if(currentCat && currentCat !== 'favorites') renderList(currentCat);
      if(currentCat === 'favorites') renderFavorites();
    }

    function openConfigModal() { openModal('config-modal'); }

    function saveConfig() {
      siteConfig.avatar = document.getElementById('cfg-avatar').value.trim() || siteConfig.avatar;
      siteConfig.logoText = document.getElementById('cfg-logo-text').value.trim() || siteConfig.logoText;
      siteConfig.slogan = document.getElementById('cfg-slogan').value.trim() || siteConfig.slogan;

      siteConfig.social.fb = document.getElementById('cfg-fb').value.trim();
      siteConfig.social.tt = document.getElementById('cfg-tt').value.trim();
      siteConfig.social.yt = document.getElementById('cfg-yt').value.trim();

      saveState();
      renderConfig();
      closeModal('config-modal');
      toast("ƒê√£ c·∫≠p nh·∫≠t giao di·ªán ‚ú®", "ok");
    }

    // =========================
    // HOME CARDS EDITOR
    // =========================
    function openHomeCardsModal() {
      renderHomeCardsEditor();
      openModal('homecards-modal');
    }

    function renderHomeCardsEditor() {
      const wrap = document.getElementById('homecards-editor');
      wrap.innerHTML = '';

      homeCards.forEach((c, idx) => {
        const row = document.createElement('div');
        row.className = "border border-white/10 rounded-2xl p-4 bg-white/5";
        row.innerHTML = `
          <div class="flex items-center justify-between mb-3">
            <div class="font-black text-white">Card #${idx+1}</div>
            <button onclick="removeHomeCard(${idx})" class="px-3 py-1.5 rounded-xl bg-red-500/15 hover:bg-red-500/25 text-red-200 text-xs font-black">
              X√≥a
            </button>
          </div>

          <div class="grid grid-cols-1 md:grid-cols-3 gap-2">
            <div>
              <label class="text-[11px] font-bold text-gray-400 uppercase">Icon (fa-...)</label>
              <input id="hc-icon-${idx}" value="${escapeHtml(c.icon || '')}" class="w-full p-3 bg-cardBg border border-white/10 rounded-2xl text-white outline-none focus:border-primary/60">
            </div>
            <div class="md:col-span-2">
              <label class="text-[11px] font-bold text-gray-400 uppercase">Title</label>
              <input id="hc-title-${idx}" value="${escapeHtml(c.title || '')}" class="w-full p-3 bg-cardBg border border-white/10 rounded-2xl text-white outline-none focus:border-primary/60">
            </div>
            <div class="md:col-span-3">
              <label class="text-[11px] font-bold text-gray-400 uppercase">Desc</label>
              <input id="hc-desc-${idx}" value="${escapeHtml(c.desc || '')}" class="w-full p-3 bg-cardBg border border-white/10 rounded-2xl text-white outline-none focus:border-primary/60">
            </div>

            <div class="md:col-span-3 text-[11px] text-gray-500">
              G·ª£i √Ω icon: fa-bolt, fa-brain, fa-fire, fa-star, fa-book, fa-graduation-cap...
            </div>
          </div>
        `;
        wrap.appendChild(row);
      });
    }

    function addHomeCard() {
      homeCards.push({ icon:'fa-star', color:'text-primary', bg:'bg-primary/20', border:'hover:border-primary/50', title:'Card m·ªõi', desc:'M√¥ t·∫£...' });
      renderHomeCardsEditor();
    }

    function removeHomeCard(idx) {
      homeCards.splice(idx, 1);
      renderHomeCardsEditor();
    }

    function saveHomeCards() {
      // apply edits
      homeCards = homeCards.map((c, idx) => ({
        ...c,
        icon: document.getElementById(`hc-icon-${idx}`).value.trim() || c.icon,
        title: document.getElementById(`hc-title-${idx}`).value.trim() || c.title,
        desc: document.getElementById(`hc-desc-${idx}`).value.trim() || c.desc
      }));
      saveState();
      renderHomeCards();
      closeModal('homecards-modal');
      toast("ƒê√£ l∆∞u card Trang ch·ªß ü™Ñ", "ok");
    }

    // =========================
    // EXPORT HTML (freeze current state)
    // =========================
    function exportHTML() {
      // snapshot current DOM html
      let html = document.documentElement.outerHTML;

      // overwrite embedded defaults with current states
      html = html.replace(/let siteConfig = \{[\s\S]*?\};/, `let siteConfig = ${JSON.stringify(siteConfig)};`);
      html = html.replace(/let homeCards = \[[\s\S]*?\];/, `let homeCards = ${JSON.stringify(homeCards)};`);
      html = html.replace(/let database = \[[\s\S]*?\];/, `let database = ${JSON.stringify(database)};`);

      // freeze favorites/done into localStorage on first load? keep as-is but also embed defaults (optional)
      const blob = new Blob([html], {type:'text/html'});
      const a = document.createElement('a');
      a.href = URL.createObjectURL(blob);
      a.download = 'Ueih_Casio_V3_Export.html';
      document.body.appendChild(a); a.click(); document.body.removeChild(a);
      toast("ƒê√£ export HTML ‚úÖ", "ok");
    }

    // =========================
    // INIT
    // =========================
    function init() {
      loadState();
      renderConfig();
      renderHomeCards();
    }

    // close drawer on resize to desktop
    window.addEventListener('resize', () => { if(window.innerWidth >= 768) closeDrawer(); });

    init();
  </script>


</body></html>    .soft-shadow { box-shadow: 0 14px 40px rgba(0,0,0,.45); }
    .ring-glow { box-shadow: 0 0 0 1px rgba(220,38,38,.25), 0 0 22px rgba(220,38,38,.28); }

    /* drawer */
    .drawer { transform: translateX(100%); transition: transform .25s ease; }
    .drawer.open { transform: translateX(0); }
  
    /* LIGHT MODE OVERRIDES (quick & dirty nh∆∞ng d√πng ·ªïn) */
    html:not(.dark) body { background-color: #f8fafc !important; color: #0f172a !important; }
    html:not(.dark) .glass { background: rgba(255,255,255,.78) !important; }
    html:not(.dark) .bg-darkBg { background-color: #f8fafc !important; }
    html:not(.dark) .bg-cardBg { background-color: rgba(255,255,255,.86) !important; }
    html:not(.dark) .text-white { color: #0f172a !important; }
    html:not(.dark) .text-gray-300 { color: #334155 !important; }
    html:not(.dark) .text-gray-400 { color: #475569 !important; }
    html:not(.dark) .text-gray-500 { color: #64748b !important; }
    html:not(.dark) .text-gray-700 { color: #94a3b8 !important; }
    html:not(.dark) .border-white\/10 { border-color: rgba(15,23,42,.12) !important; }
    html:not(.dark) .border-white\/20 { border-color: rgba(15,23,42,.18) !important; }
    html:not(.dark) .bg-white\/5 { background-color: rgba(15,23,42,.05) !important; }
    html:not(.dark) .bg-white\/10 { background-color: rgba(15,23,42,.08) !important; }
    html:not(.dark) .bg-black\/40 { background-color: rgba(255,255,255,.7) !important; }
    html:not(.dark) .bg-black\/70 { background-color: rgba(0,0,0,.35) !important; } /* overlay v·∫´n t·ªëi */
    html:not(.dark) .bg-black\/80 { background-color: rgba(0,0,0,.45) !important; }
    html:not(.dark) .bg-black\/85 { background-color: rgba(0,0,0,.5) !important; }
    html:not(.dark) .ring-glow { box-shadow: 0 0 0 1px rgba(220,38,38,.25), 0 0 18px rgba(220,38,38,.22) !important; }

  </style>
</head>

<body class="bg-darkBg text-white min-h-screen flex flex-col font-sans selection:bg-primary selection:text-white overflow-x-hidden">
  <!-- background vibe -->
  <div class="fixed inset-0 bg-grid-red z-[-1] pointer-events-none"></div>
  <div class="fixed top-[-10%] left-[-10%] w-[520px] h-[520px] bg-primary/10 rounded-full blur-[120px] z-[-1]"></div>
  <div class="fixed bottom-[-12%] right-[-12%] w-[520px] h-[520px] bg-white/5 rounded-full blur-[120px] z-[-1]"></div>

  <!-- NAV -->
  <nav class="sticky top-0 z-50 border-b border-white/10 glass">
    <div class="container mx-auto px-4 h-20 flex justify-between items-center gap-3">

      <!-- logo -->
      <div onclick="switchPage('home')" class="cursor-pointer flex items-center gap-3 group select-none">
        <div class="relative">
          <img id="nav-avatar" src="" class="w-10 h-10 rounded-full border border-primary object-cover ring-glow group-hover:scale-110 transition duration-300">
          <div class="absolute bottom-0 right-0 w-2.5 h-2.5 bg-green-500 rounded-full border border-black"></div>
        </div>
        <div class="leading-none">
          <h1 class="font-black text-lg tracking-tighter text-white group-hover:text-primary transition" id="nav-text">Ueih Casio</h1>
          <div class="text-[10px] text-gray-400 font-bold tracking-widest uppercase">Red Phoenix</div>
        </div>
      </div>

      <!-- desktop nav -->
      <div class="hidden md:flex items-center space-x-8 text-sm font-bold uppercase tracking-wide">
        <button onclick="switchPage('home')" class="hover:text-primary transition">Trang ch·ªß</button>

        <div class="relative group">
  <button class="hover:text-primary py-6 flex items-center gap-1">
    K·ªπ nƒÉng Casio 580 <i class="fas fa-chevron-down text-[10px]"></i>
  </button>
  <div class="absolute top-full left-1/2 -translate-x-1/2 w-72 bg-cardBg border border-primary/30 soft-shadow rounded-2xl overflow-hidden hidden group-hover:block animate-slide-in">
    <button onclick="switchPage('casio-so-hoc')" class="block w-full text-left px-4 py-3 hover:bg-primary/10 hover:text-primary border-b border-white/5 normal-case transition">üî¢ S·ªë H·ªçc & S·ªë Ph·ª©c</button>
    <button onclick="switchPage('casio-ham-so')" class="block w-full text-left px-4 py-3 hover:bg-primary/10 hover:text-primary border-b border-white/5 normal-case transition">üìà H√†m S·ªë & ƒê·ªì Th·ªã</button>
    <button onclick="switchPage('casio-giai-tich')" class="block w-full text-left px-4 py-3 hover:bg-primary/10 hover:text-primary border-b border-white/5 normal-case transition">‚à´ Gi·∫£i T√≠ch</button>
    <button onclick="switchPage('casio-hinh-hoc')" class="block w-full text-left px-4 py-3 hover:bg-primary/10 hover:text-primary border-b border-white/5 normal-case transition">üìê H√¨nh H·ªçc Oxyz</button>
    <button onclick="switchPage('casio-xac-suat')" class="block w-full text-left px-4 py-3 hover:bg-primary/10 hover:text-primary border-b border-white/5 normal-case transition">üé≤ X√°c Su·∫•t</button>
    <button onclick="switchPage('casio-hay-la')" class="block w-full text-left px-4 py-3 bg-primary/10 hover:bg-primary hover:text-white font-bold normal-case transition">
      <i class="fas fa-star text-yellow-400 mr-1"></i> B√†i To√°n Hay
    </button>
  </div>
</div>

<div class="relative group">
  <button class="hover:text-primary py-6 flex items-center gap-1">
    K·ªπ nƒÉng Casio 880 <i class="fas fa-chevron-down text-[10px]"></i>
  </button>
  <div class="absolute top-full left-1/2 -translate-x-1/2 w-72 bg-cardBg border border-primary/30 soft-shadow rounded-2xl overflow-hidden hidden group-hover:block animate-slide-in">
    <button onclick="switchPage('casio-880-so-hoc')" class="block w-full text-left px-4 py-3 hover:bg-primary/10 hover:text-primary border-b border-white/5 normal-case transition">üî¢ S·ªë H·ªçc & S·ªë Ph·ª©c</button>
    <button onclick="switchPage('casio-880-ham-so')" class="block w-full text-left px-4 py-3 hover:bg-primary/10 hover:text-primary border-b border-white/5 normal-case transition">üìà H√†m S·ªë & ƒê·ªì Th·ªã</button>
    <button onclick="switchPage('casio-880-giai-tich')" class="block w-full text-left px-4 py-3 hover:bg-primary/10 hover:text-primary border-b border-white/5 normal-case transition">‚à´ Gi·∫£i T√≠ch</button>
    <button onclick="switchPage('casio-880-hinh-hoc')" class="block w-full text-left px-4 py-3 hover:bg-primary/10 hover:text-primary border-b border-white/5 normal-case transition">üìê H√¨nh H·ªçc Oxyz</button>
    <button onclick="switchPage('casio-880-xac-suat')" class="block w-full text-left px-4 py-3 hover:bg-primary/10 hover:text-primary border-b border-white/5 normal-case transition">üé≤ X√°c Su·∫•t</button>
    <button onclick="switchPage('casio-880-hay-la')" class="block w-full text-left px-4 py-3 bg-primary/10 hover:bg-primary hover:text-white font-bold normal-case transition">
      <i class="fas fa-star text-yellow-400 mr-1"></i> B√†i To√°n Hay
    </button>
  </div>
</div>

        <div class="relative group">
          <button class="hover:text-primary py-6 flex items-center gap-1">
            Kho ƒê·ªÅ Thi <i class="fas fa-chevron-down text-[10px]"></i>
          </button>
          <div class="absolute top-full left-1/2 -translate-x-1/2 w-64 bg-cardBg border border-primary/30 soft-shadow rounded-2xl overflow-hidden hidden group-hover:block animate-slide-in">
            <button onclick="switchPage('exam-tsa')" class="block w-full text-left px-4 py-3 hover:bg-primary/10 hover:text-red-400 border-b border-white/5 normal-case transition">üî¥ TSA (B√°ch Khoa)</button>
            <button onclick="switchPage('exam-hsa')" class="block w-full text-left px-4 py-3 hover:bg-primary/10 hover:text-green-400 border-b border-white/5 normal-case transition">üü¢ HSA (ƒêHQG)</button>
            <button onclick="switchPage('exam-thpt')" class="block w-full text-left px-4 py-3 hover:bg-primary/10 hover:text-blue-400 border-b border-white/5 normal-case transition">üîµ THPT Qu·ªëc Gia</button>
            <button onclick="switchPage('exam-vact')" class="block w-full text-left px-4 py-3 hover:bg-primary/10 hover:text-purple-400 normal-case transition">üü£ ƒê·ªÅ VACT</button>
          </div>
        </div>

        <button onclick="switchPage('favorites')" class="hover:text-primary transition flex items-center gap-2">
          <i class="fas fa-bookmark"></i> Y√™u th√≠ch
        </button>
      </div>

      <!-- right controls -->
      <div class="flex items-center gap-2">
        <button onclick="toggleTheme()" class="w-10 h-10 rounded-xl bg-white/5 border border-white/10 hover:border-primary/40 hover:bg-white/10 transition flex items-center justify-center" title="Light/Dark">
          <i id="theme-ico" class="fas fa-moon"></i>
        </button>

        <button onclick="requestAdmin()" id="btn-admin" class="w-10 h-10 rounded-xl bg-white/5 border border-white/10 hover:border-primary/40 hover:bg-white/10 transition flex items-center justify-center" title="Admin">
          <i class="fas fa-user-secret"></i>
        </button>

        <div id="admin-indicator" class="hidden md:block w-2 h-2 rounded-full bg-gray-600"></div>

        <!-- mobile menu btn -->
        <button onclick="openDrawer()" class="md:hidden w-10 h-10 rounded-xl bg-white/5 border border-white/10 hover:bg-white/10 transition flex items-center justify-center" title="Menu">
          <i class="fas fa-bars"></i>
        </button>
      </div>
    </div>
  </nav>

  <!-- Mobile Drawer -->
  <div id="drawer-overlay" class="fixed inset-0 z-[90] hidden">
    <div class="absolute inset-0 bg-black/70 backdrop-blur-sm" onclick="closeDrawer()"></div>
    <div id="drawer" class="drawer absolute top-0 right-0 h-full w-[88%] max-w-sm bg-cardBg border-l border-white/10 soft-shadow p-4">
      <div class="flex items-center justify-between mb-4">
        <div class="font-black tracking-tight text-lg">Menu</div>
        <button onclick="closeDrawer()" class="w-9 h-9 rounded-lg bg-white/5 hover:bg-white/10 transition flex items-center justify-center">
          <i class="fas fa-xmark"></i>
        </button>
      </div>

      <div class="space-y-2 text-sm">
        <button onclick="switchPage('home'); closeDrawer();" class="w-full text-left px-3 py-3 rounded-xl bg-white/5 hover:bg-white/10 transition flex items-center gap-2">
          <i class="fas fa-house text-primary w-5"></i> Trang ch·ªß
        </button>

        <details class="group rounded-xl bg-white/5 overflow-hidden">
  <summary class="cursor-pointer list-none px-3 py-3 flex items-center justify-between">
    <span class="font-bold flex items-center gap-2"><i class="fas fa-calculator text-primary w-5"></i> K·ªπ nƒÉng Casio 580</span>
    <i class="fas fa-chevron-down text-xs opacity-70 group-open:rotate-180 transition"></i>
  </summary>
  <div class="pb-2">
    <button onclick="switchPage('casio-so-hoc'); closeDrawer();" class="w-full text-left px-4 py-2 hover:bg-white/10 transition">üî¢ S·ªë H·ªçc & S·ªë Ph·ª©c</button>
    <button onclick="switchPage('casio-ham-so'); closeDrawer();" class="w-full text-left px-4 py-2 hover:bg-white/10 transition">üìà H√†m S·ªë & ƒê·ªì Th·ªã</button>
    <button onclick="switchPage('casio-giai-tich'); closeDrawer();" class="w-full text-left px-4 py-2 hover:bg-white/10 transition">‚à´ Gi·∫£i T√≠ch</button>
    <button onclick="switchPage('casio-hinh-hoc'); closeDrawer();" class="w-full text-left px-4 py-2 hover:bg-white/10 transition">üìê H√¨nh H·ªçc Oxyz</button>
    <button onclick="switchPage('casio-xac-suat'); closeDrawer();" class="w-full text-left px-4 py-2 hover:bg-white/10 transition">üé≤ X√°c Su·∫•t</button>
    <button onclick="switchPage('casio-hay-la'); closeDrawer();" class="w-full text-left px-4 py-2 hover:bg-white/10 transition">‚≠ê B√†i To√°n Hay</button>
  </div>
</details>

<details class="group rounded-xl bg-white/5 overflow-hidden">
  <summary class="cursor-pointer list-none px-3 py-3 flex items-center justify-between">
    <span class="font-bold flex items-center gap-2"><i class="fas fa-calculator text-primary w-5"></i> K·ªπ nƒÉng Casio 880</span>
    <i class="fas fa-chevron-down text-xs opacity-70 group-open:rotate-180 transition"></i>
  </summary>
  <div class="pb-2">
    <button onclick="switchPage('casio-880-so-hoc'); closeDrawer();" class="w-full text-left px-4 py-2 hover:bg-white/10 transition">üî¢ S·ªë H·ªçc & S·ªë Ph·ª©c</button>
    <button onclick="switchPage('casio-880-ham-so'); closeDrawer();" class="w-full text-left px-4 py-2 hover:bg-white/10 transition">üìà H√†m S·ªë & ƒê·ªì Th·ªã</button>
    <button onclick="switchPage('casio-880-giai-tich'); closeDrawer();" class="w-full text-left px-4 py-2 hover:bg-white/10 transition">‚à´ Gi·∫£i T√≠ch</button>
    <button onclick="switchPage('casio-880-hinh-hoc'); closeDrawer();" class="w-full text-left px-4 py-2 hover:bg-white/10 transition">üìê H√¨nh H·ªçc Oxyz</button>
    <button onclick="switchPage('casio-880-xac-suat'); closeDrawer();" class="w-full text-left px-4 py-2 hover:bg-white/10 transition">üé≤ X√°c Su·∫•t</button>
    <button onclick="switchPage('casio-880-hay-la'); closeDrawer();" class="w-full text-left px-4 py-2 hover:bg-white/10 transition">‚≠ê B√†i To√°n Hay</button>
  </div>
</details>

        <details class="group rounded-xl bg-white/5 overflow-hidden">
          <summary class="cursor-pointer list-none px-3 py-3 flex items-center justify-between">
            <span class="font-bold flex items-center gap-2"><i class="fas fa-folder-open text-primary w-5"></i> Kho ƒê·ªÅ Thi</span>
            <i class="fas fa-chevron-down text-xs opacity-70 group-open:rotate-180 transition"></i>
          </summary>
          <div class="pb-2">
            <button onclick="switchPage('exam-tsa'); closeDrawer();" class="w-full text-left px-4 py-2 hover:bg-white/10 transition">üî¥ TSA</button>
            <button onclick="switchPage('exam-hsa'); closeDrawer();" class="w-full text-left px-4 py-2 hover:bg-white/10 transition">üü¢ HSA</button>
            <button onclick="switchPage('exam-thpt'); closeDrawer();" class="w-full text-left px-4 py-2 hover:bg-white/10 transition">üîµ THPTQG</button>
            <button onclick="switchPage('exam-vact'); closeDrawer();" class="w-full text-left px-4 py-2 hover:bg-white/10 transition">üü£ VACT</button>
          </div>
        </details>

        <button onclick="switchPage('favorites'); closeDrawer();" class="w-full text-left px-3 py-3 rounded-xl bg-white/5 hover:bg-white/10 transition flex items-center gap-2">
          <i class="fas fa-bookmark text-primary w-5"></i> Y√™u th√≠ch
        </button>

        <div class="mt-4 rounded-xl border border-white/10 p-3 text-xs text-gray-400">
          <div class="font-bold text-gray-300 mb-1">Tip nh·ªè</div>
          <div>Vu·ªët ngang ·ªü Trang ch·ªß ƒë·ªÉ xem th√™m card. D·∫•u ‚≠ê ƒë·ªÉ l∆∞u b√†i, ‚úÖ ƒë·ªÉ ƒë√°nh d·∫•u ƒë√£ h·ªçc.</div>
        </div>
      </div>
    </div>
  </div>

  <!-- MAIN -->
  <main class="flex-grow">

    <!-- HOME -->
    <section id="page-home" class="page-section active">
      <div class="pt-16 pb-10 text-center px-4 relative">

        <div class="relative z-10 mb-6 group">
          <img id="home-avatar-big" src="" class="w-32 h-32 rounded-full border-4 border-primary mx-auto ring-glow object-cover transition transform group-hover:scale-105 duration-500">
        </div>

        <h1 class="relative z-10 text-4xl md:text-7xl font-black mb-3 uppercase tracking-tighter">
          <span class="text-white">Ueih</span> <span class="text-primary">Casio</span>
        </h1>

        <p class="relative z-10 text-lg md:text-2xl text-gray-300 font-medium italic mb-10" id="home-slogan">
          Casio L·∫π L·∫π R·ªìi Chuy·ªÉn C√¢u Thoiüê£
        </p>

        <!-- quick actions -->
        <div class="relative z-10 container mx-auto max-w-5xl">
          <div class="flex flex-col md:flex-row gap-3 justify-center mb-8">
            <button onclick="switchPage('casio-so-hoc')" class="px-5 py-3 rounded-2xl bg-primary hover:bg-primaryDark transition font-black tracking-wide flex items-center justify-center gap-2 soft-shadow">
              <i class="fas fa-play"></i> V√†o h·ªçc lu√¥n
            </button>
            <button onclick="switchPage('casio-880-so-hoc')" class="px-5 py-3 rounded-2xl bg-white/5 hover:bg-white/10 transition font-bold tracking-wide flex items-center justify-center gap-2 border border-white/10">
              <i class="fas fa-calculator"></i> V√†o h·ªçc 880
            </button>

            <button onclick="switchPage('exam-tsa')" class="px-5 py-3 rounded-2xl bg-white/5 hover:bg-white/10 transition font-bold tracking-wide flex items-center justify-center gap-2 border border-white/10">
              <i class="fas fa-file-lines"></i> Qu·∫•t ƒë·ªÅ TSA
            </button>
            <button onclick="switchPage('favorites')" class="px-5 py-3 rounded-2xl bg-white/5 hover:bg-white/10 transition font-bold tracking-wide flex items-center justify-center gap-2 border border-white/10">
              <i class="fas fa-bookmark"></i> B√†i ƒë√£ l∆∞u
            </button>
          </div>

          <!-- feature cards slider -->
          <div class="horizontal-scroll px-2 pb-4">
            <!-- cards injected by JS -->
            <div id="home-cards-anchor" class="hidden"></div>
          </div>
          <p class="md:hidden text-xs text-gray-500 mt-1 animate-pulse"><i class="fas fa-arrows-left-right"></i> Vu·ªët ƒë·ªÉ xem th√™m</p>
        </div>
      </div>
    </section>

    <!-- DETAIL PAGE -->
    <section id="page-detail" class="page-section container mx-auto px-4 py-10 max-w-4xl">
      <div class="flex flex-col md:flex-row md:items-end md:justify-between gap-4 mb-6 border-b border-white/10 pb-4">
        <div class="min-w-0">
          <button onclick="switchPage('home')" class="text-gray-400 hover:text-primary text-xs font-bold uppercase mb-2 flex items-center gap-1">
            <i class="fas fa-arrow-left"></i> Trang ch·ªß
          </button>
          <h2 id="detail-title" class="text-2xl md:text-4xl font-black text-white uppercase tracking-wide truncate">Ti√™u ƒë·ªÅ</h2>
          <div class="mt-3">
            <div class="flex items-center gap-3 text-xs text-gray-400">
              <span id="detail-count">0 b√†i</span>
              <span class="opacity-50">‚Ä¢</span>
              <span id="detail-progress-text">0% ho√†n th√†nh</span>
            </div>
            <div class="mt-2 h-2 rounded-full bg-white/5 overflow-hidden border border-white/10">
              <div id="detail-progress-bar" class="h-full bg-primary w-0 transition-all duration-300"></div>
            </div>
          </div>
        </div>

        <div class="flex flex-col sm:flex-row gap-2">
          <div class="relative flex-1">
            <i class="fas fa-magnifying-glass absolute left-3 top-1/2 -translate-y-1/2 text-gray-500"></i>
            <input id="inp-search" oninput="renderList(currentCat)" placeholder="T√¨m b√†i theo ti√™u ƒë·ªÅ..." class="w-full pl-9 pr-3 py-3 bg-white/5 border border-white/10 rounded-2xl outline-none focus:border-primary/60 text-sm">
          </div>

          <button onclick="openAddModal()" class="admin-only bg-primary hover:bg-primaryDark text-white px-5 py-3 rounded-2xl font-black shadow-lg transition flex items-center justify-center gap-2 text-sm">
            <i class="fas fa-plus"></i> Th√™m B√†i
          </button>
        </div>
      </div>

      <div id="detail-list" class="space-y-4"></div>

      <div id="empty-msg" class="hidden text-center py-20 opacity-60">
        <i class="fas fa-folder-open text-6xl mb-4 text-gray-700"></i>
        <p class="text-gray-500">Ch∆∞a c√≥ b√†i n√†o. Admin v√†o th√™m ph√°t l√† ch√°y ngay.</p>
      </div>
    </section>

    <!-- FAVORITES -->
    <section id="page-favorites" class="page-section container mx-auto px-4 py-10 max-w-4xl">
      <div class="flex items-end justify-between mb-6 border-b border-white/10 pb-4">
        <div>
          <button onclick="switchPage('home')" class="text-gray-400 hover:text-primary text-xs font-bold uppercase mb-2 flex items-center gap-1">
            <i class="fas fa-arrow-left"></i> Trang ch·ªß
          </button>
          <h2 class="text-2xl md:text-4xl font-black uppercase tracking-wide">
            <i class="fas fa-bookmark text-primary mr-2"></i>Y√™u th√≠ch
          </h2>
          <p class="text-gray-400 text-sm mt-2">M·∫•y b√†i b·∫°n ‚≠ê s·∫Ω n·∫±m h·∫øt ·ªü ƒë√¢y. ‚ÄúSave l√† th·∫Øng‚Äù.</p>
        </div>
        <button onclick="clearFavorites()" class="px-4 py-2 rounded-xl bg-white/5 hover:bg-white/10 transition text-xs font-bold text-gray-300 border border-white/10">
          X√≥a h·∫øt
        </button>
      </div>

      <div id="fav-list" class="space-y-4"></div>

      <div id="fav-empty" class="hidden text-center py-20 opacity-60">
        <i class="fas fa-star text-6xl mb-4 text-gray-700"></i>
        <p class="text-gray-500">Ch∆∞a c√≥ b√†i n√†o ƒë∆∞·ª£c ‚≠ê. ƒêi l∆∞·ªõt b√†i r·ªìi l∆∞u l·∫°i nha.</p>
      </div>
    </section>

  </main>

  <!-- FOOTER -->
  <footer class="bg-black/40 border-t border-white/10 py-8 mt-auto backdrop-blur">
    <div class="container mx-auto px-4 flex flex-col sm:flex-row gap-4 justify-between items-center">
      <div class="text-xs text-gray-500 font-bold">¬© 2025 UEIH CASIO. Built with calculator energy.</div>
      <div class="flex gap-6">
        <a id="social-fb" href="#" target="_blank" class="text-gray-400 hover:text-blue-500 text-xl transition transform hover:scale-110"><i class="fab fa-facebook"></i></a>
        <a id="social-tt" href="#" target="_blank" class="text-gray-400 hover:text-white text-xl transition transform hover:scale-110"><i class="fab fa-tiktok"></i></a>
        <a id="social-yt" href="#" target="_blank" class="text-gray-400 hover:text-red-500 text-xl transition transform hover:scale-110"><i class="fab fa-youtube"></i></a>
      </div>
    </div>
  </footer>

  <!-- floating admin quick menu -->
  <div class="fixed bottom-6 right-6 z-50 flex flex-col items-end gap-3">
    <div id="admin-menu" class="hidden bg-cardBg border border-primary/30 p-3 rounded-2xl soft-shadow w-72">
      <div class="text-[10px] font-black text-primary uppercase mb-2 tracking-widest border-b border-white/10 pb-1">Admin Mode</div>
      <button onclick="openConfigModal()" class="w-full text-left px-3 py-2 hover:bg-white/5 rounded-xl text-sm text-gray-300 hover:text-white">
        <i class="fas fa-pen w-5 text-primary"></i> S·ª≠a giao di·ªán
      </button>
      <button onclick="openHomeCardsModal()" class="w-full text-left px-3 py-2 hover:bg-white/5 rounded-xl text-sm text-gray-300 hover:text-white">
        <i class="fas fa-wand-magic-sparkles w-5 text-yellow-400"></i> S·ª≠a card Trang ch·ªß
      </button>
      <button onclick="exportHTML()" class="w-full text-left px-3 py-2 hover:bg-white/5 rounded-xl text-sm text-gray-300 hover:text-white">
        <i class="fas fa-file-export w-5 text-green-500"></i> Export web (HTML)
      </button>
      <button onclick="resetLocal()" class="w-full text-left px-3 py-2 hover:bg-white/5 rounded-xl text-sm text-gray-300 hover:text-white">
        <i class="fas fa-rotate-left w-5 text-gray-300"></i> Reset d·ªØ li·ªáu m√°y
      </button>
      <button onclick="logoutAdmin()" class="w-full text-left px-3 py-2 hover:bg-red-900/20 rounded-xl text-sm text-red-400 hover:text-red-300">
        <i class="fas fa-right-from-bracket w-5"></i> Tho√°t
      </button>
      <div class="mt-2 text-[11px] text-gray-500 leading-snug">
        L∆∞u √Ω: admin password n·∫±m trong code n√™n ch·ªâ ‚Äúkh√≥a UI‚Äù th√¥i, kh√¥ng ph·∫£i b·∫£o m·∫≠t real.
      </div>
    </div>
  </div>

  <!-- TOAST -->
  <div id="toast-wrap" class="fixed top-4 right-4 z-[200] space-y-2"></div>

  <!-- MODALS -->
  <div id="add-modal" class="fixed inset-0 bg-black/80 z-[100] hidden items-center justify-center backdrop-blur-sm">
    <div class="bg-cardBg p-6 rounded-2xl w-full max-w-md border border-white/10 soft-shadow animate-pop">
      <h3 class="text-xl font-black text-white mb-4">Th√™m B√†i M·ªõi</h3>
      <div class="space-y-4">
        <input type="text" id="inp-title" class="w-full p-3 bg-white/5 border border-white/10 rounded-2xl focus:border-primary outline-none text-white" placeholder="Ti√™u ƒë·ªÅ b√†i h·ªçc">
        <input type="text" id="inp-link" class="w-full p-3 bg-white/5 border border-white/10 rounded-2xl focus:border-primary outline-none text-white" placeholder="Link (Video / File ƒê·ªÅ)">

        <div id="div-link-giai" class="hidden">
          <input type="text" id="inp-link-giai" class="w-full p-3 bg-white/5 border border-white/10 rounded-2xl focus:border-green-500 outline-none text-white" placeholder="Link L·ªùi Gi·∫£i / Video Ch·ªØa">
        </div>

        <input type="text" id="inp-desc" class="w-full p-3 bg-white/5 border border-white/10 rounded-2xl focus:border-primary outline-none text-white" placeholder="M√¥ t·∫£ ng·∫Øn">

        <div class="flex items-center gap-3 bg-yellow-500/10 p-3 rounded-2xl border border-yellow-500/20 cursor-pointer" onclick="document.getElementById('inp-draft').click()">
          <input type="checkbox" id="inp-draft" class="w-5 h-5 accent-yellow-500 cursor-pointer">
          <label class="block text-sm font-bold text-yellow-500 cursor-pointer">Ch·∫ø ƒë·ªô Nh√°p (h·ªçc sinh th·∫•y b·ªã kh√≥a)</label>
        </div>

        <input type="hidden" id="inp-cat-hidden">
        <div class="flex gap-2">
          <button onclick="closeModal('add-modal')" class="flex-1 py-3 bg-white/5 hover:bg-white/10 text-white font-bold rounded-2xl">H·ªßy</button>
          <button onclick="saveLesson()" class="flex-1 py-3 bg-primary hover:bg-primaryDark text-white font-black rounded-2xl">L∆∞u B√†i</button>
        </div>
      </div>
    </div>
  </div>

  <div id="password-modal" class="fixed inset-0 bg-black/85 z-[110] hidden items-center justify-center">
    <div class="bg-cardBg p-8 rounded-2xl w-full max-w-sm border border-primary/30 soft-shadow animate-pop">
      <h3 class="text-xl font-black text-primary text-center mb-6 uppercase tracking-widest">Admin Access</h3>
      <input type="password" id="admin-pass" class="w-full p-3 bg-white/5 border border-white/10 rounded-2xl text-center text-white focus:border-primary outline-none mb-3" placeholder="PASSWORD">
      <button onclick="checkPassword()" class="w-full py-3 bg-primary hover:bg-primaryDark text-white font-black rounded-2xl transition">M·ªû KH√ìA</button>
      <button onclick="closeModal('password-modal')" class="w-full py-2 mt-2 text-gray-400 text-xs font-bold hover:text-white">QUAY L·∫†I</button>
      <div class="text-[11px] text-gray-500 mt-3 text-center">
      </div>
</div>
  </div>

  <div id="config-modal" class="fixed inset-0 bg-black/80 z-[110] hidden items-center justify-center backdrop-blur-sm">
    <div class="bg-cardBg p-6 rounded-2xl w-full max-w-md border border-white/10 soft-shadow animate-pop">
      <h3 class="text-xl font-black text-primary mb-4">C√†i ƒê·∫∑t Giao Di·ªán</h3>
      <div class="space-y-4">
        <div>
          <label class="text-xs font-bold text-gray-500 uppercase">Link Avatar</label>
          <input type="text" id="cfg-avatar" class="w-full p-3 bg-white/5 border border-white/10 rounded-2xl text-white outline-none focus:border-primary/60">
        </div>
        <div>
          <label class="text-xs font-bold text-gray-500 uppercase">T√™n Web</label>
          <input type="text" id="cfg-logo-text" class="w-full p-3 bg-white/5 border border-white/10 rounded-2xl text-white outline-none focus:border-primary/60">
        </div>
        <div>
          <label class="text-xs font-bold text-gray-500 uppercase">Slogan</label>
          <input type="text" id="cfg-slogan" class="w-full p-3 bg-white/5 border border-white/10 rounded-2xl text-white outline-none focus:border-primary/60">
        </div>

        <div class="grid grid-cols-1 sm:grid-cols-3 gap-2">
          <div class="sm:col-span-3 text-xs font-bold text-gray-500 uppercase mt-2">Social links</div>
          <input type="text" id="cfg-fb" placeholder="Facebook URL" class="p-3 bg-white/5 border border-white/10 rounded-2xl text-white outline-none focus:border-primary/60">
          <input type="text" id="cfg-tt" placeholder="TikTok URL" class="p-3 bg-white/5 border border-white/10 rounded-2xl text-white outline-none focus:border-primary/60">
          <input type="text" id="cfg-yt" placeholder="YouTube URL" class="p-3 bg-white/5 border border-white/10 rounded-2xl text-white outline-none focus:border-primary/60">
        </div>

        <div class="flex gap-2 pt-2">
          <button onclick="saveConfig()" class="flex-1 py-3 bg-primary hover:bg-primaryDark text-white font-black rounded-2xl">C·∫≠p Nh·∫≠t</button>
          <button onclick="closeModal('config-modal')" class="flex-1 py-3 bg-white/5 hover:bg-white/10 text-white font-bold rounded-2xl">H·ªßy</button>
        </div>
      </div>
    </div>
  </div>

  <div id="homecards-modal" class="fixed inset-0 bg-black/80 z-[120] hidden items-center justify-center backdrop-blur-sm">
    <div class="bg-cardBg p-6 rounded-2xl w-full max-w-2xl border border-white/10 soft-shadow animate-pop max-h-[82vh] overflow-y-auto">
      <div class="flex items-center justify-between mb-4">
        <h3 class="text-xl font-black text-yellow-400">S·ª≠a Card Trang ch·ªß</h3>
        <button onclick="closeModal('homecards-modal')" class="w-9 h-9 rounded-xl bg-white/5 hover:bg-white/10 transition flex items-center justify-center">
          <i class="fas fa-xmark"></i>
        </button>
      </div>

      <div class="text-xs text-gray-400 mb-4">M·ªói card: icon FontAwesome (vd: <span class="font-bold">fa-bolt</span>), title, desc.</div>

      <div id="homecards-editor" class="space-y-3"></div>

      <div class="flex gap-2 mt-5">
        <button onclick="addHomeCard()" class="px-4 py-2 rounded-xl bg-white/5 hover:bg-white/10 border border-white/10 text-sm font-bold">+ Th√™m card</button>
        <button onclick="saveHomeCards()" class="flex-1 py-2 rounded-xl bg-yellow-500 hover:bg-yellow-400 text-black font-black">L∆∞u card</button>
      </div>
    </div>
  </div>

  <script>
    // =========================
    // STATE (localStorage)
    // =========================
    const LS = {
      theme: 'ueih_theme',
      config: 'ueih_siteConfig',
      db: 'ueih_database',
      fav: 'ueih_favs',
      done: 'ueih_done',
      homeCards: 'ueih_homecards'
    };

    // Default config
    let siteConfig = {
      avatar: "https://scontent.fhan20-1.fna.fbcdn.net/v/t39.30808-6/555733813_810835077974194_4101748610057312325_n.jpg?_nc_cat=103&ccb=1-7&_nc_sid=6ee11a&_nc_eui2=AeHDTdYqWdNFRjU8d2r5jAhjebOdWmQ9kbF5s51aZD2RsVt3gAla-o2NSldRE2u4LlyamgEm9bbvjTd0fQAskB83&_nc_ohc=j7pYsq1YFBIQ7kNvwGqVswS&_nc_oc=Adlz2s1APpaob9-hqj_UUypHn8eLkWbC-8zRqetZZ8lreC3w1g2GCzKFBPN2XtBmeX0&_nc_zt=23&_nc_ht=scontent.fhan20-1.fna&_nc_gid=kLhRTL2MoYzPK4ngUv-7zA&oh=00_AflDQh0Z0RhjS2cSJvz5BRhWHcCxjtV7wKug-AHH5fEuuA&oe=6958839A",
      logoText: "Ueih Casio",
      slogan: "Casio L·∫π L·∫π R·ªìi Chuy·ªÉn C√¢u Thoiüê£",
      social: {
        fb: "https://www.facebook.com/ueih.7ron",
        tt: "https://www.tiktok.com/@ueih.ron1609",
        yt: "https://youtube.com"
      }
    };

    // Home cards (editable)
    let homeCards = [
      { icon: "fa-bolt",   color: "text-blue-400",   bg: "bg-blue-900/30",   border: "hover:border-blue-500/50",   title: "T·ªëc ƒê·ªô √Ånh S√°ng", desc: "Ph∆∞∆°ng ph√°p b·∫•m m√°y gi√∫p ti·∫øt ki·ªám 70% th·ªùi gian l√†m b√†i." },
      { icon: "fa-brain",  color: "text-purple-400", bg: "bg-purple-900/30", border: "hover:border-purple-500/50", title: "T∆∞ Duy Casio", desc: "Kh√¥ng ch·ªâ l√† b·∫•m m√°y, m√† l√† t∆∞ duy gi·∫£i to√°n tr·∫Øc nghi·ªám." },
      { icon: "fa-fire",   color: "text-yellow-400", bg: "bg-yellow-900/30", border: "hover:border-yellow-500/50", title: "ƒê·ªôc Quy·ªÅn Ueih", desc: "C√°c tuy·ªát chi√™u ch·ªâ ƒë∆∞·ª£c chia s·∫ª n·ªôi b·ªô t·∫°i ƒë√¢y." }
    ];

    const categories = {
      'casio-so-hoc': "S·ªë H·ªçc & S·ªë Ph·ª©c",
      'casio-ham-so': "H√†m S·ªë & ƒê·ªì Th·ªã",
      'casio-giai-tich': "Gi·∫£i T√≠ch",
      'casio-hinh-hoc': "H√¨nh H·ªçc Oxyz",
      'casio-xac-suat': "X√°c Su·∫•t & T·ªï H·ª£p",
      'casio-hay-la': "C√°c B√†i To√°n Hay & L·∫°",

'casio-880-so-hoc': "880 ‚Ä¢ S·ªë H·ªçc & S·ªë Ph·ª©c",
'casio-880-ham-so': "880 ‚Ä¢ H√†m S·ªë & ƒê·ªì Th·ªã",
'casio-880-giai-tich': "880 ‚Ä¢ Gi·∫£i T√≠ch",
'casio-880-hinh-hoc': "880 ‚Ä¢ H√¨nh H·ªçc Oxyz",
'casio-880-xac-suat': "880 ‚Ä¢ X√°c Su·∫•t & T·ªï H·ª£p",
'casio-880-hay-la': "880 ‚Ä¢ C√°c B√†i To√°n Hay & L·∫°",
      'exam-tsa': "Luy·ªán ƒê·ªÅ TSA",
      'exam-hsa': "Luy·ªán ƒê·ªÅ HSA",
      'exam-thpt': "ƒê·ªÅ THPT Qu·ªëc Gia",
      'exam-vact': "ƒê·ªÅ VACT"
    };

    // Default database
    let database = [
      { id: 1, cat: 'casio-so-hoc', title: "K·ªπ thu·∫≠t b·∫•m m√°y S·ªë Ph·ª©c", link: "#", desc: "Mode 2 chu·∫©n h√≥a", status: 'published' },
      { id: 2, cat: 'exam-tsa', title: "ƒê·ªÅ thi th·ª≠ TSA - S·ªë 01", link: "#", linkGiai: "#", desc: "ƒê·ªÅ chu·∫©n B√°ch Khoa", status: 'published' }
    ];

    let currentCat = '';
    let isAdmin = false;
    let favorites = new Set();       // ids
    let doneMap = {};                // {id: true}

    // =========================
    // HELPERS
    // =========================
    function safeParse(json, fallback) {
      try { return JSON.parse(json); } catch (e) { return fallback; }
    }

    function toast(msg, type='info') {
      const wrap = document.getElementById('toast-wrap');
      const div = document.createElement('div');
      const base = "px-4 py-3 rounded-2xl border text-sm font-bold shadow-lg animate-pop";
      const style = {
        info: "bg-cardBg/90 border-white/10 text-gray-200",
        ok: "bg-green-900/30 border-green-500/30 text-green-200",
        warn: "bg-yellow-900/30 border-yellow-500/30 text-yellow-200",
        err: "bg-red-900/30 border-red-500/30 text-red-200"
      }[type] || "bg-cardBg/90 border-white/10 text-gray-200";
      div.className = base + " " + style;
      div.innerHTML = `<div class="flex items-center gap-2"><i class="fas ${type==='ok'?'fa-circle-check':type==='err'?'fa-triangle-exclamation':type==='warn'?'fa-circle-exclamation':'fa-circle-info'}"></i><span>${msg}</span></div>`;
      wrap.appendChild(div);
      setTimeout(() => { div.style.opacity = 0; div.style.transform = 'translateY(-6px)'; }, 2200);
      setTimeout(() => { div.remove(); }, 2600);
    }

    function openDrawer() {
      document.getElementById('drawer-overlay').classList.remove('hidden');
      requestAnimationFrame(() => document.getElementById('drawer').classList.add('open'));
    }
    function closeDrawer() {
      document.getElementById('drawer').classList.remove('open');
      setTimeout(() => document.getElementById('drawer-overlay').classList.add('hidden'), 200);
    }

    // =========================
    // THEME
    // =========================
    function applyTheme(theme) {
      const root = document.documentElement;
      if(theme === 'light') root.classList.remove('dark');
      else root.classList.add('dark');
      document.getElementById('theme-ico').className = (theme === 'light') ? 'fas fa-sun' : 'fas fa-moon';
    }
    function toggleTheme() {
      const cur = localStorage.getItem(LS.theme) || 'dark';
      const next = cur === 'dark' ? 'light' : 'dark';
      localStorage.setItem(LS.theme, next);
      applyTheme(next);
      toast(next === 'light' ? 'B·∫≠t Light mode ‚ú®' : 'B·∫≠t Dark mode üåô', 'ok');
    }

    // =========================
    // LOAD/SAVE
    // =========================
    function loadState() {
      const theme = localStorage.getItem(LS.theme) || 'dark';
      applyTheme(theme);

      const cfg = localStorage.getItem(LS.config);
      if(cfg) siteConfig = {...siteConfig, ...safeParse(cfg, siteConfig)};

      const db = localStorage.getItem(LS.db);
      if(db) database = safeParse(db, database);

      const fav = localStorage.getItem(LS.fav);
      if(fav) favorites = new Set(safeParse(fav, []));

      const done = localStorage.getItem(LS.done);
      if(done) doneMap = safeParse(done, {});

      const hc = localStorage.getItem(LS.homeCards);
      if(hc) homeCards = safeParse(hc, homeCards);
    }

    function saveState() {
      localStorage.setItem(LS.config, JSON.stringify(siteConfig));
      localStorage.setItem(LS.db, JSON.stringify(database));
      localStorage.setItem(LS.fav, JSON.stringify([...favorites]));
      localStorage.setItem(LS.done, JSON.stringify(doneMap));
      localStorage.setItem(LS.homeCards, JSON.stringify(homeCards));
    }

    function resetLocal() {
      if(!confirm("Reset localStorage? (s·∫Ω m·∫•t d·ªØ li·ªáu ƒë√£ l∆∞u tr√™n m√°y)")) return;
      Object.values(LS).forEach(k => localStorage.removeItem(k));
      toast("ƒê√£ reset d·ªØ li·ªáu m√°y. Refresh trang l√† v·ªÅ m·∫∑c ƒë·ªãnh.", "warn");
    }

    // =========================
    // RENDER CONFIG + HOME CARDS
    // =========================
    function renderConfig() {
      document.getElementById('nav-avatar').src = siteConfig.avatar;
      document.getElementById('home-avatar-big').src = siteConfig.avatar;
      document.getElementById('nav-text').innerText = siteConfig.logoText;
      document.getElementById('home-slogan').innerText = siteConfig.slogan;

      document.getElementById('cfg-avatar').value = siteConfig.avatar;
      document.getElementById('cfg-logo-text').value = siteConfig.logoText;
      document.getElementById('cfg-slogan').value = siteConfig.slogan;

      document.getElementById('cfg-fb').value = siteConfig.social.fb || '';
      document.getElementById('cfg-tt').value = siteConfig.social.tt || '';
      document.getElementById('cfg-yt').value = siteConfig.social.yt || '';

      document.getElementById('social-fb').href = siteConfig.social.fb || '#';
      document.getElementById('social-tt').href = siteConfig.social.tt || '#';
      document.getElementById('social-yt').href = siteConfig.social.yt || '#';
    }

    function renderHomeCards() {
      const anchor = document.getElementById('home-cards-anchor');
      const parent = anchor.parentElement;
      // clear current cards except anchor
      [...parent.children].forEach(ch => { if(ch !== anchor) ch.remove(); });

      homeCards.forEach((c) => {
        const div = document.createElement('div');
        div.className = `bg-cardBg border border-white/10 p-6 rounded-2xl ${c.border || 'hover:border-primary/50'} transition duration-300 group cursor-default`;
        div.innerHTML = `
          <div class="w-12 h-12 rounded-xl ${c.bg || 'bg-primary/20'} ${c.color || 'text-primary'} flex items-center justify-center text-2xl mb-4 group-hover:scale-110 transition">
            <i class="fas ${c.icon || 'fa-star'}"></i>
          </div>
          <h3 class="font-black text-lg mb-2 text-white">${escapeHtml(c.title || '')}</h3>
          <p class="text-sm text-gray-400 leading-relaxed">${escapeHtml(c.desc || '')}</p>
        `;
        parent.insertBefore(div, anchor);
      });
    }

    // simple escape
    function escapeHtml(str) {
      return (str ?? '').toString()
        .replaceAll('&','&amp;').replaceAll('<','&lt;')
        .replaceAll('>','&gt;').replaceAll('"','&quot;')
        .replaceAll("'","&#039;");
    }

    // =========================
    // NAV + PAGES
    // =========================
    function switchPage(pageId) {
      document.querySelectorAll('.page-section').forEach(el => el.classList.remove('active'));

      if(pageId === 'home') {
        document.getElementById('page-home').classList.add('active');
        currentCat = '';
      } else if(pageId === 'favorites') {
        currentCat = 'favorites';
        renderFavorites();
        document.getElementById('page-favorites').classList.add('active');
      } else {
        currentCat = pageId;
        document.getElementById('detail-title').innerText = categories[pageId] || 'Danh m·ª•c';
        document.getElementById('inp-search').value = '';
        renderList(pageId);
        document.getElementById('page-detail').classList.add('active');
      }
      document.getElementById('admin-menu').classList.add('hidden');
      window.scrollTo({top:0, behavior:'smooth'});
    }

    // =========================
    // FAVORITES + DONE
    // =========================
    function toggleFav(id) {
      if(favorites.has(id)) favorites.delete(id);
      else favorites.add(id);
      saveState();
      toast(favorites.has(id) ? 'ƒê√£ ‚≠ê b√†i n√†y!' : 'ƒê√£ b·ªè ‚≠ê', 'ok');
      if(currentCat === 'favorites') renderFavorites();
      else if(currentCat) renderList(currentCat);
    }

    function toggleDone(id) {
      doneMap[id] = !doneMap[id];
      if(!doneMap[id]) delete doneMap[id];
      saveState();
      toast(doneMap[id] ? '‚úÖ ƒê√°nh d·∫•u ƒë√£ h·ªçc' : '‚Ü©Ô∏è B·ªè ƒë√°nh d·∫•u', 'info');
      if(currentCat === 'favorites') renderFavorites();
      else if(currentCat) renderList(currentCat);
    }

    function clearFavorites() {
      if(!confirm("X√≥a h·∫øt b√†i y√™u th√≠ch?")) return;
      favorites = new Set();
      saveState();
      renderFavorites();
      toast("ƒê√£ x√≥a h·∫øt ‚≠ê", "warn");
    }

    // =========================
    // RENDER LIST (CATEGORY)
    // =========================
    function computeProgress(catId) {
      // Progress t√≠nh tr√™n nh·ªØng b√†i m√† h·ªçc sinh nh√¨n th·∫•y (published). Admin th√¨ v·∫´n th·∫•y draft nh∆∞ng progress v·∫´n t√≠nh theo published.
      const visibleToStudents = database.filter(i => i.cat === catId && i.status !== 'draft');
      const total = visibleToStudents.length;
      const done = visibleToStudents.filter(i => !!doneMap[i.id]).length;
      const pct = total === 0 ? 0 : Math.round(done * 100 / total);
      return { total, done, pct };
    }

    function renderDetailMeta(catId, itemsShown) {
      const { total, done, pct } = computeProgress(catId);
      document.getElementById('detail-count').innerText = `${itemsShown} b√†i`;
      document.getElementById('detail-progress-text').innerText = `${pct}% ho√†n th√†nh (${done}/${total})`;
      document.getElementById('detail-progress-bar').style.width = `${pct}%`;
    }

    function renderList(catId) {
      const list = document.getElementById('detail-list');
      const empty = document.getElementById('empty-msg');
      const q = (document.getElementById('inp-search').value || '').trim().toLowerCase();

      list.innerHTML = '';

      let items = database.filter(i => i.cat === catId);
      const isExam = catId.startsWith('exam-');

      // search
      if(q) items = items.filter(i => (i.title || '').toLowerCase().includes(q) || (i.desc || '').toLowerCase().includes(q));

      // sorting: published first then draft
      items.sort((a,b) => (a.status === 'draft') - (b.status === 'draft'));

      // show/hide empty
      if(items.length === 0) empty.classList.remove('hidden');
      else empty.classList.add('hidden');

      // meta
      renderDetailMeta(catId, items.length);

      items.forEach(item => {
        const realIndex = database.indexOf(item);
        const isDraft = (item.status === 'draft');
        const isLocked = isDraft && !isAdmin;

        let cardClass = isLocked
          ? "bg-white/5 border border-dashed border-white/20 p-5 rounded-2xl flex flex-col md:flex-row items-start md:items-center gap-4 locked-item relative"
          : "bg-cardBg border border-white/10 hover:border-primary/50 p-5 rounded-2xl flex flex-col md:flex-row items-start md:items-center gap-4 transition group relative";

        if(isAdmin && isDraft) cardClass = "bg-yellow-900/10 border border-dashed border-yellow-500/50 p-5 rounded-2xl flex flex-col md:flex-row gap-4 relative";

        const favOn = favorites.has(item.id);
        const doneOn = !!doneMap[item.id];

        // badge
        const badge = isDraft ? `<span class="ml-2 px-2 py-0.5 rounded text-[10px] font-black bg-yellow-500 text-black">NH√ÅP</span>` : "";
        const doneBadge = doneOn ? `<span class="ml-2 px-2 py-0.5 rounded text-[10px] font-black bg-green-500 text-black">DONE</span>` : "";

        // actions
        let buttonsHTML = '';
        if(isLocked) {
          buttonsHTML = `<div class="text-gray-500 text-sm italic"><i class="fas fa-lock mr-1"></i> Coming Soon</div>`;
        } else if (isExam) {
          buttonsHTML = `
            <div class="flex gap-2 w-full md:w-auto mt-2 md:mt-0">
              <a href="${item.link}" target="_blank" class="flex-1 md:flex-none px-4 py-2 bg-white/10 hover:bg-white/20 text-white text-xs font-black rounded-xl uppercase tracking-wider text-center transition">
                <i class="fas fa-file-alt mr-1"></i> ƒê·ªÅ
              </a>
              <a href="${item.linkGiai || '#'}" target="_blank" class="flex-1 md:flex-none px-4 py-2 bg-primary hover:bg-primaryDark text-white text-xs font-black rounded-xl uppercase tracking-wider text-center transition">
                <i class="fas fa-video mr-1"></i> Ch·ªØa
              </a>
            </div>
          `;
        } else {
          cardClass += " cursor-pointer";
        }

        const clickAttr = (!isExam && !isLocked) ? `onclick="window.open('${item.link}', '_blank')"` : "";

        const html = `
          <div class="${cardClass}" ${clickAttr}>
            <div class="w-11 h-11 rounded-2xl bg-white/5 flex items-center justify-center shrink-0 ${!isLocked ? 'group-hover:bg-primary transition' : ''}">
              ${isLocked ? '<i class="fas fa-lock text-sm text-gray-500"></i>' : '<i class="fas fa-play text-xs text-white"></i>'}
            </div>

            <div class="flex-grow min-w-0 w-full">
              <h3 class="font-black text-gray-200 ${!isLocked ? 'group-hover:text-white' : ''} text-base transition">
                ${escapeHtml(item.title)} ${badge} ${doneBadge}
              </h3>
              <p class="text-sm text-gray-400 ${isLocked ? 'opacity-70' : ''}">${escapeHtml(item.desc || '')}</p>

              <div class="mt-3 flex flex-wrap gap-2 ${isLocked ? 'hidden' : ''}">
                <button onclick="event.stopPropagation(); toggleFav(${item.id})"
                  class="px-3 py-2 rounded-xl border border-white/10 bg-white/5 hover:bg-white/10 transition text-xs font-black flex items-center gap-2">
                  <i class="fas ${favOn ? 'fa-star text-yellow-400' : 'fa-star text-gray-400'}"></i>
                  ${favOn ? 'ƒê√£ l∆∞u' : 'L∆∞u'}
                </button>

                <button onclick="event.stopPropagation(); toggleDone(${item.id})"
                  class="px-3 py-2 rounded-xl border border-white/10 bg-white/5 hover:bg-white/10 transition text-xs font-black flex items-center gap-2">
                  <i class="fas ${doneOn ? 'fa-circle-check text-green-400' : 'fa-circle'}"></i>
                  ${doneOn ? 'ƒê√£ h·ªçc' : 'ƒê√°nh d·∫•u'}
                </button>
              </div>
            </div>

            ${buttonsHTML}

            <button onclick="event.stopPropagation(); deleteLesson(${realIndex})"
              class="admin-only absolute top-3 right-3 w-9 h-9 rounded-xl hover:bg-red-500/20 text-gray-400 hover:text-red-400 flex items-center justify-center transition">
              <i class="fas fa-trash-alt"></i>
            </button>
          </div>
        `;
        list.innerHTML += html;
      });
    }

    // =========================
    // FAVORITES PAGE RENDER
    // =========================
    function renderFavorites() {
      const list = document.getElementById('fav-list');
      const empty = document.getElementById('fav-empty');
      list.innerHTML = '';

      const favItems = database.filter(i => favorites.has(i.id) && (i.status !== 'draft' || isAdmin));
      if(favItems.length === 0) {
        empty.classList.remove('hidden');
        return;
      }
      empty.classList.add('hidden');

      favItems.forEach(item => {
        const isExam = item.cat.startsWith('exam-');
        const doneOn = !!doneMap[item.id];

        const html = `
          <div class="bg-cardBg border border-white/10 hover:border-primary/50 p-5 rounded-2xl transition group relative">
            <div class="flex items-start gap-4">
              <div class="w-11 h-11 rounded-2xl bg-white/5 group-hover:bg-primary transition flex items-center justify-center shrink-0">
                <i class="fas fa-bookmark text-white text-sm"></i>
              </div>
              <div class="flex-grow min-w-0">
                <div class="text-xs text-gray-400 font-bold uppercase tracking-widest">${escapeHtml(categories[item.cat] || item.cat)}</div>
                <h3 class="font-black text-white mt-1">${escapeHtml(item.title)}</h3>
                <p class="text-sm text-gray-400 mt-1">${escapeHtml(item.desc || '')}</p>

                <div class="mt-3 flex flex-wrap gap-2">
                  <button onclick="toggleFav(${item.id})" class="px-3 py-2 rounded-xl border border-white/10 bg-white/5 hover:bg-white/10 transition text-xs font-black flex items-center gap-2">
                    <i class="fas fa-star text-yellow-400"></i> B·ªè l∆∞u
                  </button>
                  <button onclick="toggleDone(${item.id})" class="px-3 py-2 rounded-xl border border-white/10 bg-white/5 hover:bg-white/10 transition text-xs font-black flex items-center gap-2">
                    <i class="fas ${doneOn ? 'fa-circle-check text-green-400' : 'fa-circle'}"></i>
                    ${doneOn ? 'ƒê√£ h·ªçc' : 'ƒê√°nh d·∫•u'}
                  </button>

                  ${isExam ? `
                    <a href="${item.link}" target="_blank" class="px-3 py-2 rounded-xl border border-white/10 bg-white/5 hover:bg-white/10 transition text-xs font-black"><i class="fas fa-file-lines mr-1"></i> ƒê·ªÅ</a>
                    <a href="${item.linkGiai || '#'}" target="_blank" class="px-3 py-2 rounded-xl bg-primary hover:bg-primaryDark transition text-xs font-black"><i class="fas fa-video mr-1"></i> Ch·ªØa</a>
                  ` : `
                    <a href="${item.link}" target="_blank" class="px-3 py-2 rounded-xl bg-primary hover:bg-primaryDark transition text-xs font-black"><i class="fas fa-play mr-1"></i> M·ªü b√†i</a>
                  `}
                </div>
              </div>
            </div>
          </div>
        `;
        list.innerHTML += html;
      });
    }

    // =========================
    // ADMIN
    // =========================
    function requestAdmin() {
      isAdmin ? toggleAdminMenu() : openModal('password-modal');
    }

    function toggleAdminMenu() {
      document.getElementById('admin-menu').classList.toggle('hidden');
    }

    function checkPassword() {
      const passEl = document.getElementById('admin-pass');
      const pass = (passEl.value || '').trim();

      // Basic rate limit (client-side only): 5 fails -> lock 30s
      const now = Date.now();
      const lockUntil = Number(localStorage.getItem('admin_lock_until') || 0);
      if(now < lockUntil) {
        const sec = Math.ceil((lockUntil - now)/1000);
        toast(`B·ªã kh√≥a ${sec}s v√¨ nh·∫≠p sai qu√° nhi·ªÅu üòµ`, "err");
        passEl.value = '';
        return;
      }

      async function sha256Hex(str) {
        // Prefer WebCrypto when available
        if (window.crypto && window.crypto.subtle) {
          const enc = new TextEncoder().encode(str);
          const buf = await window.crypto.subtle.digest('SHA-256', enc);
          return Array.from(new Uint8Array(buf)).map(b=>b.toString(16).padStart(2,'0')).join('');
        }
        // Fallback: tiny pure JS SHA-256 (not for serious security, just avoids plaintext)
        // Written here to keep this file standalone.
        function ror(v, n) { return (v>>>n) | (v<<(32-n)); }
        function ch(x,y,z) { return (x & y) ^ (~x & z); }
        function maj(x,y,z) { return (x & y) ^ (x & z) ^ (y & z); }
        function s0(x) { return ror(x,2) ^ ror(x,13) ^ ror(x,22); }
        function s1(x) { return ror(x,6) ^ ror(x,11) ^ ror(x,25); }
        function g0(x) { return ror(x,7) ^ ror(x,18) ^ (x>>>3); }
        function g1(x) { return ror(x,17) ^ ror(x,19) ^ (x>>>10); }
        const K = [
          0x428a2f98,0x71374491,0xb5c0fbcf,0xe9b5dba5,0x3956c25b,0x59f111f1,0x923f82a4,0xab1c5ed5,
          0xd807aa98,0x12835b01,0x243185be,0x550c7dc3,0x72be5d74,0x80deb1fe,0x9bdc06a7,0xc19bf174,
          0xe49b69c1,0xefbe4786,0x0fc19dc6,0x240ca1cc,0x2de92c6f,0x4a7484aa,0x5cb0a9dc,0x76f988da,
          0x983e5152,0xa831c66d,0xb00327c8,0xbf597fc7,0xc6e00bf3,0xd5a79147,0x06ca6351,0x14292967,
          0x27b70a85,0x2e1b2138,0x4d2c6dfc,0x53380d13,0x650a7354,0x766a0abb,0x81c2c92e,0x92722c85,
          0xa2bfe8a1,0xa81a664b,0xc24b8b70,0xc76c51a3,0xd192e819,0xd6990624,0xf40e3585,0x106aa070,
          0x19a4c116,0x1e376c08,0x2748774c,0x34b0bcb5,0x391c0cb3,0x4ed8aa4a,0x5b9cca4f,0x682e6ff3,
          0x748f82ee,0x78a5636f,0x84c87814,0x8cc70208,0x90befffa,0xa4506ceb,0xbef9a3f7,0xc67178f2
        ];
        const utf8 = unescape(encodeURIComponent(str));
        const bytes = [];
        for(let i=0;i<utf8.length;i++) bytes.push(utf8.charCodeAt(i));
        const bitLen = bytes.length * 8;
        bytes.push(0x80);
        while((bytes.length % 64) !== 56) bytes.push(0);
        for(let i=7;i>=0;i--) bytes.push((bitLen >>> (i*8)) & 0xff);

        let h0=0x6a09e667, h1=0xbb67ae85, h2=0x3c6ef372, h3=0xa54ff53a;
        let h4=0x510e527f, h5=0x9b05688c, h6=0x1f83d9ab, h7=0x5be0cd19;

        const W = new Array(64);
        for(let i=0;i<bytes.length;i+=64) {
          for(let t=0;t<16;t++) {
            const j = i + t*4;
            W[t] = ((bytes[j]<<24) | (bytes[j+1]<<16) | (bytes[j+2]<<8) | (bytes[j+3])) >>> 0;
          }
          for(let t=16;t<64;t++) {
            W[t] = (g1(W[t-2]) + W[t-7] + g0(W[t-15]) + W[t-16]) >>> 0;
          }
          let a=h0,b=h1,c=h2,d=h3,e=h4,f=h5,g=h6,h=h7;
          for(let t=0;t<64;t++) {
            const T1 = (h + s1(e) + ch(e,f,g) + K[t] + W[t]) >>> 0;
            const T2 = (s0(a) + maj(a,b,c)) >>> 0;
            h=g; g=f; f=e; e=(d + T1) >>> 0;
            d=c; c=b; b=a; a=(T1 + T2) >>> 0;
          }
          h0=(h0+a)>>>0; h1=(h1+b)>>>0; h2=(h2+c)>>>0; h3=(h3+d)>>>0;
          h4=(h4+e)>>>0; h5=(h5+f)>>>0; h6=(h6+g)>>>0; h7=(h7+h)>>>0;
        }
        return [h0,h1,h2,h3,h4,h5,h6,h7].map(x=>x.toString(16).padStart(8,'0')).join('');
      }

      (async () => {
        try {
          const hash = await sha256Hex(pass);
          const expected = "eac63159e8c153a78d0598cf6726d8500119ad7d3ef2e2489da56eb7127d06df";
          if(hash === expected) {
            localStorage.removeItem('admin_fail_count');
            localStorage.removeItem('admin_lock_until');
            isAdmin = true;
            document.body.classList.add('admin-mode');
            document.getElementById('admin-indicator').classList.add('bg-green-500');
            document.getElementById('btn-admin').classList.add('text-primary', 'border-primary');
            closeModal('password-modal');
            toast("üîì Admin Access Granted!", "ok");
            if(currentCat && currentCat !== 'favorites') renderList(currentCat);
            if(currentCat === 'favorites') renderFavorites();
          } else {
            const fails = Number(localStorage.getItem('admin_fail_count') || 0) + 1;
            localStorage.setItem('admin_fail_count', String(fails));
            if(fails >= 5) {
              localStorage.setItem('admin_lock_until', String(Date.now() + 30000));
              localStorage.setItem('admin_fail_count', '0');
              toast("Sai qu√° 5 l·∫ßn ‚Üí kh√≥a 30s üòµ", "err");
            } else {
              toast("Sai password r·ªìi bro üòÖ", "err");
            }
          }
        } catch(err) {
          toast("L·ªói ki·ªÉm tra m·∫≠t kh·∫©u (tr√¨nh duy·ªát ch·∫∑n crypto) üò≠", "err");
        } finally {
          passEl.value = '';
        }
      })();
    }


    function logoutAdmin() {
      isAdmin = false;
      document.body.classList.remove('admin-mode');
      document.getElementById('admin-menu').classList.add('hidden');
      document.getElementById('admin-indicator').classList.remove('bg-green-500');
      document.getElementById('btn-admin').classList.remove('text-primary', 'border-primary');
      toast("üîí Logged out.", "warn");
      if(currentCat && currentCat !== 'favorites') renderList(currentCat);
      if(currentCat === 'favorites') renderFavorites();
    }

    // =========================
    // MODALS
    // =========================
    function closeModal(id) { document.getElementById(id).classList.add('hidden'); document.getElementById(id).classList.remove('flex'); }
    function openModal(id) {
      const el = document.getElementById(id);
      el.classList.remove('hidden');
      el.classList.add('flex');
      if(id === 'add-modal') {
        if(currentCat.startsWith('exam-')) document.getElementById('div-link-giai').classList.remove('hidden');
        else document.getElementById('div-link-giai').classList.add('hidden');
      }
      if(id === 'password-modal') setTimeout(() => document.getElementById('admin-pass').focus(), 50);
    }

    function openAddModal() {
      document.getElementById('inp-cat-hidden').value = currentCat;
      openModal('add-modal');
    }

    // =========================
    // CRUD
    // =========================
    function saveLesson() {
      const title = document.getElementById('inp-title').value.trim();
      const link = document.getElementById('inp-link').value.trim();
      const linkGiai = document.getElementById('inp-link-giai').value.trim();
      const desc = document.getElementById('inp-desc').value.trim();
      const isDraft = document.getElementById('inp-draft').checked;
      const cat = document.getElementById('inp-cat-hidden').value;

      if(!title) return toast("Thi·∫øu ti√™u ƒë·ªÅ!", "err");
      if(!cat) return toast("Ch∆∞a ch·ªçn danh m·ª•c!", "err");

      database.push({
        id: Date.now(),
        cat, title, link: link || "#", linkGiai: linkGiai || "",
        desc,
        status: isDraft ? 'draft' : 'published'
      });

      // reset form
      document.getElementById('inp-title').value = '';
      document.getElementById('inp-link').value = '';
      document.getElementById('inp-link-giai').value = '';
      document.getElementById('inp-desc').value = '';
      document.getElementById('inp-draft').checked = false;

      saveState();
      closeModal('add-modal');
      renderList(cat);
      toast("ƒê√£ l∆∞u b√†i m·ªõi ‚úÖ", "ok");
    }

    function deleteLesson(idx) {
      if(!confirm("X√≥a b√†i n√†y?")) return;
      const id = database[idx]?.id;
      database.splice(idx, 1);
      // cleanup
      favorites.delete(id);
      delete doneMap[id];
      saveState();
      toast("ƒê√£ x√≥a b√†i.", "warn");
      if(currentCat && currentCat !== 'favorites') renderList(currentCat);
      if(currentCat === 'favorites') renderFavorites();
    }

    function openConfigModal() { openModal('config-modal'); }

    function saveConfig() {
      siteConfig.avatar = document.getElementById('cfg-avatar').value.trim() || siteConfig.avatar;
      siteConfig.logoText = document.getElementById('cfg-logo-text').value.trim() || siteConfig.logoText;
      siteConfig.slogan = document.getElementById('cfg-slogan').value.trim() || siteConfig.slogan;

      siteConfig.social.fb = document.getElementById('cfg-fb').value.trim();
      siteConfig.social.tt = document.getElementById('cfg-tt').value.trim();
      siteConfig.social.yt = document.getElementById('cfg-yt').value.trim();

      saveState();
      renderConfig();
      closeModal('config-modal');
      toast("ƒê√£ c·∫≠p nh·∫≠t giao di·ªán ‚ú®", "ok");
    }

    // =========================
    // HOME CARDS EDITOR
    // =========================
    function openHomeCardsModal() {
      renderHomeCardsEditor();
      openModal('homecards-modal');
    }

    function renderHomeCardsEditor() {
      const wrap = document.getElementById('homecards-editor');
      wrap.innerHTML = '';

      homeCards.forEach((c, idx) => {
        const row = document.createElement('div');
        row.className = "border border-white/10 rounded-2xl p-4 bg-white/5";
        row.innerHTML = `
          <div class="flex items-center justify-between mb-3">
            <div class="font-black text-white">Card #${idx+1}</div>
            <button onclick="removeHomeCard(${idx})" class="px-3 py-1.5 rounded-xl bg-red-500/15 hover:bg-red-500/25 text-red-200 text-xs font-black">
              X√≥a
            </button>
          </div>

          <div class="grid grid-cols-1 md:grid-cols-3 gap-2">
            <div>
              <label class="text-[11px] font-bold text-gray-400 uppercase">Icon (fa-...)</label>
              <input id="hc-icon-${idx}" value="${escapeHtml(c.icon || '')}" class="w-full p-3 bg-cardBg border border-white/10 rounded-2xl text-white outline-none focus:border-primary/60">
            </div>
            <div class="md:col-span-2">
              <label class="text-[11px] font-bold text-gray-400 uppercase">Title</label>
              <input id="hc-title-${idx}" value="${escapeHtml(c.title || '')}" class="w-full p-3 bg-cardBg border border-white/10 rounded-2xl text-white outline-none focus:border-primary/60">
            </div>
            <div class="md:col-span-3">
              <label class="text-[11px] font-bold text-gray-400 uppercase">Desc</label>
              <input id="hc-desc-${idx}" value="${escapeHtml(c.desc || '')}" class="w-full p-3 bg-cardBg border border-white/10 rounded-2xl text-white outline-none focus:border-primary/60">
            </div>

            <div class="md:col-span-3 text-[11px] text-gray-500">
              G·ª£i √Ω icon: fa-bolt, fa-brain, fa-fire, fa-star, fa-book, fa-graduation-cap...
            </div>
          </div>
        `;
        wrap.appendChild(row);
      });
    }

    function addHomeCard() {
      homeCards.push({ icon:'fa-star', color:'text-primary', bg:'bg-primary/20', border:'hover:border-primary/50', title:'Card m·ªõi', desc:'M√¥ t·∫£...' });
      renderHomeCardsEditor();
    }

    function removeHomeCard(idx) {
      homeCards.splice(idx, 1);
      renderHomeCardsEditor();
    }

    function saveHomeCards() {
      // apply edits
      homeCards = homeCards.map((c, idx) => ({
        ...c,
        icon: document.getElementById(`hc-icon-${idx}`).value.trim() || c.icon,
        title: document.getElementById(`hc-title-${idx}`).value.trim() || c.title,
        desc: document.getElementById(`hc-desc-${idx}`).value.trim() || c.desc
      }));
      saveState();
      renderHomeCards();
      closeModal('homecards-modal');
      toast("ƒê√£ l∆∞u card Trang ch·ªß ü™Ñ", "ok");
    }

    // =========================
    // EXPORT HTML (freeze current state)
    // =========================
    function exportHTML() {
      // snapshot current DOM html
      let html = document.documentElement.outerHTML;

      // overwrite embedded defaults with current states
      html = html.replace(/let siteConfig = \{[\s\S]*?\};/, `let siteConfig = ${JSON.stringify(siteConfig)};`);
      html = html.replace(/let homeCards = \[[\s\S]*?\];/, `let homeCards = ${JSON.stringify(homeCards)};`);
      html = html.replace(/let database = \[[\s\S]*?\];/, `let database = ${JSON.stringify(database)};`);

      // freeze favorites/done into localStorage on first load? keep as-is but also embed defaults (optional)
      const blob = new Blob([html], {type:'text/html'});
      const a = document.createElement('a');
      a.href = URL.createObjectURL(blob);
      a.download = 'Ueih_Casio_V3_Export.html';
      document.body.appendChild(a); a.click(); document.body.removeChild(a);
      toast("ƒê√£ export HTML ‚úÖ", "ok");
    }

    // =========================
    // INIT
    // =========================
    function init() {
      loadState();
      renderConfig();
      renderHomeCards();
    }

    // close drawer on resize to desktop
    window.addEventListener('resize', () => { if(window.innerWidth >= 768) closeDrawer(); });

    init();
  </script>
</body>
</html>
